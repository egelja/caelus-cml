; Listing generated by Microsoft (R) Optimizing Compiler Version 16.00.30319.01 

include listing.inc

INCLUDELIB OLDNAMES

PUBLIC	zip_copyright
PUBLIC	??_C@_01JOAMLHOP@?9?$AA@			; `string'
EXTRN	__imp_rand:PROC
EXTRN	__imp_srand:PROC
EXTRN	__imp__time64:PROC
?calls@?1??crypthead@@9@9 DD 01H DUP (?)		; `crypthead'::`2'::calls
;	COMDAT ??_C@_01JOAMLHOP@?9?$AA@
CONST	SEGMENT
??_C@_01JOAMLHOP@?9?$AA@ DB '-', 00H			; `string'
zip_copyright DB ' zip 1.01 Copyright 1998-2004 Gilles Vollant - http://w'
	DB	'ww.winimage.com/zLibDll', 00H
;	COMDAT pdata
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\zip.c
pdata	SEGMENT
$pdata$zip64local_getByte DD imagerel zip64local_getByte
	DD	imagerel zip64local_getByte+102
	DD	imagerel $unwind$zip64local_getByte
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_getByte DD 060f01H
	DD	08640fH
	DD	07340fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_getByte
_TEXT	SEGMENT
c$ = 48
pzlib_filefunc_def$ = 48
filestream$ = 56
pi$ = 64
zip64local_getByte PROC					; COMDAT

; 350  : {

  00000	48 89 5c 24 10	 mov	 QWORD PTR [rsp+16], rbx
  00005	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000a	57		 push	 rdi
  0000b	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  0000f	48 8b d9	 mov	 rbx, rcx

; 351  :     unsigned char c;
; 352  :     int err = (int)ZREAD64(*pzlib_filefunc_def,filestream,&c,1);

  00012	48 8b 49 38	 mov	 rcx, QWORD PTR [rcx+56]
  00016	49 8b f8	 mov	 rdi, r8
  00019	4c 8d 44 24 30	 lea	 r8, QWORD PTR c$[rsp]
  0001e	41 b9 01 00 00
	00		 mov	 r9d, 1
  00024	48 8b f2	 mov	 rsi, rdx
  00027	ff 53 08	 call	 QWORD PTR [rbx+8]

; 353  :     if (err==1)

  0002a	83 f8 01	 cmp	 eax, 1
  0002d	75 19		 jne	 SHORT $LN4@zip64local

; 354  :     {
; 355  :         *pi = (int)c;

  0002f	0f b6 44 24 30	 movzx	 eax, BYTE PTR c$[rsp]
  00034	89 07		 mov	 DWORD PTR [rdi], eax

; 356  :         return ZIP_OK;

  00036	33 c0		 xor	 eax, eax

; 361  :             return ZIP_ERRNO;
; 362  :         else
; 363  :             return ZIP_EOF;
; 364  :     }
; 365  : }

  00038	48 8b 5c 24 38	 mov	 rbx, QWORD PTR [rsp+56]
  0003d	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  00042	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00046	5f		 pop	 rdi
  00047	c3		 ret	 0
$LN4@zip64local:

; 357  :     }
; 358  :     else
; 359  :     {
; 360  :         if (ZERROR64(*pzlib_filefunc_def,filestream))

  00048	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  0004c	48 8b d6	 mov	 rdx, rsi
  0004f	ff 53 30	 call	 QWORD PTR [rbx+48]

; 361  :             return ZIP_ERRNO;
; 362  :         else
; 363  :             return ZIP_EOF;
; 364  :     }
; 365  : }

  00052	48 8b 5c 24 38	 mov	 rbx, QWORD PTR [rsp+56]
  00057	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  0005c	f7 d8		 neg	 eax
  0005e	1b c0		 sbb	 eax, eax
  00060	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00064	5f		 pop	 rdi
  00065	c3		 ret	 0
zip64local_getByte ENDP
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT zip64local_TmzDateToDosDate
_TEXT	SEGMENT
ptm$ = 8
zip64local_TmzDateToDosDate PROC			; COMDAT

; 334  :     uLong year = (uLong)ptm->tm_year;

  00000	8b 51 14	 mov	 edx, DWORD PTR [rcx+20]
  00003	4c 8b c1	 mov	 r8, rcx

; 335  :     if (year>=1980)

  00006	81 fa bc 07 00
	00		 cmp	 edx, 1980		; 000007bcH
  0000c	72 08		 jb	 SHORT $LN3@zip64local@2

; 336  :         year-=1980;

  0000e	81 c2 44 f8 ff
	ff		 add	 edx, -1980		; fffff844H
  00014	eb 08		 jmp	 SHORT $LN1@zip64local@2
$LN3@zip64local@2:

; 337  :     else if (year>=80)

  00016	83 fa 50	 cmp	 edx, 80			; 00000050H
  00019	72 03		 jb	 SHORT $LN1@zip64local@2

; 338  :         year-=80;

  0001b	83 c2 b0	 add	 edx, -80		; ffffffb0H
$LN1@zip64local@2:

; 339  :     return
; 340  :       (uLong) (((ptm->tm_mday) + (32 * (ptm->tm_mon+1)) + (512 * year)) << 16) |
; 341  :         ((ptm->tm_sec/2) + (32* ptm->tm_min) + (2048 * (uLong)ptm->tm_hour));

  0001e	8b 41 08	 mov	 eax, DWORD PTR [rcx+8]
  00021	03 d2		 add	 edx, edx
  00023	c1 e0 06	 shl	 eax, 6
  00026	03 41 04	 add	 eax, DWORD PTR [rcx+4]
  00029	8b 09		 mov	 ecx, DWORD PTR [rcx]
  0002b	d1 e9		 shr	 ecx, 1
  0002d	c1 e0 05	 shl	 eax, 5
  00030	03 c1		 add	 eax, ecx
  00032	41 8b 48 10	 mov	 ecx, DWORD PTR [r8+16]
  00036	8d 54 d1 01	 lea	 edx, DWORD PTR [rcx+rdx*8+1]
  0003a	c1 e2 05	 shl	 edx, 5
  0003d	41 03 50 0c	 add	 edx, DWORD PTR [r8+12]
  00041	c1 e2 10	 shl	 edx, 16
  00044	0b c2		 or	 eax, edx

; 342  : }

  00046	c3		 ret	 0
zip64local_TmzDateToDosDate ENDP
_TEXT	ENDS
EXTRN	memset:PROC
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64local_putValue_inmemory DD imagerel zip64local_putValue_inmemory
	DD	imagerel zip64local_putValue_inmemory+53
	DD	imagerel $unwind$zip64local_putValue_inmemory
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_putValue_inmemory DD 010401H
	DD	04204H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_putValue_inmemory
_TEXT	SEGMENT
dest$ = 48
x$ = 56
nbByte$ = 64
zip64local_putValue_inmemory PROC			; COMDAT

; 312  : {

  00000	48 83 ec 28	 sub	 rsp, 40			; 00000028H

; 313  :     unsigned char* buf=(unsigned char*)dest;
; 314  :     int n;
; 315  :     for (n = 0; n < nbByte; n++) {

  00004	4d 63 c0	 movsxd	 r8, r8d
  00007	33 c0		 xor	 eax, eax
  00009	4d 85 c0	 test	 r8, r8
  0000c	7e 11		 jle	 SHORT $LN5@zip64local@3
  0000e	66 90		 npad	 2
$LL7@zip64local@3:

; 316  :         buf[n] = (unsigned char)(x & 0xff);

  00010	88 14 08	 mov	 BYTE PTR [rax+rcx], dl
  00013	48 ff c0	 inc	 rax

; 317  :         x >>= 8;

  00016	48 c1 ea 08	 shr	 rdx, 8
  0001a	49 3b c0	 cmp	 rax, r8
  0001d	7c f1		 jl	 SHORT $LL7@zip64local@3
$LN5@zip64local@3:

; 318  :     }
; 319  : 
; 320  :     if (x != 0)

  0001f	48 85 d2	 test	 rdx, rdx
  00022	74 0c		 je	 SHORT $LN3@zip64local@3

; 321  :     {     /* data overflow - hack for ZIP64 */
; 322  :        for (n = 0; n < nbByte; n++)

  00024	4d 85 c0	 test	 r8, r8
  00027	7e 07		 jle	 SHORT $LN3@zip64local@3
  00029	b2 ff		 mov	 dl, 255			; 000000ffH
  0002b	e8 00 00 00 00	 call	 memset
$LN3@zip64local@3:

; 323  :        {
; 324  :           buf[n] = 0xff;
; 325  :        }
; 326  :     }
; 327  : }

  00030	48 83 c4 28	 add	 rsp, 40			; 00000028H
  00034	c3		 ret	 0
zip64local_putValue_inmemory ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64local_putValue DD imagerel zip64local_putValue
	DD	imagerel zip64local_putValue+114
	DD	imagerel $unwind$zip64local_putValue
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_putValue DD 060f01H
	DD	08640fH
	DD	07340fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_putValue
_TEXT	SEGMENT
buf$ = 48
pzlib_filefunc_def$ = 48
filestream$ = 56
x$ = 64
nbByte$ = 72
zip64local_putValue PROC				; COMDAT

; 288  : {

  00000	48 89 5c 24 10	 mov	 QWORD PTR [rsp+16], rbx
  00005	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000a	57		 push	 rdi
  0000b	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 289  :     unsigned char buf[8];
; 290  :     int n;
; 291  :     for (n = 0; n < nbByte; n++)

  0000f	33 c0		 xor	 eax, eax
  00011	49 63 d9	 movsxd	 rbx, r9d
  00014	48 8b f2	 mov	 rsi, rdx
  00017	48 8b f9	 mov	 rdi, rcx
  0001a	45 85 c9	 test	 r9d, r9d
  0001d	7e 12		 jle	 SHORT $LN7@zip64local@4
  0001f	90		 npad	 1
$LL9@zip64local@4:

; 292  :     {
; 293  :         buf[n] = (unsigned char)(x & 0xff);

  00020	44 88 44 04 30	 mov	 BYTE PTR buf$[rsp+rax], r8b
  00025	48 ff c0	 inc	 rax

; 294  :         x >>= 8;

  00028	49 c1 e8 08	 shr	 r8, 8
  0002c	48 3b c3	 cmp	 rax, rbx
  0002f	7c ef		 jl	 SHORT $LL9@zip64local@4
$LN7@zip64local@4:

; 295  :     }
; 296  :     if (x != 0)

  00031	4d 85 c0	 test	 r8, r8
  00034	74 14		 je	 SHORT $LN5@zip64local@4

; 297  :       {     /* data overflow - hack for ZIP64 (X Roche) */
; 298  :       for (n = 0; n < nbByte; n++)

  00036	45 85 c9	 test	 r9d, r9d
  00039	7e 0f		 jle	 SHORT $LN5@zip64local@4
  0003b	48 8d 4c 24 30	 lea	 rcx, QWORD PTR buf$[rsp]
  00040	4c 8b c3	 mov	 r8, rbx
  00043	b2 ff		 mov	 dl, 255			; 000000ffH
  00045	e8 00 00 00 00	 call	 memset
$LN5@zip64local@4:

; 299  :         {
; 300  :           buf[n] = 0xff;
; 301  :         }
; 302  :       }
; 303  : 
; 304  :     if (ZWRITE64(*pzlib_filefunc_def,filestream,buf,nbByte)!=(uLong)nbByte)

  0004a	48 8b 4f 38	 mov	 rcx, QWORD PTR [rdi+56]
  0004e	4c 8d 44 24 30	 lea	 r8, QWORD PTR buf$[rsp]
  00053	44 8b cb	 mov	 r9d, ebx
  00056	48 8b d6	 mov	 rdx, rsi
  00059	ff 57 10	 call	 QWORD PTR [rdi+16]

; 305  :         return ZIP_ERRNO;
; 306  :     else
; 307  :         return ZIP_OK;
; 308  : }

  0005c	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  00061	2b c3		 sub	 eax, ebx
  00063	48 8b 5c 24 38	 mov	 rbx, QWORD PTR [rsp+56]
  00068	f7 d8		 neg	 eax
  0006a	1b c0		 sbb	 eax, eax
  0006c	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00070	5f		 pop	 rdi
  00071	c3		 ret	 0
zip64local_putValue ENDP
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT init_linkedlist
_TEXT	SEGMENT
ll$ = 8
init_linkedlist PROC					; COMDAT

; 215  :     ll->first_block = ll->last_block = NULL;

  00000	33 c0		 xor	 eax, eax
  00002	48 89 41 08	 mov	 QWORD PTR [rcx+8], rax
  00006	48 89 01	 mov	 QWORD PTR [rcx], rax

; 216  : }

  00009	c3		 ret	 0
init_linkedlist ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$free_datablock DD imagerel free_datablock
	DD	imagerel free_datablock+9
	DD	imagerel $unwind$free_datablock
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$free_datablock DD imagerel free_datablock+9
	DD	imagerel free_datablock+38
	DD	imagerel $chain$0$free_datablock
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$1$free_datablock DD imagerel free_datablock+38
	DD	imagerel free_datablock+43
	DD	imagerel $chain$1$free_datablock
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$1$free_datablock DD 021H
	DD	imagerel free_datablock
	DD	imagerel free_datablock+9
	DD	imagerel $unwind$free_datablock
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$free_datablock DD 020521H
	DD	043405H
	DD	imagerel free_datablock
	DD	imagerel free_datablock+9
	DD	imagerel $unwind$free_datablock
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$free_datablock DD 010401H
	DD	04204H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT free_datablock
_TEXT	SEGMENT
ldi$ = 48
free_datablock PROC					; COMDAT

; 204  : {

  00000	48 83 ec 28	 sub	 rsp, 40			; 00000028H

; 205  :     while (ldi!=NULL)

  00004	48 85 c9	 test	 rcx, rcx
  00007	74 1d		 je	 SHORT $LN2@free_datab
  00009	48 89 5c 24 20	 mov	 QWORD PTR [rsp+32], rbx
  0000e	66 90		 npad	 2
$LL3@free_datab:

; 206  :     {
; 207  :         linkedlist_datablock_internal* ldinext = ldi->next_datablock;

  00010	48 8b 19	 mov	 rbx, QWORD PTR [rcx]

; 208  :         TRYFREE(ldi);

  00013	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free

; 209  :         ldi = ldinext;

  00019	48 8b cb	 mov	 rcx, rbx
  0001c	48 85 db	 test	 rbx, rbx
  0001f	75 ef		 jne	 SHORT $LL3@free_datab
  00021	48 8b 5c 24 20	 mov	 rbx, QWORD PTR [rsp+32]
$LN2@free_datab:

; 210  :     }
; 211  : }

  00026	48 83 c4 28	 add	 rsp, 40			; 00000028H
  0002a	c3		 ret	 0
free_datablock ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$allocate_new_datablock DD imagerel allocate_new_datablock
	DD	imagerel allocate_new_datablock+38
	DD	imagerel $unwind$allocate_new_datablock
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$allocate_new_datablock DD 010401H
	DD	04204H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT allocate_new_datablock
_TEXT	SEGMENT
allocate_new_datablock PROC				; COMDAT

; 190  : {

  00000	48 83 ec 28	 sub	 rsp, 40			; 00000028H

; 191  :     linkedlist_datablock_internal* ldi;
; 192  :     ldi = (linkedlist_datablock_internal*)
; 193  :                  ALLOC(sizeof(linkedlist_datablock_internal));

  00004	b9 08 10 00 00	 mov	 ecx, 4104		; 00001008H
  00009	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc

; 194  :     if (ldi!=NULL)

  0000f	48 85 c0	 test	 rax, rax
  00012	74 0d		 je	 SHORT $LN4@allocate_n

; 195  :     {
; 196  :         ldi->next_datablock = NULL ;

  00014	33 c9		 xor	 ecx, ecx

; 197  :         ldi->filled_in_this_block = 0 ;

  00016	48 c7 40 08 f0
	0f 00 00	 mov	 QWORD PTR [rax+8], 4080	; 00000ff0H
  0001e	48 89 08	 mov	 QWORD PTR [rax], rcx
$LN4@allocate_n:

; 198  :         ldi->avail_in_this_block = SIZEDATA_INDATABLOCK ;
; 199  :     }
; 200  :     return ldi;
; 201  : }

  00021	48 83 c4 28	 add	 rsp, 40			; 00000028H
  00025	c3		 ret	 0
allocate_new_datablock ENDP
_TEXT	ENDS
;	COMDAT pdata
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\crypt.h
pdata	SEGMENT
$pdata$update_keys DD imagerel update_keys
	DD	imagerel update_keys+96
	DD	imagerel $unwind$update_keys
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$update_keys DD 020501H
	DD	013405H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT update_keys
_TEXT	SEGMENT
pkeys$ = 8
pcrc_32_tab$ = 16
c$ = 24
update_keys PROC					; COMDAT

; 49   : {

  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx

; 50   :     (*(pkeys+0)) = CRC32((*(pkeys+0)), c);

  00005	44 8b 11	 mov	 r10d, DWORD PTR [rcx]
  00008	41 8b d8	 mov	 ebx, r8d
  0000b	4c 8b c1	 mov	 r8, rcx
  0000e	8b c3		 mov	 eax, ebx
  00010	45 8b ca	 mov	 r9d, r10d
  00013	4c 8b da	 mov	 r11, rdx
  00016	4c 33 c8	 xor	 r9, rax
  00019	41 c1 ea 08	 shr	 r10d, 8
  0001d	41 0f b6 c1	 movzx	 eax, r9b
  00021	44 8b 0c 82	 mov	 r9d, DWORD PTR [rdx+rax*4]

; 51   :     (*(pkeys+1)) += (*(pkeys+0)) & 0xff;
; 52   :     (*(pkeys+1)) = (*(pkeys+1)) * 134775813L + 1;
; 53   :     {
; 54   :       register int keyshift = (int)((*(pkeys+1)) >> 24);
; 55   :       (*(pkeys+2)) = CRC32((*(pkeys+2)), keyshift);

  00025	8b 51 08	 mov	 edx, DWORD PTR [rcx+8]
  00028	45 33 ca	 xor	 r9d, r10d
  0002b	44 89 09	 mov	 DWORD PTR [rcx], r9d
  0002e	41 0f b6 c1	 movzx	 eax, r9b
  00032	03 41 04	 add	 eax, DWORD PTR [rcx+4]
  00035	69 c0 05 84 08
	08		 imul	 eax, 134775813		; 08088405H
  0003b	ff c0		 inc	 eax
  0003d	89 41 04	 mov	 DWORD PTR [rcx+4], eax
  00040	8b c8		 mov	 ecx, eax
  00042	c1 e9 18	 shr	 ecx, 24
  00045	48 33 ca	 xor	 rcx, rdx
  00048	c1 ea 08	 shr	 edx, 8
  0004b	0f b6 c1	 movzx	 eax, cl
  0004e	41 8b 04 83	 mov	 eax, DWORD PTR [r11+rax*4]
  00052	33 c2		 xor	 eax, edx
  00054	41 89 40 08	 mov	 DWORD PTR [r8+8], eax

; 56   :     }
; 57   :     return c;

  00058	8b c3		 mov	 eax, ebx

; 58   : }

  0005a	48 8b 5c 24 08	 mov	 rbx, QWORD PTR [rsp+8]
  0005f	c3		 ret	 0
update_keys ENDP
; Function compile flags: /Ogtpy
_TEXT	ENDS
;	COMDAT decrypt_byte
_TEXT	SEGMENT
pkeys$ = 8
decrypt_byte PROC					; COMDAT

; 37   :     unsigned temp;  /* POTENTIAL BUG:  temp*(temp^1) may overflow in an
; 38   :                      * unpredictable manner on 16-bit systems; not a problem
; 39   :                      * with any known compiler so far, though */
; 40   : 
; 41   :     temp = ((unsigned)(*(pkeys+2)) & 0xffff) | 2;

  00000	8b 51 08	 mov	 edx, DWORD PTR [rcx+8]
  00003	81 e2 fd ff 00
	00		 and	 edx, 65533		; 0000fffdH
  00009	83 ca 02	 or	 edx, 2

; 42   :     return (int)(((temp * (temp ^ 1)) >> 8) & 0xff);

  0000c	8b c2		 mov	 eax, edx
  0000e	83 f0 01	 xor	 eax, 1
  00011	0f af c2	 imul	 eax, edx
  00014	c1 e8 08	 shr	 eax, 8
  00017	0f b6 c0	 movzx	 eax, al

; 43   : }

  0001a	c3		 ret	 0
decrypt_byte ENDP
; Function compile flags: /Ogtpy
; File c:\program files (x86)\microsoft visual studio 10.0\vc\include\time.inl
_TEXT	ENDS
;	COMDAT time
_TEXT	SEGMENT
time	PROC						; COMDAT

; 133  :     return _time64(_Time);

  00000	33 c9		 xor	 ecx, ecx

; 134  : }

  00002	48 ff 25 00 00
	00 00		 rex_jmp QWORD PTR __imp__time64
time	ENDP
PUBLIC	Write_GlobalComment
;	COMDAT pdata
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\zip.c
pdata	SEGMENT
$pdata$Write_GlobalComment DD imagerel $LN8
	DD	imagerel $LN8+143
	DD	imagerel $unwind$Write_GlobalComment
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$Write_GlobalComment DD 0a1a01H
	DD	09741aH
	DD	08641aH
	DD	07541aH
	DD	06341aH
	DD	0c016321aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT Write_GlobalComment
_TEXT	SEGMENT
zi$ = 48
global_comment$ = 56
Write_GlobalComment PROC				; COMDAT

; 1865 : {

$LN8:
  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 6c 24 10	 mov	 QWORD PTR [rsp+16], rbp
  0000a	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000f	48 89 7c 24 20	 mov	 QWORD PTR [rsp+32], rdi
  00014	41 54		 push	 r12
  00016	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 1866 :   int err = ZIP_OK;
; 1867 :   uInt size_global_comment = 0;

  0001a	33 db		 xor	 ebx, ebx

; 1868 : 
; 1869 :   if(global_comment != NULL)

  0001c	49 83 cc ff	 or	 r12, -1
  00020	48 8b f2	 mov	 rsi, rdx
  00023	48 8b e9	 mov	 rbp, rcx
  00026	48 85 d2	 test	 rdx, rdx
  00029	74 11		 je	 SHORT $LN3@Write_Glob

; 1870 :     size_global_comment = (uInt)strlen(global_comment);

  0002b	33 c0		 xor	 eax, eax
  0002d	49 8b cc	 mov	 rcx, r12
  00030	48 8b fa	 mov	 rdi, rdx
  00033	f2 ae		 repne scasb
  00035	48 f7 d1	 not	 rcx
  00038	48 8d 59 ff	 lea	 rbx, QWORD PTR [rcx-1]
$LN3@Write_Glob:

; 1871 : 
; 1872 :   err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)size_global_comment,2);

  0003c	48 8b 55 58	 mov	 rdx, QWORD PTR [rbp+88]
  00040	44 8b c3	 mov	 r8d, ebx
  00043	41 b9 02 00 00
	00		 mov	 r9d, 2
  00049	48 8b cd	 mov	 rcx, rbp
  0004c	e8 00 00 00 00	 call	 zip64local_putValue
  00051	8b f8		 mov	 edi, eax

; 1873 : 
; 1874 :   if (err == ZIP_OK && size_global_comment > 0)

  00053	85 c0		 test	 eax, eax
  00055	75 1d		 jne	 SHORT $LN1@Write_Glob
  00057	85 db		 test	 ebx, ebx
  00059	74 19		 je	 SHORT $LN1@Write_Glob

; 1875 :   {
; 1876 :     if (ZWRITE64(zi->z_filefunc,zi->filestream, global_comment, size_global_comment) != size_global_comment)

  0005b	48 8b 55 58	 mov	 rdx, QWORD PTR [rbp+88]
  0005f	48 8b 4d 38	 mov	 rcx, QWORD PTR [rbp+56]
  00063	44 8b cb	 mov	 r9d, ebx
  00066	4c 8b c6	 mov	 r8, rsi
  00069	ff 55 10	 call	 QWORD PTR [rbp+16]
  0006c	3b c3		 cmp	 eax, ebx
  0006e	41 0f 45 fc	 cmovne	 edi, r12d

; 1877 :       err = ZIP_ERRNO;
; 1878 :   }
; 1879 :   return err;

  00072	8b c7		 mov	 eax, edi
$LN1@Write_Glob:

; 1880 : }

  00074	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  00079	48 8b 6c 24 38	 mov	 rbp, QWORD PTR [rsp+56]
  0007e	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  00083	48 8b 7c 24 48	 mov	 rdi, QWORD PTR [rsp+72]
  00088	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0008c	41 5c		 pop	 r12
  0008e	c3		 ret	 0
Write_GlobalComment ENDP
_TEXT	ENDS
PUBLIC	Write_EndOfCentralDirectoryRecord
;	COMDAT pdata
pdata	SEGMENT
$pdata$Write_EndOfCentralDirectoryRecord DD imagerel $LN24
	DD	imagerel $LN24+285
	DD	imagerel $unwind$Write_EndOfCentralDirectoryRecord
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$Write_EndOfCentralDirectoryRecord DD 060f01H
	DD	07640fH
	DD	06340fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT Write_EndOfCentralDirectoryRecord
_TEXT	SEGMENT
zi$ = 48
size_centraldir$ = 56
centraldir_pos_inzip$ = 64
Write_EndOfCentralDirectoryRecord PROC			; COMDAT

; 1817 : {

$LN24:
  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 74 24 10	 mov	 QWORD PTR [rsp+16], rsi
  0000a	57		 push	 rdi
  0000b	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  0000f	8b f2		 mov	 esi, edx

; 1818 :   int err = ZIP_OK;
; 1819 : 
; 1820 :   /*signature*/
; 1821 :   err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)ENDHEADERMAGIC,4);

  00011	48 8b 51 58	 mov	 rdx, QWORD PTR [rcx+88]
  00015	49 8b f8	 mov	 rdi, r8
  00018	41 b9 04 00 00
	00		 mov	 r9d, 4
  0001e	41 b8 50 4b 05
	06		 mov	 r8d, 101010256		; 06054b50H
  00024	48 8b d9	 mov	 rbx, rcx
  00027	e8 00 00 00 00	 call	 zip64local_putValue

; 1822 : 
; 1823 :   if (err==ZIP_OK) /* number of this disk */

  0002c	85 c0		 test	 eax, eax
  0002e	0f 85 d9 00 00
	00		 jne	 $LN20@Write_EndO

; 1824 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,2);

  00034	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00038	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  0003c	45 33 c0	 xor	 r8d, r8d
  0003f	48 8b cb	 mov	 rcx, rbx
  00042	e8 00 00 00 00	 call	 zip64local_putValue

; 1825 : 
; 1826 :   if (err==ZIP_OK) /* number of the disk with the start of the central directory */

  00047	85 c0		 test	 eax, eax
  00049	0f 85 be 00 00
	00		 jne	 $LN20@Write_EndO

; 1827 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,2);

  0004f	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00053	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  00057	45 33 c0	 xor	 r8d, r8d
  0005a	48 8b cb	 mov	 rcx, rbx
  0005d	e8 00 00 00 00	 call	 zip64local_putValue

; 1828 : 
; 1829 :   if (err==ZIP_OK) /* total number of entries in the central dir on this disk */

  00062	85 c0		 test	 eax, eax
  00064	0f 85 a3 00 00
	00		 jne	 $LN20@Write_EndO

; 1830 :   {
; 1831 :     {
; 1832 :       if(zi->number_entry >= 0xFFFF)

  0006a	48 81 bb 58 01
	01 00 ff ff 00
	00		 cmp	 QWORD PTR [rbx+65880], 65535 ; 0000ffffH

; 1833 :         err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0xffff,2); // use value in ZIP64 record

  00075	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00079	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  0007d	48 8b cb	 mov	 rcx, rbx
  00080	41 b8 ff ff 00
	00		 mov	 r8d, 65535		; 0000ffffH
  00086	73 07		 jae	 SHORT $LN21@Write_EndO

; 1834 :       else
; 1835 :         err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)zi->number_entry,2);

  00088	44 8b 83 58 01
	01 00		 mov	 r8d, DWORD PTR [rbx+65880]
$LN21@Write_EndO:
  0008f	e8 00 00 00 00	 call	 zip64local_putValue

; 1836 :     }
; 1837 :   }
; 1838 : 
; 1839 :   if (err==ZIP_OK) /* total number of entries in the central dir */

  00094	85 c0		 test	 eax, eax
  00096	75 75		 jne	 SHORT $LN20@Write_EndO

; 1840 :   {
; 1841 :     if(zi->number_entry >= 0xFFFF)

  00098	48 81 bb 58 01
	01 00 ff ff 00
	00		 cmp	 QWORD PTR [rbx+65880], 65535 ; 0000ffffH

; 1842 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0xffff,2); // use value in ZIP64 record

  000a3	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000a7	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  000ab	48 8b cb	 mov	 rcx, rbx
  000ae	41 b8 ff ff 00
	00		 mov	 r8d, 65535		; 0000ffffH
  000b4	73 07		 jae	 SHORT $LN22@Write_EndO

; 1843 :     else
; 1844 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)zi->number_entry,2);

  000b6	44 8b 83 58 01
	01 00		 mov	 r8d, DWORD PTR [rbx+65880]
$LN22@Write_EndO:
  000bd	e8 00 00 00 00	 call	 zip64local_putValue

; 1845 :   }
; 1846 : 
; 1847 :   if (err==ZIP_OK) /* size of the central directory */

  000c2	85 c0		 test	 eax, eax
  000c4	75 47		 jne	 SHORT $LN20@Write_EndO

; 1848 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)size_centraldir,4);

  000c6	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000ca	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  000ce	4c 8b c6	 mov	 r8, rsi
  000d1	48 8b cb	 mov	 rcx, rbx
  000d4	e8 00 00 00 00	 call	 zip64local_putValue

; 1849 : 
; 1850 :   if (err==ZIP_OK) /* offset of start of central directory with respect to the starting disk number */

  000d9	85 c0		 test	 eax, eax
  000db	75 30		 jne	 SHORT $LN20@Write_EndO

; 1851 :   {
; 1852 :     ZPOS64_T pos = centraldir_pos_inzip - zi->add_position_when_writting_offset;
; 1853 :     if(pos >= 0xffffffff)
; 1854 :     {
; 1855 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream, (uLong)0xffffffff,4);

  000dd	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000e1	48 8b c7	 mov	 rax, rdi
  000e4	41 b8 ff ff ff
	ff		 mov	 r8d, -1			; ffffffffH
  000ea	48 2b 83 50 01
	01 00		 sub	 rax, QWORD PTR [rbx+65872]
  000f1	41 b9 04 00 00
	00		 mov	 r9d, 4
  000f7	48 8b cb	 mov	 rcx, rbx
  000fa	49 3b c0	 cmp	 rax, r8

; 1856 :     }
; 1857 :     else

  000fd	73 09		 jae	 SHORT $LN23@Write_EndO

; 1858 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream, (uLong)(centraldir_pos_inzip - zi->add_position_when_writting_offset),4);

  000ff	2b bb 50 01 01
	00		 sub	 edi, DWORD PTR [rbx+65872]
  00105	44 8b c7	 mov	 r8d, edi
$LN23@Write_EndO:
  00108	e8 00 00 00 00	 call	 zip64local_putValue
$LN20@Write_EndO:

; 1859 :   }
; 1860 : 
; 1861 :    return err;
; 1862 : }

  0010d	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  00112	48 8b 74 24 38	 mov	 rsi, QWORD PTR [rsp+56]
  00117	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0011b	5f		 pop	 rdi
  0011c	c3		 ret	 0
Write_EndOfCentralDirectoryRecord ENDP
_TEXT	ENDS
PUBLIC	Write_Zip64EndOfCentralDirectoryRecord
;	COMDAT pdata
pdata	SEGMENT
$pdata$Write_Zip64EndOfCentralDirectoryRecord DD imagerel $LN12
	DD	imagerel $LN12+301
	DD	imagerel $unwind$Write_Zip64EndOfCentralDirectoryRecord
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$Write_Zip64EndOfCentralDirectoryRecord DD 060f01H
	DD	07640fH
	DD	06340fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT Write_Zip64EndOfCentralDirectoryRecord
_TEXT	SEGMENT
zi$ = 48
size_centraldir$ = 56
centraldir_pos_inzip$ = 64
Write_Zip64EndOfCentralDirectoryRecord PROC		; COMDAT

; 1778 : {

$LN12:
  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 74 24 10	 mov	 QWORD PTR [rsp+16], rsi
  0000a	57		 push	 rdi
  0000b	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  0000f	8b f2		 mov	 esi, edx

; 1779 :   int err = ZIP_OK;
; 1780 : 
; 1781 :   uLong Zip64DataSize = 44;
; 1782 : 
; 1783 :   err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)ZIP64ENDHEADERMAGIC,4);

  00011	48 8b 51 58	 mov	 rdx, QWORD PTR [rcx+88]
  00015	49 8b f8	 mov	 rdi, r8
  00018	41 b9 04 00 00
	00		 mov	 r9d, 4
  0001e	41 b8 50 4b 06
	06		 mov	 r8d, 101075792		; 06064b50H
  00024	48 8b d9	 mov	 rbx, rcx
  00027	e8 00 00 00 00	 call	 zip64local_putValue

; 1784 : 
; 1785 :   if (err==ZIP_OK) /* size of this 'zip64 end of central directory' */

  0002c	85 c0		 test	 eax, eax
  0002e	0f 85 e9 00 00
	00		 jne	 $LN1@Write_Zip6

; 1786 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(ZPOS64_T)Zip64DataSize,8); // why ZPOS64_T of this ?

  00034	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00038	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  0003c	44 8d 40 2c	 lea	 r8d, QWORD PTR [rax+44]
  00040	48 8b cb	 mov	 rcx, rbx
  00043	e8 00 00 00 00	 call	 zip64local_putValue

; 1787 : 
; 1788 :   if (err==ZIP_OK) /* version made by */

  00048	85 c0		 test	 eax, eax
  0004a	0f 85 cd 00 00
	00		 jne	 $LN1@Write_Zip6

; 1789 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)45,2);

  00050	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00054	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  00058	44 8d 40 2d	 lea	 r8d, QWORD PTR [rax+45]
  0005c	48 8b cb	 mov	 rcx, rbx
  0005f	e8 00 00 00 00	 call	 zip64local_putValue

; 1790 : 
; 1791 :   if (err==ZIP_OK) /* version needed */

  00064	85 c0		 test	 eax, eax
  00066	0f 85 b1 00 00
	00		 jne	 $LN1@Write_Zip6

; 1792 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)45,2);

  0006c	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00070	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  00074	44 8d 40 2d	 lea	 r8d, QWORD PTR [rax+45]
  00078	48 8b cb	 mov	 rcx, rbx
  0007b	e8 00 00 00 00	 call	 zip64local_putValue

; 1793 : 
; 1794 :   if (err==ZIP_OK) /* number of this disk */

  00080	85 c0		 test	 eax, eax
  00082	0f 85 95 00 00
	00		 jne	 $LN1@Write_Zip6

; 1795 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,4);

  00088	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0008c	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  00090	45 33 c0	 xor	 r8d, r8d
  00093	48 8b cb	 mov	 rcx, rbx
  00096	e8 00 00 00 00	 call	 zip64local_putValue

; 1796 : 
; 1797 :   if (err==ZIP_OK) /* number of the disk with the start of the central directory */

  0009b	85 c0		 test	 eax, eax
  0009d	75 7e		 jne	 SHORT $LN1@Write_Zip6

; 1798 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,4);

  0009f	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000a3	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  000a7	45 33 c0	 xor	 r8d, r8d
  000aa	48 8b cb	 mov	 rcx, rbx
  000ad	e8 00 00 00 00	 call	 zip64local_putValue

; 1799 : 
; 1800 :   if (err==ZIP_OK) /* total number of entries in the central dir on this disk */

  000b2	85 c0		 test	 eax, eax
  000b4	75 67		 jne	 SHORT $LN1@Write_Zip6

; 1801 :     err = zip64local_putValue(&zi->z_filefunc, zi->filestream, zi->number_entry, 8);

  000b6	4c 8b 83 58 01
	01 00		 mov	 r8, QWORD PTR [rbx+65880]
  000bd	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000c1	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  000c5	48 8b cb	 mov	 rcx, rbx
  000c8	e8 00 00 00 00	 call	 zip64local_putValue

; 1802 : 
; 1803 :   if (err==ZIP_OK) /* total number of entries in the central dir */

  000cd	85 c0		 test	 eax, eax
  000cf	75 4c		 jne	 SHORT $LN1@Write_Zip6

; 1804 :     err = zip64local_putValue(&zi->z_filefunc, zi->filestream, zi->number_entry, 8);

  000d1	4c 8b 83 58 01
	01 00		 mov	 r8, QWORD PTR [rbx+65880]
  000d8	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000dc	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  000e0	48 8b cb	 mov	 rcx, rbx
  000e3	e8 00 00 00 00	 call	 zip64local_putValue

; 1805 : 
; 1806 :   if (err==ZIP_OK) /* size of the central directory */

  000e8	85 c0		 test	 eax, eax
  000ea	75 31		 jne	 SHORT $LN1@Write_Zip6

; 1807 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(ZPOS64_T)size_centraldir,8);

  000ec	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000f0	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  000f4	44 8b c6	 mov	 r8d, esi
  000f7	48 8b cb	 mov	 rcx, rbx
  000fa	e8 00 00 00 00	 call	 zip64local_putValue

; 1808 : 
; 1809 :   if (err==ZIP_OK) /* offset of start of central directory with respect to the starting disk number */

  000ff	85 c0		 test	 eax, eax
  00101	75 1a		 jne	 SHORT $LN1@Write_Zip6

; 1810 :   {
; 1811 :     ZPOS64_T pos = centraldir_pos_inzip - zi->add_position_when_writting_offset;

  00103	48 2b bb 50 01
	01 00		 sub	 rdi, QWORD PTR [rbx+65872]

; 1812 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream, (ZPOS64_T)pos,8);

  0010a	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0010e	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  00112	4c 8b c7	 mov	 r8, rdi
  00115	48 8b cb	 mov	 rcx, rbx
  00118	e8 00 00 00 00	 call	 zip64local_putValue
$LN1@Write_Zip6:

; 1813 :   }
; 1814 :   return err;
; 1815 : }

  0011d	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  00122	48 8b 74 24 38	 mov	 rsi, QWORD PTR [rsp+56]
  00127	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0012b	5f		 pop	 rdi
  0012c	c3		 ret	 0
Write_Zip64EndOfCentralDirectoryRecord ENDP
_TEXT	ENDS
PUBLIC	Write_Zip64EndOfCentralDirectoryLocator
;	COMDAT pdata
pdata	SEGMENT
$pdata$Write_Zip64EndOfCentralDirectoryLocator DD imagerel $LN9
	DD	imagerel $LN9+125
	DD	imagerel $unwind$Write_Zip64EndOfCentralDirectoryLocator
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$Write_Zip64EndOfCentralDirectoryLocator DD 040a01H
	DD	06340aH
	DD	07006320aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT Write_Zip64EndOfCentralDirectoryLocator
_TEXT	SEGMENT
zi$ = 48
zip64eocd_pos_inzip$ = 56
Write_Zip64EndOfCentralDirectoryLocator PROC		; COMDAT

; 1756 : {

$LN9:
  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	57		 push	 rdi
  00006	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  0000a	48 8b fa	 mov	 rdi, rdx

; 1757 :   int err = ZIP_OK;
; 1758 :   ZPOS64_T pos = zip64eocd_pos_inzip - zi->add_position_when_writting_offset;
; 1759 : 
; 1760 :   err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)ZIP64ENDLOCHEADERMAGIC,4);

  0000d	48 8b 51 58	 mov	 rdx, QWORD PTR [rcx+88]
  00011	41 b9 04 00 00
	00		 mov	 r9d, 4
  00017	48 2b b9 50 01
	01 00		 sub	 rdi, QWORD PTR [rcx+65872]
  0001e	41 b8 50 4b 06
	07		 mov	 r8d, 117853008		; 07064b50H
  00024	48 8b d9	 mov	 rbx, rcx
  00027	e8 00 00 00 00	 call	 zip64local_putValue

; 1761 : 
; 1762 :   /*num disks*/
; 1763 :     if (err==ZIP_OK) /* number of the disk with the start of the central directory */

  0002c	85 c0		 test	 eax, eax
  0002e	75 42		 jne	 SHORT $LN8@Write_Zip6@2

; 1764 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,4);

  00030	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00034	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  00038	45 33 c0	 xor	 r8d, r8d
  0003b	48 8b cb	 mov	 rcx, rbx
  0003e	e8 00 00 00 00	 call	 zip64local_putValue

; 1765 : 
; 1766 :   /*relative offset*/
; 1767 :     if (err==ZIP_OK) /* Relative offset to the Zip64EndOfCentralDirectory */

  00043	85 c0		 test	 eax, eax
  00045	75 2b		 jne	 SHORT $LN8@Write_Zip6@2

; 1768 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream, pos,8);

  00047	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0004b	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  0004f	4c 8b c7	 mov	 r8, rdi
  00052	48 8b cb	 mov	 rcx, rbx
  00055	e8 00 00 00 00	 call	 zip64local_putValue

; 1769 : 
; 1770 :   /*total disks*/ /* Do not support spawning of disk so always say 1 here*/
; 1771 :     if (err==ZIP_OK) /* number of the disk with the start of the central directory */

  0005a	85 c0		 test	 eax, eax
  0005c	75 14		 jne	 SHORT $LN8@Write_Zip6@2

; 1772 :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)1,4);

  0005e	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00062	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  00066	44 8d 40 01	 lea	 r8d, QWORD PTR [rax+1]
  0006a	48 8b cb	 mov	 rcx, rbx
  0006d	e8 00 00 00 00	 call	 zip64local_putValue
$LN8@Write_Zip6@2:

; 1773 : 
; 1774 :     return err;
; 1775 : }

  00072	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  00077	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0007b	5f		 pop	 rdi
  0007c	c3		 ret	 0
Write_Zip64EndOfCentralDirectoryLocator ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64FlushWriteBuffer DD imagerel zip64FlushWriteBuffer
	DD	imagerel zip64FlushWriteBuffer+22
	DD	imagerel $unwind$zip64FlushWriteBuffer
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$zip64FlushWriteBuffer DD imagerel zip64FlushWriteBuffer+22
	DD	imagerel zip64FlushWriteBuffer+37
	DD	imagerel $chain$0$zip64FlushWriteBuffer
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$2$zip64FlushWriteBuffer DD imagerel zip64FlushWriteBuffer+37
	DD	imagerel zip64FlushWriteBuffer+126
	DD	imagerel $chain$2$zip64FlushWriteBuffer
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$3$zip64FlushWriteBuffer DD imagerel zip64FlushWriteBuffer+126
	DD	imagerel zip64FlushWriteBuffer+131
	DD	imagerel $chain$3$zip64FlushWriteBuffer
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$4$zip64FlushWriteBuffer DD imagerel zip64FlushWriteBuffer+131
	DD	imagerel zip64FlushWriteBuffer+225
	DD	imagerel $chain$4$zip64FlushWriteBuffer
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$4$zip64FlushWriteBuffer DD 021H
	DD	imagerel zip64FlushWriteBuffer
	DD	imagerel zip64FlushWriteBuffer+22
	DD	imagerel $unwind$zip64FlushWriteBuffer
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$3$zip64FlushWriteBuffer DD 021H
	DD	imagerel zip64FlushWriteBuffer+22
	DD	imagerel zip64FlushWriteBuffer+37
	DD	imagerel $chain$0$zip64FlushWriteBuffer
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$2$zip64FlushWriteBuffer DD 040a21H
	DD	08c40aH
	DD	077405H
	DD	imagerel zip64FlushWriteBuffer+22
	DD	imagerel zip64FlushWriteBuffer+37
	DD	imagerel $chain$0$zip64FlushWriteBuffer
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$zip64FlushWriteBuffer DD 020521H
	DD	065405H
	DD	imagerel zip64FlushWriteBuffer
	DD	imagerel zip64FlushWriteBuffer+22
	DD	imagerel $unwind$zip64FlushWriteBuffer
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64FlushWriteBuffer DD 040a01H
	DD	09340aH
	DD	06006320aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64FlushWriteBuffer
_TEXT	SEGMENT
zi$ = 48
zip64FlushWriteBuffer PROC				; COMDAT

; 1364 : {

  00000	48 89 5c 24 20	 mov	 QWORD PTR [rsp+32], rbx
  00005	56		 push	 rsi
  00006	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 1365 :     int err=ZIP_OK;
; 1366 : 
; 1367 :     if (zi->ci.encrypt != 0)

  0000a	83 b9 08 01 01
	00 00		 cmp	 DWORD PTR [rcx+65800], 0
  00011	48 8b f1	 mov	 rsi, rcx
  00014	74 6d		 je	 SHORT $LN2@zip64Flush

; 1368 :     {
; 1369 : #ifndef NOCRYPT
; 1370 :         uInt i;
; 1371 :         int t;
; 1372 :         for (i=0;i<zi->ci.pos_in_buffered_data;i++)

  00016	48 89 6c 24 30	 mov	 QWORD PTR [rsp+48], rbp
  0001b	33 ed		 xor	 ebp, ebp
  0001d	39 a9 d4 00 00
	00		 cmp	 DWORD PTR [rcx+212], ebp
  00023	76 59		 jbe	 SHORT $LN10@zip64Flush
  00025	48 89 7c 24 38	 mov	 QWORD PTR [rsp+56], rdi
  0002a	4c 89 64 24 40	 mov	 QWORD PTR [rsp+64], r12
  0002f	48 8d b9 00 01
	00 00		 lea	 rdi, QWORD PTR [rcx+256]
  00036	66 66 0f 1f 84
	00 00 00 00 00	 npad	 10
$LL4@zip64Flush:

; 1373 :             zi->ci.buffered_data[i] = zencode(zi->ci.keys, zi->ci.pcrc_32_tab, zi->ci.buffered_data[i],t);

  00040	48 8d 8e 28 01
	01 00		 lea	 rcx, QWORD PTR [rsi+65832]
  00047	e8 00 00 00 00	 call	 decrypt_byte
  0004c	44 0f b6 07	 movzx	 r8d, BYTE PTR [rdi]
  00050	48 8b 96 38 01
	01 00		 mov	 rdx, QWORD PTR [rsi+65848]
  00057	48 8d 8e 28 01
	01 00		 lea	 rcx, QWORD PTR [rsi+65832]
  0005e	8b d8		 mov	 ebx, eax
  00060	e8 00 00 00 00	 call	 update_keys
  00065	30 1f		 xor	 BYTE PTR [rdi], bl
  00067	ff c5		 inc	 ebp
  00069	48 ff c7	 inc	 rdi
  0006c	3b ae d4 00 00
	00		 cmp	 ebp, DWORD PTR [rsi+212]
  00072	72 cc		 jb	 SHORT $LL4@zip64Flush
  00074	4c 8b 64 24 40	 mov	 r12, QWORD PTR [rsp+64]
  00079	48 8b 7c 24 38	 mov	 rdi, QWORD PTR [rsp+56]
$LN10@zip64Flush:
  0007e	48 8b 6c 24 30	 mov	 rbp, QWORD PTR [rsp+48]
$LN2@zip64Flush:

; 1374 : #endif
; 1375 :     }
; 1376 : 
; 1377 :     if (ZWRITE64(zi->z_filefunc,zi->filestream,zi->ci.buffered_data,zi->ci.pos_in_buffered_data) != zi->ci.pos_in_buffered_data)

  00083	44 8b 8e d4 00
	00 00		 mov	 r9d, DWORD PTR [rsi+212]
  0008a	48 8b 56 58	 mov	 rdx, QWORD PTR [rsi+88]
  0008e	48 8b 4e 38	 mov	 rcx, QWORD PTR [rsi+56]
  00092	8b 9e d4 00 00
	00		 mov	 ebx, DWORD PTR [rsi+212]
  00098	4c 8d 86 00 01
	00 00		 lea	 r8, QWORD PTR [rsi+256]
  0009f	ff 56 10	 call	 QWORD PTR [rsi+16]
  000a2	83 c9 ff	 or	 ecx, -1
  000a5	33 d2		 xor	 edx, edx
  000a7	3b c3		 cmp	 eax, ebx

; 1378 :       err = ZIP_ERRNO;
; 1379 : 
; 1380 :     zi->ci.totalCompressedData += zi->ci.pos_in_buffered_data;
; 1381 : 
; 1382 : #ifdef HAVE_BZIP2
; 1383 :     if(zi->ci.method == Z_BZIP2ED)
; 1384 :     {
; 1385 :       zi->ci.totalUncompressedData += zi->ci.bstream.total_in_lo32;
; 1386 :       zi->ci.bstream.total_in_lo32 = 0;
; 1387 :       zi->ci.bstream.total_in_hi32 = 0;
; 1388 :     }
; 1389 :     else
; 1390 : #endif
; 1391 :     {
; 1392 :       zi->ci.totalUncompressedData += zi->ci.stream.total_in;
; 1393 :       zi->ci.stream.total_in = 0;
; 1394 :     }
; 1395 : 
; 1396 : 
; 1397 :     zi->ci.pos_in_buffered_data = 0;

  000a9	c7 86 d4 00 00
	00 00 00 00 00	 mov	 DWORD PTR [rsi+212], 0
  000b3	0f 45 d1	 cmovne	 edx, ecx
  000b6	8b 8e 84 00 00
	00		 mov	 ecx, DWORD PTR [rsi+132]
  000bc	48 01 9e 18 01
	01 00		 add	 QWORD PTR [rsi+65816], rbx

; 1398 : 
; 1399 :     return err;
; 1400 : }

  000c3	48 8b 5c 24 48	 mov	 rbx, QWORD PTR [rsp+72]
  000c8	48 01 8e 20 01
	01 00		 add	 QWORD PTR [rsi+65824], rcx
  000cf	c7 86 84 00 00
	00 00 00 00 00	 mov	 DWORD PTR [rsi+132], 0
  000d9	8b c2		 mov	 eax, edx
  000db	48 83 c4 20	 add	 rsp, 32			; 00000020H
  000df	5e		 pop	 rsi
  000e0	c3		 ret	 0
zip64FlushWriteBuffer ENDP
_TEXT	ENDS
PUBLIC	Write_LocalFileHeader
;	COMDAT pdata
pdata	SEGMENT
$pdata$Write_LocalFileHeader DD imagerel $LN34
	DD	imagerel $LN34+247
	DD	imagerel $unwind$Write_LocalFileHeader
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$Write_LocalFileHeader DD imagerel $LN34+247
	DD	imagerel $LN34+350
	DD	imagerel $chain$0$Write_LocalFileHeader
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$1$Write_LocalFileHeader DD imagerel $LN34+350
	DD	imagerel $LN34+600
	DD	imagerel $chain$1$Write_LocalFileHeader
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$1$Write_LocalFileHeader DD 021H
	DD	imagerel $LN34
	DD	imagerel $LN34+247
	DD	imagerel $unwind$Write_LocalFileHeader
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$Write_LocalFileHeader DD 020521H
	DD	08e405H
	DD	imagerel $LN34
	DD	imagerel $LN34+247
	DD	imagerel $unwind$Write_LocalFileHeader
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$Write_LocalFileHeader DD 0a1801H
	DD	0b6418H
	DD	0a5418H
	DD	093418H
	DD	0d0143218H
	DD	07010c012H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT Write_LocalFileHeader
_TEXT	SEGMENT
zi$ = 64
filename$ = 72
size_extrafield_local$ = 80
extrafield_local$ = 88
Write_LocalFileHeader PROC				; COMDAT

; 959  : {

$LN34:
  00000	48 89 5c 24 10	 mov	 QWORD PTR [rsp+16], rbx
  00005	48 89 6c 24 18	 mov	 QWORD PTR [rsp+24], rbp
  0000a	48 89 74 24 20	 mov	 QWORD PTR [rsp+32], rsi
  0000f	57		 push	 rdi
  00010	41 54		 push	 r12
  00012	41 55		 push	 r13
  00014	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  00018	48 8b d9	 mov	 rbx, rcx

; 960  :   /* write the local header */
; 961  :   int err;
; 962  :   uInt size_filename = (uInt)strlen(filename);

  0001b	48 83 c9 ff	 or	 rcx, -1
  0001f	33 c0		 xor	 eax, eax
  00021	48 8b fa	 mov	 rdi, rdx
  00024	4c 8b e2	 mov	 r12, rdx

; 963  :   uInt size_extrafield = size_extrafield_local;
; 964  : 
; 965  :   err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)LOCALHEADERMAGIC, 4);

  00027	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0002b	f2 ae		 repne scasb
  0002d	4d 8b e9	 mov	 r13, r9
  00030	41 8b f0	 mov	 esi, r8d
  00033	48 f7 d1	 not	 rcx
  00036	41 8b f8	 mov	 edi, r8d
  00039	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  0003d	48 8d 69 ff	 lea	 rbp, QWORD PTR [rcx-1]
  00041	48 8b cb	 mov	 rcx, rbx
  00044	41 b8 50 4b 03
	04		 mov	 r8d, 67324752		; 04034b50H
  0004a	e8 00 00 00 00	 call	 zip64local_putValue

; 966  : 
; 967  :   if (err==ZIP_OK)

  0004f	85 c0		 test	 eax, eax
  00051	0f 85 07 01 00
	00		 jne	 $LN8@Write_Loca

; 968  :   {
; 969  :     if(zi->ci.zip64)
; 970  :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)45,2);/* version needed to extract */

  00057	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0005b	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  0005f	48 8b cb	 mov	 rcx, rbx
  00062	44 8d 40 2d	 lea	 r8d, QWORD PTR [rax+45]
  00066	39 83 0c 01 01
	00		 cmp	 DWORD PTR [rbx+65804], eax
  0006c	75 04		 jne	 SHORT $LN30@Write_Loca

; 971  :     else
; 972  :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)20,2);/* version needed to extract */

  0006e	44 8d 40 14	 lea	 r8d, QWORD PTR [rax+20]
$LN30@Write_Loca:
  00072	e8 00 00 00 00	 call	 zip64local_putValue

; 973  :   }
; 974  : 
; 975  :   if (err==ZIP_OK)

  00077	85 c0		 test	 eax, eax
  00079	0f 85 df 00 00
	00		 jne	 $LN8@Write_Loca

; 976  :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)zi->ci.flag,2);

  0007f	44 8b 83 f4 00
	00 00		 mov	 r8d, DWORD PTR [rbx+244]
  00086	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0008a	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  0008e	48 8b cb	 mov	 rcx, rbx
  00091	e8 00 00 00 00	 call	 zip64local_putValue

; 977  : 
; 978  :   if (err==ZIP_OK)

  00096	85 c0		 test	 eax, eax
  00098	0f 85 c0 00 00
	00		 jne	 $LN8@Write_Loca

; 979  :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)zi->ci.method,2);

  0009e	44 8b 83 f8 00
	00 00		 mov	 r8d, DWORD PTR [rbx+248]
  000a5	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000a9	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  000ad	48 8b cb	 mov	 rcx, rbx
  000b0	e8 00 00 00 00	 call	 zip64local_putValue

; 980  : 
; 981  :   if (err==ZIP_OK)

  000b5	85 c0		 test	 eax, eax
  000b7	0f 85 a1 00 00
	00		 jne	 $LN8@Write_Loca

; 982  :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)zi->ci.dosDate,4);

  000bd	44 8b 83 00 01
	01 00		 mov	 r8d, DWORD PTR [rbx+65792]
  000c4	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000c8	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  000cc	48 8b cb	 mov	 rcx, rbx
  000cf	e8 00 00 00 00	 call	 zip64local_putValue

; 983  : 
; 984  :   // CRC / Compressed size / Uncompressed size will be filled in later and rewritten later
; 985  :   if (err==ZIP_OK)

  000d4	85 c0		 test	 eax, eax
  000d6	0f 85 82 00 00
	00		 jne	 $LN8@Write_Loca

; 986  :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,4); /* crc 32, unknown */

  000dc	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000e0	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  000e4	45 33 c0	 xor	 r8d, r8d
  000e7	48 8b cb	 mov	 rcx, rbx
  000ea	e8 00 00 00 00	 call	 zip64local_putValue

; 987  :   if (err==ZIP_OK)

  000ef	85 c0		 test	 eax, eax
  000f1	75 6b		 jne	 SHORT $LN8@Write_Loca

; 988  :   {
; 989  :     if(zi->ci.zip64)
; 990  :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0xFFFFFFFF,4); /* compressed size, unknown */

  000f3	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000f7	4c 89 74 24 40	 mov	 QWORD PTR [rsp+64], r14
  000fc	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  00100	41 be ff ff ff
	ff		 mov	 r14d, -1		; ffffffffH
  00106	48 8b cb	 mov	 rcx, rbx
  00109	39 83 0c 01 01
	00		 cmp	 DWORD PTR [rbx+65804], eax
  0010f	74 05		 je	 SHORT $LN13@Write_Loca
  00111	45 8b c6	 mov	 r8d, r14d

; 991  :     else

  00114	eb 03		 jmp	 SHORT $LN31@Write_Loca
$LN13@Write_Loca:

; 992  :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,4); /* compressed size, unknown */

  00116	45 33 c0	 xor	 r8d, r8d
$LN31@Write_Loca:
  00119	e8 00 00 00 00	 call	 zip64local_putValue

; 993  :   }
; 994  :   if (err==ZIP_OK)

  0011e	85 c0		 test	 eax, eax
  00120	75 37		 jne	 SHORT $LN29@Write_Loca

; 995  :   {
; 996  :     if(zi->ci.zip64)
; 997  :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0xFFFFFFFF,4); /* uncompressed size, unknown */

  00122	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00126	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  0012a	48 8b cb	 mov	 rcx, rbx
  0012d	39 83 0c 01 01
	00		 cmp	 DWORD PTR [rbx+65804], eax
  00133	74 05		 je	 SHORT $LN10@Write_Loca
  00135	4d 8b c6	 mov	 r8, r14

; 998  :     else

  00138	eb 03		 jmp	 SHORT $LN32@Write_Loca
$LN10@Write_Loca:

; 999  :       err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)0,4); /* uncompressed size, unknown */

  0013a	45 33 c0	 xor	 r8d, r8d
$LN32@Write_Loca:
  0013d	e8 00 00 00 00	 call	 zip64local_putValue

; 1000 :   }
; 1001 : 
; 1002 :   if (err==ZIP_OK)

  00142	85 c0		 test	 eax, eax
  00144	75 13		 jne	 SHORT $LN29@Write_Loca

; 1003 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)size_filename,2);

  00146	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0014a	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  0014e	44 8b c5	 mov	 r8d, ebp
  00151	48 8b cb	 mov	 rcx, rbx
  00154	e8 00 00 00 00	 call	 zip64local_putValue
$LN29@Write_Loca:
  00159	4c 8b 74 24 40	 mov	 r14, QWORD PTR [rsp+64]
$LN8@Write_Loca:

; 1004 : 
; 1005 :   if(zi->ci.zip64)

  0015e	83 bb 0c 01 01
	00 00		 cmp	 DWORD PTR [rbx+65804], 0
  00165	74 03		 je	 SHORT $LN7@Write_Loca

; 1006 :   {
; 1007 :     size_extrafield += 20;

  00167	8d 7e 14	 lea	 edi, DWORD PTR [rsi+20]
$LN7@Write_Loca:

; 1008 :   }
; 1009 : 
; 1010 :   if (err==ZIP_OK)

  0016a	85 c0		 test	 eax, eax
  0016c	0f 85 cd 00 00
	00		 jne	 $LN28@Write_Loca

; 1011 :     err = zip64local_putValue(&zi->z_filefunc,zi->filestream,(uLong)size_extrafield,2);

  00172	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00176	44 8d 48 02	 lea	 r9d, QWORD PTR [rax+2]
  0017a	44 8b c7	 mov	 r8d, edi
  0017d	48 8b cb	 mov	 rcx, rbx
  00180	e8 00 00 00 00	 call	 zip64local_putValue
  00185	8b f8		 mov	 edi, eax

; 1012 : 
; 1013 :   if ((err==ZIP_OK) && (size_filename > 0))

  00187	85 c0		 test	 eax, eax
  00189	0f 85 b0 00 00
	00		 jne	 $LN28@Write_Loca
  0018f	85 ed		 test	 ebp, ebp
  00191	74 1d		 je	 SHORT $LN24@Write_Loca

; 1014 :   {
; 1015 :     if (ZWRITE64(zi->z_filefunc,zi->filestream,filename,size_filename)!=size_filename)

  00193	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00197	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  0019b	44 8b cd	 mov	 r9d, ebp
  0019e	4d 8b c4	 mov	 r8, r12
  001a1	ff 53 10	 call	 QWORD PTR [rbx+16]
  001a4	3b c5		 cmp	 eax, ebp
  001a6	74 08		 je	 SHORT $LN24@Write_Loca
$LN33@Write_Loca:

; 1042 :   }
; 1043 : 
; 1044 :   return err;

  001a8	83 c8 ff	 or	 eax, -1

; 1016 :       err = ZIP_ERRNO;
; 1017 :   }
; 1018 : 
; 1019 :   if ((err==ZIP_OK) && (size_extrafield_local > 0))

  001ab	e9 8f 00 00 00	 jmp	 $LN28@Write_Loca
$LN24@Write_Loca:
  001b0	85 f6		 test	 esi, esi
  001b2	74 15		 je	 SHORT $LN25@Write_Loca

; 1020 :   {
; 1021 :     if (ZWRITE64(zi->z_filefunc, zi->filestream, extrafield_local, size_extrafield_local) != size_extrafield_local)

  001b4	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001b8	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  001bc	44 8b ce	 mov	 r9d, esi
  001bf	4d 8b c5	 mov	 r8, r13
  001c2	ff 53 10	 call	 QWORD PTR [rbx+16]
  001c5	3b c6		 cmp	 eax, esi

; 1022 :       err = ZIP_ERRNO;
; 1023 :   }
; 1024 : 
; 1025 : 
; 1026 :   if ((err==ZIP_OK) && (zi->ci.zip64))

  001c7	75 df		 jne	 SHORT $LN33@Write_Loca
$LN25@Write_Loca:
  001c9	83 bb 0c 01 01
	00 00		 cmp	 DWORD PTR [rbx+65804], 0
  001d0	74 6b		 je	 SHORT $LN26@Write_Loca

; 1027 :   {
; 1028 :       // write the Zip64 extended info
; 1029 :       short HeaderID = 1;
; 1030 :       short DataSize = 16;
; 1031 :       ZPOS64_T CompressedSize = 0;
; 1032 :       ZPOS64_T UncompressedSize = 0;
; 1033 : 
; 1034 :       // Remember position of Zip64 extended info for the local file header. (needed when we update size after done with file)
; 1035 :       zi->ci.pos_zip64extrainfo = ZTELL64(zi->z_filefunc,zi->filestream);

  001d2	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001d6	48 8b cb	 mov	 rcx, rbx
  001d9	e8 00 00 00 00	 call	 call_ztell64

; 1036 : 
; 1037 :       err = zip64local_putValue(&zi->z_filefunc, zi->filestream, (short)HeaderID,2);

  001de	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001e2	41 b9 02 00 00
	00		 mov	 r9d, 2
  001e8	45 8d 41 ff	 lea	 r8d, QWORD PTR [r9-1]
  001ec	48 8b cb	 mov	 rcx, rbx
  001ef	48 89 83 10 01
	01 00		 mov	 QWORD PTR [rbx+65808], rax
  001f6	e8 00 00 00 00	 call	 zip64local_putValue

; 1038 :       err = zip64local_putValue(&zi->z_filefunc, zi->filestream, (short)DataSize,2);

  001fb	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001ff	41 b9 02 00 00
	00		 mov	 r9d, 2
  00205	45 8d 41 0e	 lea	 r8d, QWORD PTR [r9+14]
  00209	48 8b cb	 mov	 rcx, rbx
  0020c	e8 00 00 00 00	 call	 zip64local_putValue

; 1039 : 
; 1040 :       err = zip64local_putValue(&zi->z_filefunc, zi->filestream, (ZPOS64_T)UncompressedSize,8);

  00211	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00215	41 b9 08 00 00
	00		 mov	 r9d, 8
  0021b	45 33 c0	 xor	 r8d, r8d
  0021e	48 8b cb	 mov	 rcx, rbx
  00221	e8 00 00 00 00	 call	 zip64local_putValue

; 1041 :       err = zip64local_putValue(&zi->z_filefunc, zi->filestream, (ZPOS64_T)CompressedSize,8);

  00226	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0022a	41 b9 08 00 00
	00		 mov	 r9d, 8
  00230	45 33 c0	 xor	 r8d, r8d
  00233	48 8b cb	 mov	 rcx, rbx
  00236	e8 00 00 00 00	 call	 zip64local_putValue
  0023b	eb 02		 jmp	 SHORT $LN28@Write_Loca
$LN26@Write_Loca:

; 1042 :   }
; 1043 : 
; 1044 :   return err;

  0023d	8b c7		 mov	 eax, edi
$LN28@Write_Loca:

; 1045 : }

  0023f	48 8b 5c 24 48	 mov	 rbx, QWORD PTR [rsp+72]
  00244	48 8b 6c 24 50	 mov	 rbp, QWORD PTR [rsp+80]
  00249	48 8b 74 24 58	 mov	 rsi, QWORD PTR [rsp+88]
  0024e	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00252	41 5d		 pop	 r13
  00254	41 5c		 pop	 r12
  00256	5f		 pop	 rdi
  00257	c3		 ret	 0
Write_LocalFileHeader ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64local_SearchCentralDir DD imagerel zip64local_SearchCentralDir
	DD	imagerel zip64local_SearchCentralDir+68
	DD	imagerel $unwind$zip64local_SearchCentralDir
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$zip64local_SearchCentralDir DD imagerel zip64local_SearchCentralDir+68
	DD	imagerel zip64local_SearchCentralDir+124
	DD	imagerel $chain$0$zip64local_SearchCentralDir
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$3$zip64local_SearchCentralDir DD imagerel zip64local_SearchCentralDir+124
	DD	imagerel zip64local_SearchCentralDir+143
	DD	imagerel $chain$3$zip64local_SearchCentralDir
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$5$zip64local_SearchCentralDir DD imagerel zip64local_SearchCentralDir+143
	DD	imagerel zip64local_SearchCentralDir+338
	DD	imagerel $chain$5$zip64local_SearchCentralDir
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$6$zip64local_SearchCentralDir DD imagerel zip64local_SearchCentralDir+338
	DD	imagerel zip64local_SearchCentralDir+372
	DD	imagerel $chain$6$zip64local_SearchCentralDir
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$6$zip64local_SearchCentralDir DD 021H
	DD	imagerel zip64local_SearchCentralDir+124
	DD	imagerel zip64local_SearchCentralDir+143
	DD	imagerel $chain$3$zip64local_SearchCentralDir
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$5$zip64local_SearchCentralDir DD 040a21H
	DD	0d740aH
	DD	0c6405H
	DD	imagerel zip64local_SearchCentralDir+124
	DD	imagerel zip64local_SearchCentralDir+143
	DD	imagerel $chain$3$zip64local_SearchCentralDir
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$3$zip64local_SearchCentralDir DD 040521H
	DD	0a5405H
	DD	04e400H
	DD	imagerel zip64local_SearchCentralDir
	DD	imagerel zip64local_SearchCentralDir+68
	DD	imagerel $unwind$zip64local_SearchCentralDir
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$zip64local_SearchCentralDir DD 020521H
	DD	04e405H
	DD	imagerel zip64local_SearchCentralDir
	DD	imagerel zip64local_SearchCentralDir+68
	DD	imagerel $unwind$zip64local_SearchCentralDir
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_SearchCentralDir DD 051001H
	DD	0f00c4210H
	DD	0c008d00aH
	DD	03006H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_SearchCentralDir
_TEXT	SEGMENT
pzlib_filefunc_def$ = 80
filestream$ = 88
zip64local_SearchCentralDir PROC			; COMDAT

; 481  : {

  00000	48 89 54 24 10	 mov	 QWORD PTR [rsp+16], rdx
  00005	53		 push	 rbx
  00006	41 54		 push	 r12
  00008	41 55		 push	 r13
  0000a	41 57		 push	 r15
  0000c	48 83 ec 28	 sub	 rsp, 40			; 00000028H

; 482  :   unsigned char* buf;
; 483  :   ZPOS64_T uSizeFile;
; 484  :   ZPOS64_T uBackRead;
; 485  :   ZPOS64_T uMaxBack=0xffff; /* maximum size of global comment */
; 486  :   ZPOS64_T uPosFound=0;

  00010	45 33 e4	 xor	 r12d, r12d

; 487  : 
; 488  :   if (ZSEEK64(*pzlib_filefunc_def,filestream,0,ZLIB_FILEFUNC_SEEK_END) != 0)

  00013	45 33 c0	 xor	 r8d, r8d
  00016	48 8b da	 mov	 rbx, rdx
  00019	45 8d 4c 24 02	 lea	 r9d, QWORD PTR [r12+2]
  0001e	4c 8b f9	 mov	 r15, rcx
  00021	41 bd ff ff 00
	00		 mov	 r13d, 65535		; 0000ffffH
  00027	e8 00 00 00 00	 call	 call_zseek64
  0002c	85 c0		 test	 eax, eax
  0002e	74 0e		 je	 SHORT $LN14@zip64local@5

; 489  :     return 0;

  00030	33 c0		 xor	 eax, eax

; 534  : }

  00032	48 83 c4 28	 add	 rsp, 40			; 00000028H
  00036	41 5f		 pop	 r15
  00038	41 5d		 pop	 r13
  0003a	41 5c		 pop	 r12
  0003c	5b		 pop	 rbx
  0003d	c3		 ret	 0
$LN14@zip64local@5:

; 490  : 
; 491  : 
; 492  :   uSizeFile = ZTELL64(*pzlib_filefunc_def,filestream);

  0003e	48 8b d3	 mov	 rdx, rbx
  00041	49 8b cf	 mov	 rcx, r15
  00044	4c 89 74 24 20	 mov	 QWORD PTR [rsp+32], r14
  00049	e8 00 00 00 00	 call	 call_ztell64

; 493  : 
; 494  :   if (uMaxBack>uSizeFile)
; 495  :     uMaxBack = uSizeFile;
; 496  : 
; 497  :   buf = (unsigned char*)ALLOC(BUFREADCOMMENT+4);

  0004e	b9 04 04 00 00	 mov	 ecx, 1028		; 00000404H
  00053	49 3b c5	 cmp	 rax, r13
  00056	4c 8b f0	 mov	 r14, rax
  00059	4c 0f 42 e8	 cmovb	 r13, rax
  0005d	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc
  00063	48 8b d8	 mov	 rbx, rax

; 498  :   if (buf==NULL)

  00066	48 85 c0	 test	 rax, rax
  00069	75 11		 jne	 SHORT $LN12@zip64local@5
  0006b	4c 8b 74 24 20	 mov	 r14, QWORD PTR [rsp+32]

; 534  : }

  00070	48 83 c4 28	 add	 rsp, 40			; 00000028H
  00074	41 5f		 pop	 r15
  00076	41 5d		 pop	 r13
  00078	41 5c		 pop	 r12
  0007a	5b		 pop	 rbx
  0007b	c3		 ret	 0
$LN12@zip64local@5:
  0007c	48 89 6c 24 50	 mov	 QWORD PTR [rsp+80], rbp

; 499  :     return 0;
; 500  : 
; 501  :   uBackRead = 4;

  00081	bd 04 00 00 00	 mov	 ebp, 4

; 502  :   while (uBackRead<uMaxBack)

  00086	49 3b ed	 cmp	 rbp, r13
  00089	0f 83 c3 00 00
	00		 jae	 $LN28@zip64local@5
  0008f	48 89 74 24 60	 mov	 QWORD PTR [rsp+96], rsi
  00094	48 89 7c 24 68	 mov	 QWORD PTR [rsp+104], rdi
  00099	0f 1f 80 00 00
	00 00		 npad	 7
$LL11@zip64local@5:

; 503  :   {
; 504  :     uLong uReadSize;
; 505  :     ZPOS64_T uReadPos ;
; 506  :     int i;
; 507  :     if (uBackRead+BUFREADCOMMENT>uMaxBack)

  000a0	48 8d 85 00 04
	00 00		 lea	 rax, QWORD PTR [rbp+1024]

; 508  :       uBackRead = uMaxBack;
; 509  :     else
; 510  :       uBackRead+=BUFREADCOMMENT;
; 511  :     uReadPos = uSizeFile-uBackRead ;

  000a7	49 8b f6	 mov	 rsi, r14
  000aa	49 3b c5	 cmp	 rax, r13
  000ad	48 8b e8	 mov	 rbp, rax

; 512  : 
; 513  :     uReadSize = ((BUFREADCOMMENT+4) < (uSizeFile-uReadPos)) ?
; 514  :       (BUFREADCOMMENT+4) : (uLong)(uSizeFile-uReadPos);

  000b0	49 8b c6	 mov	 rax, r14
  000b3	49 0f 47 ed	 cmova	 rbp, r13
  000b7	48 2b f5	 sub	 rsi, rbp
  000ba	48 2b c6	 sub	 rax, rsi
  000bd	48 3d 04 04 00
	00		 cmp	 rax, 1028		; 00000404H
  000c3	76 07		 jbe	 SHORT $LN17@zip64local@5
  000c5	bf 04 04 00 00	 mov	 edi, 1028		; 00000404H
  000ca	eb 05		 jmp	 SHORT $LN18@zip64local@5
$LN17@zip64local@5:
  000cc	41 8b fe	 mov	 edi, r14d
  000cf	2b fe		 sub	 edi, esi
$LN18@zip64local@5:

; 515  :     if (ZSEEK64(*pzlib_filefunc_def,filestream,uReadPos,ZLIB_FILEFUNC_SEEK_SET)!=0)

  000d1	48 8b 54 24 58	 mov	 rdx, QWORD PTR filestream$[rsp]
  000d6	45 33 c9	 xor	 r9d, r9d
  000d9	4c 8b c6	 mov	 r8, rsi
  000dc	49 8b cf	 mov	 rcx, r15
  000df	e8 00 00 00 00	 call	 call_zseek64
  000e4	85 c0		 test	 eax, eax
  000e6	75 60		 jne	 SHORT $LN31@zip64local@5

; 516  :       break;
; 517  : 
; 518  :     if (ZREAD64(*pzlib_filefunc_def,filestream,buf,uReadSize)!=uReadSize)

  000e8	48 8b 54 24 58	 mov	 rdx, QWORD PTR filestream$[rsp]
  000ed	49 8b 4f 38	 mov	 rcx, QWORD PTR [r15+56]
  000f1	44 8b cf	 mov	 r9d, edi
  000f4	4c 8b c3	 mov	 r8, rbx
  000f7	41 ff 57 08	 call	 QWORD PTR [r15+8]
  000fb	3b c7		 cmp	 eax, edi
  000fd	75 49		 jne	 SHORT $LN31@zip64local@5

; 519  :       break;
; 520  : 
; 521  :     for (i=(int)uReadSize-3; (i--)>0;)

  000ff	8d 4f fd	 lea	 ecx, DWORD PTR [rdi-3]
  00102	48 63 c1	 movsxd	 rax, ecx
  00105	85 c9		 test	 ecx, ecx
  00107	7e 36		 jle	 SHORT $LN27@zip64local@5
  00109	0f 1f 80 00 00
	00 00		 npad	 7
$LL5@zip64local@5:
  00110	48 ff c8	 dec	 rax
  00113	ff c9		 dec	 ecx

; 522  :       if (((*(buf+i))==0x50) && ((*(buf+i+1))==0x4b) &&
; 523  :         ((*(buf+i+2))==0x05) && ((*(buf+i+3))==0x06))

  00115	80 3c 18 50	 cmp	 BYTE PTR [rax+rbx], 80	; 00000050H
  00119	75 15		 jne	 SHORT $LN3@zip64local@5
  0011b	80 7c 18 01 4b	 cmp	 BYTE PTR [rax+rbx+1], 75 ; 0000004bH
  00120	75 0e		 jne	 SHORT $LN3@zip64local@5
  00122	80 7c 18 02 05	 cmp	 BYTE PTR [rax+rbx+2], 5
  00127	75 07		 jne	 SHORT $LN3@zip64local@5
  00129	80 7c 18 03 06	 cmp	 BYTE PTR [rax+rbx+3], 6
  0012e	74 07		 je	 SHORT $LN21@zip64local@5
$LN3@zip64local@5:

; 519  :       break;
; 520  : 
; 521  :     for (i=(int)uReadSize-3; (i--)>0;)

  00130	48 85 c0	 test	 rax, rax
  00133	7f db		 jg	 SHORT $LL5@zip64local@5
  00135	eb 08		 jmp	 SHORT $LN27@zip64local@5
$LN21@zip64local@5:

; 524  :       {
; 525  :         uPosFound = uReadPos+i;

  00137	4c 63 e1	 movsxd	 r12, ecx
  0013a	4c 03 e6	 add	 r12, rsi

; 526  :         break;
; 527  :       }
; 528  : 
; 529  :       if (uPosFound!=0)

  0013d	75 09		 jne	 SHORT $LN31@zip64local@5
$LN27@zip64local@5:

; 502  :   while (uBackRead<uMaxBack)

  0013f	49 3b ed	 cmp	 rbp, r13
  00142	0f 82 58 ff ff
	ff		 jb	 $LL11@zip64local@5
$LN31@zip64local@5:
  00148	48 8b 7c 24 68	 mov	 rdi, QWORD PTR [rsp+104]
  0014d	48 8b 74 24 60	 mov	 rsi, QWORD PTR [rsp+96]
$LN28@zip64local@5:

; 530  :         break;
; 531  :   }
; 532  :   TRYFREE(buf);

  00152	48 8b cb	 mov	 rcx, rbx
  00155	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free
  0015b	48 8b 6c 24 50	 mov	 rbp, QWORD PTR [rsp+80]
  00160	4c 8b 74 24 20	 mov	 r14, QWORD PTR [rsp+32]

; 533  :   return uPosFound;

  00165	49 8b c4	 mov	 rax, r12

; 534  : }

  00168	48 83 c4 28	 add	 rsp, 40			; 00000028H
  0016c	41 5f		 pop	 r15
  0016e	41 5d		 pop	 r13
  00170	41 5c		 pop	 r12
  00172	5b		 pop	 rbx
  00173	c3		 ret	 0
zip64local_SearchCentralDir ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64local_getLong64 DD imagerel zip64local_getLong64
	DD	imagerel zip64local_getLong64+369
	DD	imagerel $unwind$zip64local_getLong64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_getLong64 DD 081401H
	DD	086414H
	DD	075414H
	DD	063414H
	DD	070103214H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_getLong64
_TEXT	SEGMENT
pzlib_filefunc_def$ = 48
filestream$ = 56
pX$ = 64
i$ = 72
zip64local_getLong64 PROC				; COMDAT

; 427  : {

  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 6c 24 10	 mov	 QWORD PTR [rsp+16], rbp
  0000a	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000f	57		 push	 rdi
  00010	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  00014	49 8b e8	 mov	 rbp, r8

; 428  :   ZPOS64_T x;
; 429  :   int i = 0;
; 430  :   int err;
; 431  : 
; 432  :   err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00017	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0001c	48 8b fa	 mov	 rdi, rdx
  0001f	48 8b f1	 mov	 rsi, rcx
  00022	c7 44 24 48 00
	00 00 00	 mov	 DWORD PTR i$[rsp], 0
  0002a	e8 00 00 00 00	 call	 zip64local_getByte

; 433  :   x = (ZPOS64_T)i;

  0002f	4c 63 4c 24 48	 movsxd	 r9, DWORD PTR i$[rsp]
  00034	44 8b d8	 mov	 r11d, eax
  00037	49 8b d9	 mov	 rbx, r9

; 434  : 
; 435  :   if (err==ZIP_OK)

  0003a	85 c0		 test	 eax, eax
  0003c	75 18		 jne	 SHORT $LN9@zip64local@6

; 436  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  0003e	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  00043	48 8b d7	 mov	 rdx, rdi
  00046	48 8b ce	 mov	 rcx, rsi
  00049	e8 00 00 00 00	 call	 zip64local_getByte
  0004e	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  00053	44 8b d8	 mov	 r11d, eax
$LN9@zip64local@6:

; 437  :   x += ((ZPOS64_T)i)<<8;

  00056	49 63 c1	 movsxd	 rax, r9d
  00059	48 c1 e0 08	 shl	 rax, 8
  0005d	48 03 d8	 add	 rbx, rax

; 438  : 
; 439  :   if (err==ZIP_OK)

  00060	45 85 db	 test	 r11d, r11d
  00063	75 18		 jne	 SHORT $LN8@zip64local@6

; 440  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00065	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0006a	48 8b d7	 mov	 rdx, rdi
  0006d	48 8b ce	 mov	 rcx, rsi
  00070	e8 00 00 00 00	 call	 zip64local_getByte
  00075	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  0007a	44 8b d8	 mov	 r11d, eax
$LN8@zip64local@6:

; 441  :   x += ((ZPOS64_T)i)<<16;

  0007d	49 63 c1	 movsxd	 rax, r9d
  00080	48 c1 e0 10	 shl	 rax, 16
  00084	48 03 d8	 add	 rbx, rax

; 442  : 
; 443  :   if (err==ZIP_OK)

  00087	45 85 db	 test	 r11d, r11d
  0008a	75 18		 jne	 SHORT $LN7@zip64local@6

; 444  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  0008c	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  00091	48 8b d7	 mov	 rdx, rdi
  00094	48 8b ce	 mov	 rcx, rsi
  00097	e8 00 00 00 00	 call	 zip64local_getByte
  0009c	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  000a1	44 8b d8	 mov	 r11d, eax
$LN7@zip64local@6:

; 445  :   x += ((ZPOS64_T)i)<<24;

  000a4	49 63 c1	 movsxd	 rax, r9d
  000a7	48 c1 e0 18	 shl	 rax, 24
  000ab	48 03 d8	 add	 rbx, rax

; 446  : 
; 447  :   if (err==ZIP_OK)

  000ae	45 85 db	 test	 r11d, r11d
  000b1	75 18		 jne	 SHORT $LN6@zip64local@6

; 448  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  000b3	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  000b8	48 8b d7	 mov	 rdx, rdi
  000bb	48 8b ce	 mov	 rcx, rsi
  000be	e8 00 00 00 00	 call	 zip64local_getByte
  000c3	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  000c8	44 8b d8	 mov	 r11d, eax
$LN6@zip64local@6:

; 449  :   x += ((ZPOS64_T)i)<<32;

  000cb	49 63 c1	 movsxd	 rax, r9d
  000ce	48 c1 e0 20	 shl	 rax, 32			; 00000020H
  000d2	48 03 d8	 add	 rbx, rax

; 450  : 
; 451  :   if (err==ZIP_OK)

  000d5	45 85 db	 test	 r11d, r11d
  000d8	75 18		 jne	 SHORT $LN5@zip64local@6

; 452  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  000da	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  000df	48 8b d7	 mov	 rdx, rdi
  000e2	48 8b ce	 mov	 rcx, rsi
  000e5	e8 00 00 00 00	 call	 zip64local_getByte
  000ea	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  000ef	44 8b d8	 mov	 r11d, eax
$LN5@zip64local@6:

; 453  :   x += ((ZPOS64_T)i)<<40;

  000f2	49 63 c1	 movsxd	 rax, r9d
  000f5	48 c1 e0 28	 shl	 rax, 40			; 00000028H
  000f9	48 03 d8	 add	 rbx, rax

; 454  : 
; 455  :   if (err==ZIP_OK)

  000fc	45 85 db	 test	 r11d, r11d
  000ff	75 18		 jne	 SHORT $LN4@zip64local@6

; 456  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00101	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  00106	48 8b d7	 mov	 rdx, rdi
  00109	48 8b ce	 mov	 rcx, rsi
  0010c	e8 00 00 00 00	 call	 zip64local_getByte
  00111	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  00116	44 8b d8	 mov	 r11d, eax
$LN4@zip64local@6:

; 457  :   x += ((ZPOS64_T)i)<<48;

  00119	49 63 c1	 movsxd	 rax, r9d
  0011c	48 c1 e0 30	 shl	 rax, 48			; 00000030H
  00120	48 03 d8	 add	 rbx, rax

; 458  : 
; 459  :   if (err==ZIP_OK)

  00123	45 85 db	 test	 r11d, r11d
  00126	75 29		 jne	 SHORT $LN2@zip64local@6

; 460  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00128	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0012d	48 8b d7	 mov	 rdx, rdi
  00130	48 8b ce	 mov	 rcx, rsi
  00133	e8 00 00 00 00	 call	 zip64local_getByte
  00138	44 8b d8	 mov	 r11d, eax

; 461  :   x += ((ZPOS64_T)i)<<56;
; 462  : 
; 463  :   if (err==ZIP_OK)

  0013b	85 c0		 test	 eax, eax
  0013d	75 12		 jne	 SHORT $LN2@zip64local@6

; 464  :     *pX = x;

  0013f	48 63 44 24 48	 movsxd	 rax, DWORD PTR i$[rsp]
  00144	48 c1 e0 38	 shl	 rax, 56			; 00000038H
  00148	48 03 c3	 add	 rax, rbx
  0014b	48 89 45 00	 mov	 QWORD PTR [rbp], rax

; 465  :   else

  0014f	eb 08		 jmp	 SHORT $LN12@zip64local@6
$LN2@zip64local@6:

; 466  :     *pX = 0;

  00151	48 c7 45 00 00
	00 00 00	 mov	 QWORD PTR [rbp], 0
$LN12@zip64local@6:

; 467  : 
; 468  :   return err;
; 469  : }

  00159	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  0015e	48 8b 6c 24 38	 mov	 rbp, QWORD PTR [rsp+56]
  00163	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  00168	41 8b c3	 mov	 eax, r11d
  0016b	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0016f	5f		 pop	 rdi
  00170	c3		 ret	 0
zip64local_getLong64 ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64local_getLong DD imagerel zip64local_getLong
	DD	imagerel zip64local_getLong+201
	DD	imagerel $unwind$zip64local_getLong
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_getLong DD 081401H
	DD	086414H
	DD	075414H
	DD	063414H
	DD	070103214H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_getLong
_TEXT	SEGMENT
pzlib_filefunc_def$ = 48
filestream$ = 56
pX$ = 64
i$ = 72
zip64local_getLong PROC					; COMDAT

; 396  : {

  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 6c 24 10	 mov	 QWORD PTR [rsp+16], rbp
  0000a	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000f	57		 push	 rdi
  00010	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  00014	49 8b f8	 mov	 rdi, r8

; 397  :     uLong x ;
; 398  :     int i = 0;
; 399  :     int err;
; 400  : 
; 401  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00017	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0001c	48 8b f2	 mov	 rsi, rdx
  0001f	48 8b e9	 mov	 rbp, rcx
  00022	c7 44 24 48 00
	00 00 00	 mov	 DWORD PTR i$[rsp], 0
  0002a	e8 00 00 00 00	 call	 zip64local_getByte

; 402  :     x = (uLong)i;

  0002f	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  00034	44 8b d8	 mov	 r11d, eax
  00037	41 8b d9	 mov	 ebx, r9d

; 403  : 
; 404  :     if (err==ZIP_OK)

  0003a	85 c0		 test	 eax, eax
  0003c	75 18		 jne	 SHORT $LN5@zip64local@7

; 405  :         err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  0003e	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  00043	48 8b d6	 mov	 rdx, rsi
  00046	48 8b cd	 mov	 rcx, rbp
  00049	e8 00 00 00 00	 call	 zip64local_getByte
  0004e	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  00053	44 8b d8	 mov	 r11d, eax
$LN5@zip64local@7:

; 406  :     x += ((uLong)i)<<8;

  00056	41 8b c1	 mov	 eax, r9d
  00059	c1 e0 08	 shl	 eax, 8
  0005c	03 d8		 add	 ebx, eax

; 407  : 
; 408  :     if (err==ZIP_OK)

  0005e	45 85 db	 test	 r11d, r11d
  00061	75 18		 jne	 SHORT $LN4@zip64local@7

; 409  :         err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00063	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  00068	48 8b d6	 mov	 rdx, rsi
  0006b	48 8b cd	 mov	 rcx, rbp
  0006e	e8 00 00 00 00	 call	 zip64local_getByte
  00073	44 8b 4c 24 48	 mov	 r9d, DWORD PTR i$[rsp]
  00078	44 8b d8	 mov	 r11d, eax
$LN4@zip64local@7:

; 410  :     x += ((uLong)i)<<16;

  0007b	41 c1 e1 10	 shl	 r9d, 16
  0007f	41 03 d9	 add	 ebx, r9d

; 411  : 
; 412  :     if (err==ZIP_OK)

  00082	45 85 db	 test	 r11d, r11d
  00085	75 24		 jne	 SHORT $LN2@zip64local@7

; 413  :         err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00087	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0008c	48 8b d6	 mov	 rdx, rsi
  0008f	48 8b cd	 mov	 rcx, rbp
  00092	e8 00 00 00 00	 call	 zip64local_getByte
  00097	44 8b d8	 mov	 r11d, eax

; 415  : 
; 416  :     if (err==ZIP_OK)

  0009a	85 c0		 test	 eax, eax
  0009c	75 0d		 jne	 SHORT $LN2@zip64local@7

; 414  :     x += ((uLong)i)<<24;

  0009e	8b 44 24 48	 mov	 eax, DWORD PTR i$[rsp]
  000a2	c1 e0 18	 shl	 eax, 24
  000a5	03 c3		 add	 eax, ebx

; 417  :         *pX = x;

  000a7	89 07		 mov	 DWORD PTR [rdi], eax

; 418  :     else

  000a9	eb 06		 jmp	 SHORT $LN8@zip64local@7
$LN2@zip64local@7:

; 419  :         *pX = 0;

  000ab	c7 07 00 00 00
	00		 mov	 DWORD PTR [rdi], 0
$LN8@zip64local@7:

; 420  :     return err;
; 421  : }

  000b1	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  000b6	48 8b 6c 24 38	 mov	 rbp, QWORD PTR [rsp+56]
  000bb	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  000c0	41 8b c3	 mov	 eax, r11d
  000c3	48 83 c4 20	 add	 rsp, 32			; 00000020H
  000c7	5f		 pop	 rdi
  000c8	c3		 ret	 0
zip64local_getLong ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$zip64local_getShort DD imagerel zip64local_getShort
	DD	imagerel zip64local_getShort+124
	DD	imagerel $unwind$zip64local_getShort
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_getShort DD 081401H
	DD	086414H
	DD	075414H
	DD	063414H
	DD	070103214H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_getShort
_TEXT	SEGMENT
pzlib_filefunc_def$ = 48
filestream$ = 56
pX$ = 64
i$ = 72
zip64local_getShort PROC				; COMDAT

; 374  : {

  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 6c 24 10	 mov	 QWORD PTR [rsp+16], rbp
  0000a	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000f	57		 push	 rdi
  00010	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  00014	49 8b d8	 mov	 rbx, r8

; 375  :     uLong x ;
; 376  :     int i = 0;
; 377  :     int err;
; 378  : 
; 379  :     err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  00017	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0001c	48 8b f2	 mov	 rsi, rdx
  0001f	48 8b e9	 mov	 rbp, rcx
  00022	c7 44 24 48 00
	00 00 00	 mov	 DWORD PTR i$[rsp], 0
  0002a	e8 00 00 00 00	 call	 zip64local_getByte

; 380  :     x = (uLong)i;

  0002f	8b 7c 24 48	 mov	 edi, DWORD PTR i$[rsp]
  00033	44 8b d8	 mov	 r11d, eax

; 381  : 
; 382  :     if (err==ZIP_OK)

  00036	85 c0		 test	 eax, eax
  00038	75 24		 jne	 SHORT $LN2@zip64local@8

; 383  :         err = zip64local_getByte(pzlib_filefunc_def,filestream,&i);

  0003a	4c 8d 44 24 48	 lea	 r8, QWORD PTR i$[rsp]
  0003f	48 8b d6	 mov	 rdx, rsi
  00042	48 8b cd	 mov	 rcx, rbp
  00045	e8 00 00 00 00	 call	 zip64local_getByte
  0004a	44 8b d8	 mov	 r11d, eax

; 385  : 
; 386  :     if (err==ZIP_OK)

  0004d	85 c0		 test	 eax, eax
  0004f	75 0d		 jne	 SHORT $LN2@zip64local@8

; 384  :     x += ((uLong)i)<<8;

  00051	8b 44 24 48	 mov	 eax, DWORD PTR i$[rsp]
  00055	c1 e0 08	 shl	 eax, 8
  00058	03 c7		 add	 eax, edi

; 387  :         *pX = x;

  0005a	89 03		 mov	 DWORD PTR [rbx], eax

; 388  :     else

  0005c	eb 06		 jmp	 SHORT $LN6@zip64local@8
$LN2@zip64local@8:

; 389  :         *pX = 0;

  0005e	c7 03 00 00 00
	00		 mov	 DWORD PTR [rbx], 0
$LN6@zip64local@8:

; 390  :     return err;
; 391  : }

  00064	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  00069	48 8b 6c 24 38	 mov	 rbp, QWORD PTR [rsp+56]
  0006e	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  00073	41 8b c3	 mov	 eax, r11d
  00076	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0007a	5f		 pop	 rdi
  0007b	c3		 ret	 0
zip64local_getShort ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$add_data_in_datablock DD imagerel add_data_in_datablock
	DD	imagerel add_data_in_datablock+74
	DD	imagerel $unwind$add_data_in_datablock
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$add_data_in_datablock DD imagerel add_data_in_datablock+74
	DD	imagerel add_data_in_datablock+198
	DD	imagerel $chain$0$add_data_in_datablock
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$2$add_data_in_datablock DD imagerel add_data_in_datablock+198
	DD	imagerel add_data_in_datablock+205
	DD	imagerel $chain$2$add_data_in_datablock
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$2$add_data_in_datablock DD 020021H
	DD	063400H
	DD	imagerel add_data_in_datablock
	DD	imagerel add_data_in_datablock+74
	DD	imagerel $unwind$add_data_in_datablock
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$add_data_in_datablock DD 020521H
	DD	063405H
	DD	imagerel add_data_in_datablock
	DD	imagerel add_data_in_datablock+74
	DD	imagerel $unwind$add_data_in_datablock
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$add_data_in_datablock DD 060f01H
	DD	08640fH
	DD	07540fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT add_data_in_datablock
_TEXT	SEGMENT
ll$ = 48
buf$ = 56
len$ = 64
add_data_in_datablock PROC				; COMDAT

; 226  : {

  00000	48 89 6c 24 10	 mov	 QWORD PTR [rsp+16], rbp
  00005	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000a	57		 push	 rdi
  0000b	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  0000f	41 8b f0	 mov	 esi, r8d
  00012	48 8b ea	 mov	 rbp, rdx
  00015	48 8b f9	 mov	 rdi, rcx

; 227  :     linkedlist_datablock_internal* ldi;
; 228  :     const unsigned char* from_copy;
; 229  : 
; 230  :     if (ll==NULL)

  00018	48 85 c9	 test	 rcx, rcx
  0001b	75 15		 jne	 SHORT $LN12@add_data_i
$LN22@add_data_i:

; 231  :         return ZIP_INTERNALERROR;

  0001d	b8 98 ff ff ff	 mov	 eax, -104		; ffffffffffffff98H

; 274  : }

  00022	48 8b 6c 24 38	 mov	 rbp, QWORD PTR [rsp+56]
  00027	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  0002c	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00030	5f		 pop	 rdi
  00031	c3		 ret	 0
$LN12@add_data_i:

; 232  : 
; 233  :     if (ll->last_block == NULL)

  00032	48 83 79 08 00	 cmp	 QWORD PTR [rcx+8], 0
  00037	75 11		 jne	 SHORT $LN10@add_data_i

; 234  :     {
; 235  :         ll->first_block = ll->last_block = allocate_new_datablock();

  00039	e8 00 00 00 00	 call	 allocate_new_datablock
  0003e	48 89 47 08	 mov	 QWORD PTR [rdi+8], rax
  00042	48 89 07	 mov	 QWORD PTR [rdi], rax

; 236  :         if (ll->first_block == NULL)

  00045	48 85 c0	 test	 rax, rax

; 237  :             return ZIP_INTERNALERROR;

  00048	74 d3		 je	 SHORT $LN22@add_data_i
$LN10@add_data_i:
  0004a	48 89 5c 24 30	 mov	 QWORD PTR [rsp+48], rbx

; 238  :     }
; 239  : 
; 240  :     ldi = ll->last_block;

  0004f	48 8b 5f 08	 mov	 rbx, QWORD PTR [rdi+8]

; 241  :     from_copy = (unsigned char*)buf;
; 242  : 
; 243  :     while (len>0)

  00053	85 f6		 test	 esi, esi
  00055	74 58		 je	 SHORT $LN20@add_data_i
$LL9@add_data_i:

; 244  :     {
; 245  :         uInt copy_this;
; 246  :         uInt i;
; 247  :         unsigned char* to_copy;
; 248  : 
; 249  :         if (ldi->avail_in_this_block==0)

  00057	83 7b 08 00	 cmp	 DWORD PTR [rbx+8], 0
  0005b	75 14		 jne	 SHORT $LN7@add_data_i

; 250  :         {
; 251  :             ldi->next_datablock = allocate_new_datablock();

  0005d	e8 00 00 00 00	 call	 allocate_new_datablock
  00062	48 89 03	 mov	 QWORD PTR [rbx], rax

; 252  :             if (ldi->next_datablock == NULL)

  00065	48 85 c0	 test	 rax, rax
  00068	74 5c		 je	 SHORT $LN17@add_data_i

; 254  :             ldi = ldi->next_datablock ;

  0006a	48 8b d8	 mov	 rbx, rax

; 255  :             ll->last_block = ldi;

  0006d	48 89 47 08	 mov	 QWORD PTR [rdi+8], rax
$LN7@add_data_i:

; 256  :         }
; 257  : 
; 258  :         if (ldi->avail_in_this_block < len)

  00071	8b 43 08	 mov	 eax, DWORD PTR [rbx+8]
  00074	8b d6		 mov	 edx, esi
  00076	3b c6		 cmp	 eax, esi
  00078	0f 42 d0	 cmovb	 edx, eax

; 259  :             copy_this = (uInt)ldi->avail_in_this_block;
; 260  :         else
; 261  :             copy_this = (uInt)len;
; 262  : 
; 263  :         to_copy = &(ldi->data[ldi->filled_in_this_block]);

  0007b	8b 43 0c	 mov	 eax, DWORD PTR [rbx+12]
  0007e	48 8d 4c 18 14	 lea	 rcx, QWORD PTR [rax+rbx+20]

; 264  : 
; 265  :         for (i=0;i<copy_this;i++)

  00083	85 d2		 test	 edx, edx
  00085	74 19		 je	 SHORT $LN1@add_data_i
  00087	4c 8b cd	 mov	 r9, rbp
  0008a	44 8b c2	 mov	 r8d, edx
  0008d	4c 2b c9	 sub	 r9, rcx
$LL3@add_data_i:

; 266  :             *(to_copy+i)=*(from_copy+i);

  00090	41 0f b6 04 09	 movzx	 eax, BYTE PTR [r9+rcx]
  00095	48 ff c1	 inc	 rcx
  00098	49 ff c8	 dec	 r8
  0009b	88 41 ff	 mov	 BYTE PTR [rcx-1], al
  0009e	75 f0		 jne	 SHORT $LL3@add_data_i
$LN1@add_data_i:

; 267  : 
; 268  :         ldi->filled_in_this_block += copy_this;

  000a0	01 53 0c	 add	 DWORD PTR [rbx+12], edx

; 269  :         ldi->avail_in_this_block -= copy_this;

  000a3	29 53 08	 sub	 DWORD PTR [rbx+8], edx

; 270  :         from_copy += copy_this ;

  000a6	8b c2		 mov	 eax, edx
  000a8	48 03 e8	 add	 rbp, rax

; 271  :         len -= copy_this;

  000ab	2b f2		 sub	 esi, edx
  000ad	75 a8		 jne	 SHORT $LL9@add_data_i
$LN20@add_data_i:

; 272  :     }
; 273  :     return ZIP_OK;

  000af	33 c0		 xor	 eax, eax
$LN21@add_data_i:
  000b1	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]

; 274  : }

  000b6	48 8b 6c 24 38	 mov	 rbp, QWORD PTR [rsp+56]
  000bb	48 8b 74 24 40	 mov	 rsi, QWORD PTR [rsp+64]
  000c0	48 83 c4 20	 add	 rsp, 32			; 00000020H
  000c4	5f		 pop	 rdi
  000c5	c3		 ret	 0
$LN17@add_data_i:

; 253  :                 return ZIP_INTERNALERROR;

  000c6	b8 98 ff ff ff	 mov	 eax, -104		; ffffffffffffff98H
  000cb	eb e4		 jmp	 SHORT $LN21@add_data_i
add_data_in_datablock ENDP
_TEXT	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$free_linkedlist DD imagerel free_linkedlist
	DD	imagerel free_linkedlist+33
	DD	imagerel $unwind$free_linkedlist
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$free_linkedlist DD 020601H
	DD	030023206H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT free_linkedlist
_TEXT	SEGMENT
ll$ = 48
free_linkedlist PROC					; COMDAT

; 219  : {

  00000	40 53		 push	 rbx
  00002	48 83 ec 20	 sub	 rsp, 32			; 00000020H
  00006	48 8b d9	 mov	 rbx, rcx

; 220  :     free_datablock(ll->first_block);

  00009	48 8b 09	 mov	 rcx, QWORD PTR [rcx]
  0000c	e8 00 00 00 00	 call	 free_datablock

; 221  :     ll->first_block = ll->last_block = NULL;

  00011	45 33 db	 xor	 r11d, r11d
  00014	4c 89 5b 08	 mov	 QWORD PTR [rbx+8], r11
  00018	4c 89 1b	 mov	 QWORD PTR [rbx], r11

; 222  : }

  0001b	48 83 c4 20	 add	 rsp, 32			; 00000020H
  0001f	5b		 pop	 rbx
  00020	c3		 ret	 0
free_linkedlist ENDP
_TEXT	ENDS
;	COMDAT pdata
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\crypt.h
pdata	SEGMENT
$pdata$init_keys DD imagerel init_keys
	DD	imagerel init_keys+106
	DD	imagerel $unwind$init_keys
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$init_keys DD 060f01H
	DD	07640fH
	DD	06340fH
	DD	0700b320fH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT init_keys
_TEXT	SEGMENT
passwd$ = 48
pkeys$ = 56
pcrc_32_tab$ = 64
init_keys PROC						; COMDAT

; 66   : {

  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 74 24 10	 mov	 QWORD PTR [rsp+16], rsi
  0000a	57		 push	 rdi
  0000b	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 67   :     *(pkeys+0) = 305419896L;

  0000f	c7 02 78 56 34
	12		 mov	 DWORD PTR [rdx], 305419896 ; 12345678H

; 68   :     *(pkeys+1) = 591751049L;

  00015	c7 42 04 89 67
	45 23		 mov	 DWORD PTR [rdx+4], 591751049 ; 23456789H

; 69   :     *(pkeys+2) = 878082192L;

  0001c	c7 42 08 90 78
	56 34		 mov	 DWORD PTR [rdx+8], 878082192 ; 34567890H

; 70   :     while (*passwd != '\0') {

  00023	0f b6 01	 movzx	 eax, BYTE PTR [rcx]
  00026	49 8b f0	 mov	 rsi, r8
  00029	48 8b fa	 mov	 rdi, rdx
  0002c	48 8b d9	 mov	 rbx, rcx
  0002f	84 c0		 test	 al, al
  00031	74 27		 je	 SHORT $LN1@init_keys
  00033	66 66 66 66 66
	0f 1f 84 00 00
	00 00 00	 npad	 13
$LL2@init_keys:

; 71   :         update_keys(pkeys,pcrc_32_tab,(int)*passwd);

  00040	44 0f be c0	 movsx	 r8d, al
  00044	48 8b d6	 mov	 rdx, rsi
  00047	48 8b cf	 mov	 rcx, rdi
  0004a	e8 00 00 00 00	 call	 update_keys
  0004f	0f b6 43 01	 movzx	 eax, BYTE PTR [rbx+1]

; 72   :         passwd++;

  00053	48 ff c3	 inc	 rbx
  00056	84 c0		 test	 al, al
  00058	75 e6		 jne	 SHORT $LL2@init_keys
$LN1@init_keys:

; 73   :     }
; 74   : }

  0005a	48 8b 5c 24 30	 mov	 rbx, QWORD PTR [rsp+48]
  0005f	48 8b 74 24 38	 mov	 rsi, QWORD PTR [rsp+56]
  00064	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00068	5f		 pop	 rdi
  00069	c3		 ret	 0
init_keys ENDP
;	COMDAT pdata
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\zip.c
pdata	SEGMENT
$pdata$zip64local_SearchCentralDir64 DD imagerel zip64local_SearchCentralDir64
	DD	imagerel zip64local_SearchCentralDir64+120
	DD	imagerel $unwind$zip64local_SearchCentralDir64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$2$zip64local_SearchCentralDir64 DD imagerel zip64local_SearchCentralDir64+120
	DD	imagerel zip64local_SearchCentralDir64+328
	DD	imagerel $chain$2$zip64local_SearchCentralDir64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$3$zip64local_SearchCentralDir64 DD imagerel zip64local_SearchCentralDir64+328
	DD	imagerel zip64local_SearchCentralDir64+534
	DD	imagerel $chain$3$zip64local_SearchCentralDir64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$3$zip64local_SearchCentralDir64 DD 021H
	DD	imagerel zip64local_SearchCentralDir64
	DD	imagerel zip64local_SearchCentralDir64+120
	DD	imagerel $unwind$zip64local_SearchCentralDir64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$2$zip64local_SearchCentralDir64 DD 020521H
	DD	04c405H
	DD	imagerel zip64local_SearchCentralDir64
	DD	imagerel zip64local_SearchCentralDir64+120
	DD	imagerel $unwind$zip64local_SearchCentralDir64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zip64local_SearchCentralDir64 DD 0a4d01H
	DD	05744dH
	DD	0c3448H
	DD	0f009520dH
	DD	0d005e007H
	DD	050026003H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zip64local_SearchCentralDir64
_TEXT	SEGMENT
pzlib_filefunc_def$ = 96
filestream$ = 104
uSizeFile$1$ = 112
uL$ = 112
relativeOffset$ = 120
zip64local_SearchCentralDir64 PROC			; COMDAT

; 543  : {

  00000	40 55		 push	 rbp
  00002	56		 push	 rsi
  00003	41 55		 push	 r13
  00005	41 56		 push	 r14
  00007	41 57		 push	 r15
  00009	48 83 ec 30	 sub	 rsp, 48			; 00000030H

; 544  :   unsigned char* buf;
; 545  :   ZPOS64_T uSizeFile;
; 546  :   ZPOS64_T uBackRead;
; 547  :   ZPOS64_T uMaxBack=0xffff; /* maximum size of global comment */
; 548  :   ZPOS64_T uPosFound=0;

  0000d	33 f6		 xor	 esi, esi

; 549  :   uLong uL;
; 550  :   ZPOS64_T relativeOffset;
; 551  : 
; 552  :   if (ZSEEK64(*pzlib_filefunc_def,filestream,0,ZLIB_FILEFUNC_SEEK_END) != 0)

  0000f	45 33 c0	 xor	 r8d, r8d
  00012	4c 8b f2	 mov	 r14, rdx
  00015	44 8d 4e 02	 lea	 r9d, QWORD PTR [rsi+2]
  00019	48 8b e9	 mov	 rbp, rcx
  0001c	41 bf ff ff 00
	00		 mov	 r15d, 65535		; 0000ffffH
  00022	44 8b ee	 mov	 r13d, esi
  00025	e8 00 00 00 00	 call	 call_zseek64
  0002a	85 c0		 test	 eax, eax
  0002c	74 0f		 je	 SHORT $LN25@zip64local@9

; 553  :     return 0;

  0002e	33 c0		 xor	 eax, eax

; 635  :     return 0;
; 636  : 
; 637  :   return relativeOffset;
; 638  : }

  00030	48 83 c4 30	 add	 rsp, 48			; 00000030H
  00034	41 5f		 pop	 r15
  00036	41 5e		 pop	 r14
  00038	41 5d		 pop	 r13
  0003a	5e		 pop	 rsi
  0003b	5d		 pop	 rbp
  0003c	c3		 ret	 0
$LN25@zip64local@9:

; 554  : 
; 555  :   uSizeFile = ZTELL64(*pzlib_filefunc_def,filestream);

  0003d	49 8b d6	 mov	 rdx, r14
  00040	48 8b cd	 mov	 rcx, rbp
  00043	48 89 5c 24 60	 mov	 QWORD PTR [rsp+96], rbx
  00048	48 89 7c 24 28	 mov	 QWORD PTR [rsp+40], rdi
  0004d	e8 00 00 00 00	 call	 call_ztell64

; 556  : 
; 557  :   if (uMaxBack>uSizeFile)
; 558  :     uMaxBack = uSizeFile;
; 559  : 
; 560  :   buf = (unsigned char*)ALLOC(BUFREADCOMMENT+4);

  00052	b9 04 04 00 00	 mov	 ecx, 1028		; 00000404H
  00057	49 3b c7	 cmp	 rax, r15
  0005a	48 8b f8	 mov	 rdi, rax
  0005d	48 89 44 24 70	 mov	 QWORD PTR uSizeFile$1$[rsp], rax
  00062	4c 0f 42 f8	 cmovb	 r15, rax
  00066	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc
  0006c	48 8b d8	 mov	 rbx, rax

; 561  :   if (buf==NULL)

  0006f	48 85 c0	 test	 rax, rax

; 562  :     return 0;

  00072	0f 84 74 01 00
	00		 je	 $LN42@zip64local@9

; 563  : 
; 564  :   uBackRead = 4;

  00078	4c 89 64 24 20	 mov	 QWORD PTR [rsp+32], r12
  0007d	41 bc 04 00 00
	00		 mov	 r12d, 4

; 565  :   while (uBackRead<uMaxBack)

  00083	4d 3b e7	 cmp	 r12, r15
  00086	0f 83 a5 00 00
	00		 jae	 $LN33@zip64local@9
  0008c	0f 1f 40 00	 npad	 4
$LL22@zip64local@9:

; 566  :   {
; 567  :     uLong uReadSize;
; 568  :     ZPOS64_T uReadPos;
; 569  :     int i;
; 570  :     if (uBackRead+BUFREADCOMMENT>uMaxBack)

  00090	49 8d 84 24 00
	04 00 00	 lea	 rax, QWORD PTR [r12+1024]

; 571  :       uBackRead = uMaxBack;
; 572  :     else
; 573  :       uBackRead+=BUFREADCOMMENT;
; 574  :     uReadPos = uSizeFile-uBackRead ;

  00098	48 8b f7	 mov	 rsi, rdi
  0009b	49 3b c7	 cmp	 rax, r15
  0009e	4c 8b e0	 mov	 r12, rax

; 575  : 
; 576  :     uReadSize = ((BUFREADCOMMENT+4) < (uSizeFile-uReadPos)) ?
; 577  :       (BUFREADCOMMENT+4) : (uLong)(uSizeFile-uReadPos);

  000a1	48 8b c7	 mov	 rax, rdi
  000a4	4d 0f 47 e7	 cmova	 r12, r15
  000a8	49 2b f4	 sub	 rsi, r12
  000ab	48 2b c6	 sub	 rax, rsi
  000ae	48 3d 04 04 00
	00		 cmp	 rax, 1028		; 00000404H
  000b4	76 07		 jbe	 SHORT $LN28@zip64local@9
  000b6	bf 04 04 00 00	 mov	 edi, 1028		; 00000404H
  000bb	eb 02		 jmp	 SHORT $LN29@zip64local@9
$LN28@zip64local@9:
  000bd	2b fe		 sub	 edi, esi
$LN29@zip64local@9:

; 578  :     if (ZSEEK64(*pzlib_filefunc_def,filestream,uReadPos,ZLIB_FILEFUNC_SEEK_SET)!=0)

  000bf	45 33 c9	 xor	 r9d, r9d
  000c2	4c 8b c6	 mov	 r8, rsi
  000c5	49 8b d6	 mov	 rdx, r14
  000c8	48 8b cd	 mov	 rcx, rbp
  000cb	e8 00 00 00 00	 call	 call_zseek64
  000d0	85 c0		 test	 eax, eax
  000d2	75 5b		 jne	 SHORT $LN39@zip64local@9

; 579  :       break;
; 580  : 
; 581  :     if (ZREAD64(*pzlib_filefunc_def,filestream,buf,uReadSize)!=uReadSize)

  000d4	48 8b 4d 38	 mov	 rcx, QWORD PTR [rbp+56]
  000d8	44 8b cf	 mov	 r9d, edi
  000db	4c 8b c3	 mov	 r8, rbx
  000de	49 8b d6	 mov	 rdx, r14
  000e1	ff 55 08	 call	 QWORD PTR [rbp+8]
  000e4	3b c7		 cmp	 eax, edi
  000e6	75 47		 jne	 SHORT $LN39@zip64local@9

; 582  :       break;
; 583  : 
; 584  :     for (i=(int)uReadSize-3; (i--)>0;)

  000e8	8d 4f fd	 lea	 ecx, DWORD PTR [rdi-3]
  000eb	48 63 c1	 movsxd	 rax, ecx
  000ee	85 c9		 test	 ecx, ecx
  000f0	7e 2f		 jle	 SHORT $LN38@zip64local@9
$LL16@zip64local@9:
  000f2	48 ff c8	 dec	 rax
  000f5	ff c9		 dec	 ecx

; 585  :     {
; 586  :       // Signature "0x07064b50" Zip64 end of central directory locater
; 587  :       if (((*(buf+i))==0x50) && ((*(buf+i+1))==0x4b) && ((*(buf+i+2))==0x06) && ((*(buf+i+3))==0x07))

  000f7	80 3c 18 50	 cmp	 BYTE PTR [rax+rbx], 80	; 00000050H
  000fb	75 15		 jne	 SHORT $LN14@zip64local@9
  000fd	80 7c 18 01 4b	 cmp	 BYTE PTR [rax+rbx+1], 75 ; 0000004bH
  00102	75 0e		 jne	 SHORT $LN14@zip64local@9
  00104	80 7c 18 02 06	 cmp	 BYTE PTR [rax+rbx+2], 6
  00109	75 07		 jne	 SHORT $LN14@zip64local@9
  0010b	80 7c 18 03 07	 cmp	 BYTE PTR [rax+rbx+3], 7
  00110	74 07		 je	 SHORT $LN32@zip64local@9
$LN14@zip64local@9:

; 582  :       break;
; 583  : 
; 584  :     for (i=(int)uReadSize-3; (i--)>0;)

  00112	48 85 c0	 test	 rax, rax
  00115	7f db		 jg	 SHORT $LL16@zip64local@9
  00117	eb 08		 jmp	 SHORT $LN38@zip64local@9
$LN32@zip64local@9:

; 588  :       {
; 589  :         uPosFound = uReadPos+i;

  00119	4c 63 e9	 movsxd	 r13, ecx
  0011c	4c 03 ee	 add	 r13, rsi

; 590  :         break;
; 591  :       }
; 592  :     }
; 593  : 
; 594  :       if (uPosFound!=0)

  0011f	75 0e		 jne	 SHORT $LN39@zip64local@9
$LN38@zip64local@9:

; 565  :   while (uBackRead<uMaxBack)

  00121	48 8b 7c 24 70	 mov	 rdi, QWORD PTR uSizeFile$1$[rsp]
  00126	4d 3b e7	 cmp	 r12, r15
  00129	0f 82 61 ff ff
	ff		 jb	 $LL22@zip64local@9
$LN39@zip64local@9:
  0012f	33 f6		 xor	 esi, esi
$LN33@zip64local@9:

; 595  :         break;
; 596  :   }
; 597  : 
; 598  :   TRYFREE(buf);

  00131	48 8b cb	 mov	 rcx, rbx
  00134	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free
  0013a	4c 8b 64 24 20	 mov	 r12, QWORD PTR [rsp+32]

; 599  :   if (uPosFound == 0)

  0013f	4d 85 ed	 test	 r13, r13

; 600  :     return 0;

  00142	0f 84 a4 00 00
	00		 je	 $LN42@zip64local@9

; 601  : 
; 602  :   /* Zip64 end of central directory locator */
; 603  :   if (ZSEEK64(*pzlib_filefunc_def,filestream, uPosFound,ZLIB_FILEFUNC_SEEK_SET)!=0)

  00148	45 33 c9	 xor	 r9d, r9d
  0014b	4d 8b c5	 mov	 r8, r13
  0014e	49 8b d6	 mov	 rdx, r14
  00151	48 8b cd	 mov	 rcx, rbp
  00154	e8 00 00 00 00	 call	 call_zseek64
  00159	85 c0		 test	 eax, eax

; 604  :     return 0;

  0015b	0f 85 8b 00 00
	00		 jne	 $LN42@zip64local@9

; 605  : 
; 606  :   /* the signature, already checked */
; 607  :   if (zip64local_getLong(pzlib_filefunc_def,filestream,&uL)!=ZIP_OK)

  00161	4c 8d 44 24 70	 lea	 r8, QWORD PTR uL$[rsp]
  00166	49 8b d6	 mov	 rdx, r14
  00169	48 8b cd	 mov	 rcx, rbp
  0016c	e8 00 00 00 00	 call	 zip64local_getLong
  00171	85 c0		 test	 eax, eax

; 608  :     return 0;

  00173	75 77		 jne	 SHORT $LN42@zip64local@9

; 609  : 
; 610  :   /* number of the disk with the start of the zip64 end of  central directory */
; 611  :   if (zip64local_getLong(pzlib_filefunc_def,filestream,&uL)!=ZIP_OK)

  00175	4c 8d 44 24 70	 lea	 r8, QWORD PTR uL$[rsp]
  0017a	49 8b d6	 mov	 rdx, r14
  0017d	48 8b cd	 mov	 rcx, rbp
  00180	e8 00 00 00 00	 call	 zip64local_getLong
  00185	85 c0		 test	 eax, eax

; 612  :     return 0;

  00187	75 63		 jne	 SHORT $LN42@zip64local@9

; 613  :   if (uL != 0)

  00189	39 44 24 70	 cmp	 DWORD PTR uL$[rsp], eax

; 614  :     return 0;

  0018d	75 5d		 jne	 SHORT $LN42@zip64local@9

; 615  : 
; 616  :   /* relative offset of the zip64 end of central directory record */
; 617  :   if (zip64local_getLong64(pzlib_filefunc_def,filestream,&relativeOffset)!=ZIP_OK)

  0018f	4c 8d 44 24 78	 lea	 r8, QWORD PTR relativeOffset$[rsp]
  00194	49 8b d6	 mov	 rdx, r14
  00197	48 8b cd	 mov	 rcx, rbp
  0019a	e8 00 00 00 00	 call	 zip64local_getLong64
  0019f	85 c0		 test	 eax, eax

; 618  :     return 0;

  001a1	75 49		 jne	 SHORT $LN42@zip64local@9

; 619  : 
; 620  :   /* total number of disks */
; 621  :   if (zip64local_getLong(pzlib_filefunc_def,filestream,&uL)!=ZIP_OK)

  001a3	4c 8d 44 24 70	 lea	 r8, QWORD PTR uL$[rsp]
  001a8	49 8b d6	 mov	 rdx, r14
  001ab	48 8b cd	 mov	 rcx, rbp
  001ae	e8 00 00 00 00	 call	 zip64local_getLong
  001b3	85 c0		 test	 eax, eax

; 622  :     return 0;

  001b5	75 35		 jne	 SHORT $LN42@zip64local@9

; 623  :   if (uL != 1)

  001b7	83 7c 24 70 01	 cmp	 DWORD PTR uL$[rsp], 1

; 624  :     return 0;

  001bc	75 2e		 jne	 SHORT $LN42@zip64local@9

; 625  : 
; 626  :   /* Goto Zip64 end of central directory record */
; 627  :   if (ZSEEK64(*pzlib_filefunc_def,filestream, relativeOffset,ZLIB_FILEFUNC_SEEK_SET)!=0)

  001be	48 8b 5c 24 78	 mov	 rbx, QWORD PTR relativeOffset$[rsp]
  001c3	45 33 c9	 xor	 r9d, r9d
  001c6	49 8b d6	 mov	 rdx, r14
  001c9	4c 8b c3	 mov	 r8, rbx
  001cc	48 8b cd	 mov	 rcx, rbp
  001cf	e8 00 00 00 00	 call	 call_zseek64
  001d4	85 c0		 test	 eax, eax

; 628  :     return 0;

  001d6	75 14		 jne	 SHORT $LN42@zip64local@9

; 629  : 
; 630  :   /* the signature */
; 631  :   if (zip64local_getLong(pzlib_filefunc_def,filestream,&uL)!=ZIP_OK)

  001d8	4c 8d 44 24 70	 lea	 r8, QWORD PTR uL$[rsp]
  001dd	49 8b d6	 mov	 rdx, r14
  001e0	48 8b cd	 mov	 rcx, rbp
  001e3	e8 00 00 00 00	 call	 zip64local_getLong
  001e8	85 c0		 test	 eax, eax
  001ea	74 04		 je	 SHORT $LN2@zip64local@9
$LN42@zip64local@9:

; 632  :     return 0;

  001ec	33 c0		 xor	 eax, eax
  001ee	eb 0f		 jmp	 SHORT $LN41@zip64local@9
$LN2@zip64local@9:

; 633  : 
; 634  :   if (uL != 0x06064b50) // signature of 'Zip64 end of central directory'

  001f0	81 7c 24 70 50
	4b 06 06	 cmp	 DWORD PTR uL$[rsp], 101075792 ; 06064b50H
  001f8	48 0f 45 de	 cmovne	 rbx, rsi
  001fc	48 8b c3	 mov	 rax, rbx
$LN41@zip64local@9:
  001ff	48 8b 5c 24 60	 mov	 rbx, QWORD PTR [rsp+96]
  00204	48 8b 7c 24 28	 mov	 rdi, QWORD PTR [rsp+40]

; 635  :     return 0;
; 636  : 
; 637  :   return relativeOffset;
; 638  : }

  00209	48 83 c4 30	 add	 rsp, 48			; 00000030H
  0020d	41 5f		 pop	 r15
  0020f	41 5e		 pop	 r14
  00211	41 5d		 pop	 r13
  00213	5e		 pop	 rsi
  00214	5d		 pop	 rbp
  00215	c3		 ret	 0
zip64local_SearchCentralDir64 ENDP
_TEXT	ENDS
;	COMDAT pdata
; File c:\program files (x86)\microsoft visual studio 10.0\vc\include\time.inl
pdata	SEGMENT
$pdata$crypthead DD imagerel crypthead
	DD	imagerel crypthead+330
	DD	imagerel $unwind$crypthead
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$crypthead DD 0c1c01H
	DD	0e641cH
	DD	0d541cH
	DD	0c341cH
	DD	0f018521cH
	DD	0d014e016H
	DD	07010c012H
; Function compile flags: /Ogtpy
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\crypt.h
xdata	ENDS
;	COMDAT crypthead
_TEXT	SEGMENT
header$ = 32
passwd$ = 96
buf$ = 104
pkeys$ = 112
pcrc_32_tab$ = 120
crcForCrypting$ = 128
crypthead PROC						; COMDAT

; 96   : {

  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 6c 24 10	 mov	 QWORD PTR [rsp+16], rbp
  0000a	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  0000f	57		 push	 rdi
  00010	41 54		 push	 r12
  00012	41 55		 push	 r13
  00014	41 56		 push	 r14
  00016	41 57		 push	 r15
  00018	48 83 ec 30	 sub	 rsp, 48			; 00000030H

; 97   :     int n;                       /* index in random header */
; 98   :     int t;                       /* temporary */
; 99   :     int c;                       /* random byte */
; 100  :     unsigned char header[RAND_HEAD_LEN-2]; /* random header */
; 101  :     static unsigned calls = 0;   /* ensure different random header each time */
; 102  : 
; 103  :     if (bufSize<RAND_HEAD_LEN)
; 104  :       return 0;
; 105  : 
; 106  :     /* First generate RAND_HEAD_LEN-2 random bytes. We encrypt the
; 107  :      * output of rand() to get less predictability, since rand() is
; 108  :      * often poorly implemented.
; 109  :      */
; 110  :     if (++calls == 1)

  0001c	8b 05 00 00 00
	00		 mov	 eax, DWORD PTR ?calls@?1??crypthead@@9@9
  00022	4d 8b e9	 mov	 r13, r9
  00025	49 8b e8	 mov	 rbp, r8
  00028	ff c0		 inc	 eax
  0002a	4c 8b fa	 mov	 r15, rdx
  0002d	4c 8b f1	 mov	 r14, rcx
  00030	89 05 00 00 00
	00		 mov	 DWORD PTR ?calls@?1??crypthead@@9@9, eax
  00036	83 f8 01	 cmp	 eax, 1
  00039	75 15		 jne	 SHORT $LN7@crypthead

; 111  :     {
; 112  :         srand((unsigned)(time(NULL) ^ ZCR_SEED2));

  0003b	33 c9		 xor	 ecx, ecx
  0003d	ff 15 00 00 00
	00		 call	 QWORD PTR __imp__time64
  00043	35 4e e6 40 bb	 xor	 eax, -1153374642	; bb40e64eH
  00048	8b c8		 mov	 ecx, eax
  0004a	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_srand
$LN7@crypthead:

; 113  :     }
; 114  :     init_keys(passwd, pkeys, pcrc_32_tab);

  00050	4d 8b c5	 mov	 r8, r13
  00053	48 8b d5	 mov	 rdx, rbp
  00056	49 8b ce	 mov	 rcx, r14
  00059	e8 00 00 00 00	 call	 init_keys

; 115  :     for (n = 0; n < RAND_HEAD_LEN-2; n++)

  0005e	45 33 e4	 xor	 r12d, r12d
  00061	41 8b f4	 mov	 esi, r12d
$LL6@crypthead:

; 116  :     {
; 117  :         c = (rand() >> 7) & 0xff;

  00064	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_rand

; 118  :         header[n] = (unsigned char)zencode(pkeys, pcrc_32_tab, c, t);

  0006a	48 8b cd	 mov	 rcx, rbp
  0006d	c1 f8 07	 sar	 eax, 7
  00070	0f b6 f8	 movzx	 edi, al
  00073	e8 00 00 00 00	 call	 decrypt_byte
  00078	44 8b c7	 mov	 r8d, edi
  0007b	49 8b d5	 mov	 rdx, r13
  0007e	8b d8		 mov	 ebx, eax
  00080	e8 00 00 00 00	 call	 update_keys
  00085	40 32 fb	 xor	 dil, bl
  00088	48 ff c6	 inc	 rsi
  0008b	40 88 7c 34 1f	 mov	 BYTE PTR header$[rsp+rsi-1], dil
  00090	48 83 fe 0a	 cmp	 rsi, 10
  00094	7c ce		 jl	 SHORT $LL6@crypthead

; 119  :     }
; 120  :     /* Encrypt random header (last two bytes is high word of crc) */
; 121  :     init_keys(passwd, pkeys, pcrc_32_tab);

  00096	4d 8b c5	 mov	 r8, r13
  00099	48 8b d5	 mov	 rdx, rbp
  0009c	49 8b ce	 mov	 rcx, r14
  0009f	e8 00 00 00 00	 call	 init_keys

; 122  :     for (n = 0; n < RAND_HEAD_LEN-2; n++)

  000a4	48 8d 44 24 20	 lea	 rax, QWORD PTR header$[rsp]
  000a9	4d 8b f7	 mov	 r14, r15
  000ac	4c 2b f0	 sub	 r14, rax
  000af	90		 npad	 1
$LL3@crypthead:

; 123  :     {
; 124  :         buf[n] = (unsigned char)zencode(pkeys, pcrc_32_tab, header[n], t);

  000b0	48 8b cd	 mov	 rcx, rbp
  000b3	e8 00 00 00 00	 call	 decrypt_byte
  000b8	42 0f b6 5c 24
	20		 movzx	 ebx, BYTE PTR header$[rsp+r12]
  000be	4a 8d 74 24 20	 lea	 rsi, QWORD PTR header$[rsp+r12]
  000c3	44 8b c3	 mov	 r8d, ebx
  000c6	49 8b d5	 mov	 rdx, r13
  000c9	8b f8		 mov	 edi, eax
  000cb	e8 00 00 00 00	 call	 update_keys
  000d0	40 32 df	 xor	 bl, dil
  000d3	49 ff c4	 inc	 r12
  000d6	41 88 1c 36	 mov	 BYTE PTR [r14+rsi], bl
  000da	49 83 fc 0a	 cmp	 r12, 10
  000de	7c d0		 jl	 SHORT $LL3@crypthead

; 125  :     }
; 126  :     buf[n++] = (unsigned char)zencode(pkeys, pcrc_32_tab, (int)(crcForCrypting >> 16) & 0xff, t);

  000e0	48 8b cd	 mov	 rcx, rbp
  000e3	e8 00 00 00 00	 call	 decrypt_byte
  000e8	8b b4 24 80 00
	00 00		 mov	 esi, DWORD PTR crcForCrypting$[rsp]
  000ef	49 8b d5	 mov	 rdx, r13
  000f2	8b de		 mov	 ebx, esi
  000f4	8b f8		 mov	 edi, eax
  000f6	c1 eb 10	 shr	 ebx, 16
  000f9	44 0f b6 c3	 movzx	 r8d, bl
  000fd	e8 00 00 00 00	 call	 update_keys
  00102	40 32 df	 xor	 bl, dil

; 127  :     buf[n++] = (unsigned char)zencode(pkeys, pcrc_32_tab, (int)(crcForCrypting >> 24) & 0xff, t);

  00105	48 8b cd	 mov	 rcx, rbp
  00108	41 88 5f 0a	 mov	 BYTE PTR [r15+10], bl
  0010c	e8 00 00 00 00	 call	 decrypt_byte
  00111	c1 ee 18	 shr	 esi, 24
  00114	44 8b c6	 mov	 r8d, esi
  00117	49 8b d5	 mov	 rdx, r13
  0011a	8b d8		 mov	 ebx, eax
  0011c	e8 00 00 00 00	 call	 update_keys

; 128  :     return n;
; 129  : }

  00121	48 8b 6c 24 68	 mov	 rbp, QWORD PTR [rsp+104]
  00126	40 32 f3	 xor	 sil, bl
  00129	48 8b 5c 24 60	 mov	 rbx, QWORD PTR [rsp+96]
  0012e	41 88 77 0b	 mov	 BYTE PTR [r15+11], sil
  00132	48 8b 74 24 70	 mov	 rsi, QWORD PTR [rsp+112]
  00137	b8 0c 00 00 00	 mov	 eax, 12
  0013c	48 83 c4 30	 add	 rsp, 48			; 00000030H
  00140	41 5f		 pop	 r15
  00142	41 5e		 pop	 r14
  00144	41 5d		 pop	 r13
  00146	41 5c		 pop	 r12
  00148	5f		 pop	 rdi
  00149	c3		 ret	 0
crypthead ENDP
PUBLIC	LoadCentralDirectoryRecord
;	COMDAT pdata
; File c:\users\darrin\downloads\zlib127\zlib-1.2.7\contrib\minizip\zip.c
pdata	SEGMENT
$pdata$LoadCentralDirectoryRecord DD imagerel $LN55
	DD	imagerel $LN55+921
	DD	imagerel $unwind$LoadCentralDirectoryRecord
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$LoadCentralDirectoryRecord DD 091401H
	DD	0f00d6214H
	DD	0d009e00bH
	DD	07005c007H
	DD	030036004H
	DD	05002H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT LoadCentralDirectoryRecord
_TEXT	SEGMENT
number_entry$ = 32
tv363 = 128
size_comment$ = 128
size_central_dir$ = 128
number_entry_CD$ = 128
VersionNeeded$ = 128
VersionMadeBy$ = 128
sizeEndOfCentralDirectory$83603 = 128
uL$ = 128
pziinit$ = 128
offset_central_dir$ = 136
number_disk_with_CD$ = 136
number_disk$ = 144
number_entry_CD$1$ = 152
LoadCentralDirectoryRecord PROC				; COMDAT

; 641  : {

$LN55:
  00000	40 55		 push	 rbp
  00002	53		 push	 rbx
  00003	56		 push	 rsi
  00004	57		 push	 rdi
  00005	41 54		 push	 r12
  00007	41 55		 push	 r13
  00009	41 56		 push	 r14
  0000b	41 57		 push	 r15
  0000d	48 8b ec	 mov	 rbp, rsp
  00010	48 83 ec 38	 sub	 rsp, 56			; 00000038H

; 642  :   int err=ZIP_OK;
; 643  :   ZPOS64_T byte_before_the_zipfile;/* byte before the zipfile, (>0 for sfx)*/
; 644  : 
; 645  :   ZPOS64_T size_central_dir;     /* size of the central directory  */
; 646  :   ZPOS64_T offset_central_dir;   /* offset of start of central directory */
; 647  :   ZPOS64_T central_pos;
; 648  :   uLong uL;
; 649  : 
; 650  :   uLong number_disk;          /* number of the current dist, used for
; 651  :                               spaning ZIP, unsupported, always 0*/
; 652  :   uLong number_disk_with_CD;  /* number the the disk with central dir, used
; 653  :                               for spaning ZIP, unsupported, always 0*/
; 654  :   ZPOS64_T number_entry;
; 655  :   ZPOS64_T number_entry_CD;      /* total number of entries in
; 656  :                                 the central dir
; 657  :                                 (same than number_entry on nospan) */
; 658  :   uLong VersionMadeBy;
; 659  :   uLong VersionNeeded;
; 660  :   uLong size_comment;
; 661  : 
; 662  :   int hasZIP64Record = 0;
; 663  : 
; 664  :   // check first if we find a ZIP64 record
; 665  :   central_pos = zip64local_SearchCentralDir64(&pziinit->z_filefunc,pziinit->filestream);

  00014	48 8b 51 58	 mov	 rdx, QWORD PTR [rcx+88]
  00018	48 8b d9	 mov	 rbx, rcx
  0001b	33 f6		 xor	 esi, esi
  0001d	e8 00 00 00 00	 call	 zip64local_SearchCentralDir64

; 666  :   if(central_pos > 0)
; 667  :   {
; 668  :     hasZIP64Record = 1;
; 669  :   }
; 670  :   else if(central_pos == 0)
; 671  :   {
; 672  :     central_pos = zip64local_SearchCentralDir(&pziinit->z_filefunc,pziinit->filestream);

  00022	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00026	48 8b cb	 mov	 rcx, rbx
  00029	4c 8b f0	 mov	 r14, rax
  0002c	48 85 c0	 test	 rax, rax
  0002f	0f 85 19 01 00
	00		 jne	 $LN51@LoadCentra
  00035	e8 00 00 00 00	 call	 zip64local_SearchCentralDir

; 735  :   {
; 736  :     // Read End of central Directory info
; 737  :     if (ZSEEK64(pziinit->z_filefunc, pziinit->filestream, central_pos,ZLIB_FILEFUNC_SEEK_SET)!=0)

  0003a	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0003e	45 33 c9	 xor	 r9d, r9d
  00041	4c 8b c0	 mov	 r8, rax
  00044	48 8b cb	 mov	 rcx, rbx
  00047	4c 8b f0	 mov	 r14, rax
  0004a	e8 00 00 00 00	 call	 call_zseek64

; 738  :       err=ZIP_ERRNO;
; 739  : 
; 740  :     /* the signature, already checked */
; 741  :     if (zip64local_getLong(&pziinit->z_filefunc, pziinit->filestream,&uL)!=ZIP_OK)

  0004f	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00053	41 83 cd ff	 or	 r13d, -1
  00057	85 c0		 test	 eax, eax
  00059	4c 8d 45 48	 lea	 r8, QWORD PTR uL$[rbp-56]
  0005d	8b fe		 mov	 edi, esi
  0005f	48 8b cb	 mov	 rcx, rbx
  00062	41 0f 45 fd	 cmovne	 edi, r13d
  00066	e8 00 00 00 00	 call	 zip64local_getLong

; 742  :       err=ZIP_ERRNO;
; 743  : 
; 744  :     /* number of this disk */
; 745  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream,&number_disk)!=ZIP_OK)

  0006b	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0006f	4c 8d 45 58	 lea	 r8, QWORD PTR number_disk$[rbp-56]
  00073	85 c0		 test	 eax, eax
  00075	48 8b cb	 mov	 rcx, rbx
  00078	41 0f 45 fd	 cmovne	 edi, r13d
  0007c	e8 00 00 00 00	 call	 zip64local_getShort

; 746  :       err=ZIP_ERRNO;
; 747  : 
; 748  :     /* number of the disk with the start of the central directory */
; 749  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream,&number_disk_with_CD)!=ZIP_OK)

  00081	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00085	85 c0		 test	 eax, eax
  00087	4c 8d 45 50	 lea	 r8, QWORD PTR number_disk_with_CD$[rbp-56]
  0008b	48 8b cb	 mov	 rcx, rbx
  0008e	41 0f 45 fd	 cmovne	 edi, r13d
  00092	e8 00 00 00 00	 call	 zip64local_getShort

; 750  :       err=ZIP_ERRNO;
; 751  : 
; 752  :     /* total number of entries in the central dir on this disk */
; 753  :     number_entry = 0;
; 754  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream, &uL)!=ZIP_OK)

  00097	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0009b	85 c0		 test	 eax, eax
  0009d	4c 8d 45 48	 lea	 r8, QWORD PTR uL$[rbp-56]
  000a1	48 8b cb	 mov	 rcx, rbx
  000a4	41 0f 45 fd	 cmovne	 edi, r13d
  000a8	44 8b fe	 mov	 r15d, esi
  000ab	e8 00 00 00 00	 call	 zip64local_getShort
  000b0	85 c0		 test	 eax, eax
  000b2	74 05		 je	 SHORT $LN23@LoadCentra

; 755  :       err=ZIP_ERRNO;

  000b4	41 8b fd	 mov	 edi, r13d

; 756  :     else

  000b7	eb 04		 jmp	 SHORT $LN22@LoadCentra
$LN23@LoadCentra:

; 757  :       number_entry = uL;

  000b9	44 8b 7d 48	 mov	 r15d, DWORD PTR uL$[rbp-56]
$LN22@LoadCentra:

; 758  : 
; 759  :     /* total number of entries in the central dir */
; 760  :     number_entry_CD = 0;
; 761  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream, &uL)!=ZIP_OK)

  000bd	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000c1	4c 8d 45 48	 lea	 r8, QWORD PTR uL$[rbp-56]
  000c5	48 8b cb	 mov	 rcx, rbx
  000c8	4c 8b e6	 mov	 r12, rsi
  000cb	48 89 75 60	 mov	 QWORD PTR number_entry_CD$1$[rbp-56], rsi
  000cf	e8 00 00 00 00	 call	 zip64local_getShort
  000d4	85 c0		 test	 eax, eax
  000d6	74 05		 je	 SHORT $LN21@LoadCentra

; 762  :       err=ZIP_ERRNO;

  000d8	41 8b fd	 mov	 edi, r13d

; 763  :     else

  000db	eb 08		 jmp	 SHORT $LN20@LoadCentra
$LN21@LoadCentra:

; 764  :       number_entry_CD = uL;

  000dd	44 8b 65 48	 mov	 r12d, DWORD PTR uL$[rbp-56]
  000e1	4c 89 65 60	 mov	 QWORD PTR number_entry_CD$1$[rbp-56], r12
$LN20@LoadCentra:

; 765  : 
; 766  :     if ((number_entry_CD!=number_entry) || (number_disk_with_CD!=0) || (number_disk!=0))

  000e5	4d 3b e7	 cmp	 r12, r15
  000e8	75 0a		 jne	 SHORT $LN18@LoadCentra
  000ea	39 75 50	 cmp	 DWORD PTR number_disk_with_CD$[rbp-56], esi
  000ed	75 05		 jne	 SHORT $LN18@LoadCentra
  000ef	39 75 58	 cmp	 DWORD PTR number_disk$[rbp-56], esi
  000f2	74 05		 je	 SHORT $LN19@LoadCentra
$LN18@LoadCentra:

; 767  :       err=ZIP_BADZIPFILE;

  000f4	bf 99 ff ff ff	 mov	 edi, -103		; ffffffffffffff99H
$LN19@LoadCentra:

; 768  : 
; 769  :     /* size of the central directory */
; 770  :     size_central_dir = 0;
; 771  :     if (zip64local_getLong(&pziinit->z_filefunc, pziinit->filestream, &uL)!=ZIP_OK)

  000f9	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  000fd	4c 8d 45 48	 lea	 r8, QWORD PTR uL$[rbp-56]
  00101	48 8b cb	 mov	 rcx, rbx
  00104	4c 8b e6	 mov	 r12, rsi
  00107	e8 00 00 00 00	 call	 zip64local_getLong
  0010c	85 c0		 test	 eax, eax
  0010e	74 05		 je	 SHORT $LN17@LoadCentra

; 772  :       err=ZIP_ERRNO;

  00110	41 8b fd	 mov	 edi, r13d

; 773  :     else

  00113	eb 04		 jmp	 SHORT $LN16@LoadCentra
$LN17@LoadCentra:

; 774  :       size_central_dir = uL;

  00115	44 8b 65 48	 mov	 r12d, DWORD PTR uL$[rbp-56]
$LN16@LoadCentra:

; 775  : 
; 776  :     /* offset of start of central directory with respect to the starting disk number */
; 777  :     offset_central_dir = 0;
; 778  :     if (zip64local_getLong(&pziinit->z_filefunc, pziinit->filestream, &uL)!=ZIP_OK)

  00119	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0011d	4c 8d 45 48	 lea	 r8, QWORD PTR uL$[rbp-56]
  00121	48 8b cb	 mov	 rcx, rbx
  00124	e8 00 00 00 00	 call	 zip64local_getLong
  00129	85 c0		 test	 eax, eax
  0012b	74 05		 je	 SHORT $LN15@LoadCentra

; 779  :       err=ZIP_ERRNO;

  0012d	41 8b fd	 mov	 edi, r13d

; 780  :     else

  00130	eb 03		 jmp	 SHORT $LN14@LoadCentra
$LN15@LoadCentra:

; 781  :       offset_central_dir = uL;

  00132	8b 75 48	 mov	 esi, DWORD PTR uL$[rbp-56]
$LN14@LoadCentra:

; 782  : 
; 783  : 
; 784  :     /* zipfile global comment length */
; 785  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream, &size_comment)!=ZIP_OK)

  00135	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00139	4c 8d 45 48	 lea	 r8, QWORD PTR size_comment$[rbp-56]
  0013d	48 8b cb	 mov	 rcx, rbx
  00140	e8 00 00 00 00	 call	 zip64local_getShort
  00145	44 8b 7d 48	 mov	 r15d, DWORD PTR size_comment$[rbp-56]
  00149	e9 15 01 00 00	 jmp	 $LN54@LoadCentra
$LN51@LoadCentra:

; 673  :   }
; 674  : 
; 675  : /* disable to allow appending to empty ZIP archive
; 676  :         if (central_pos==0)
; 677  :             err=ZIP_ERRNO;
; 678  : */
; 679  : 
; 680  :   if(hasZIP64Record)
; 681  :   {
; 682  :     ZPOS64_T sizeEndOfCentralDirectory;
; 683  :     if (ZSEEK64(pziinit->z_filefunc, pziinit->filestream, central_pos, ZLIB_FILEFUNC_SEEK_SET) != 0)

  0014e	45 33 c9	 xor	 r9d, r9d
  00151	4c 8b c0	 mov	 r8, rax
  00154	e8 00 00 00 00	 call	 call_zseek64

; 684  :       err=ZIP_ERRNO;
; 685  : 
; 686  :     /* the signature, already checked */
; 687  :     if (zip64local_getLong(&pziinit->z_filefunc, pziinit->filestream,&uL)!=ZIP_OK)

  00159	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0015d	41 83 cd ff	 or	 r13d, -1
  00161	85 c0		 test	 eax, eax
  00163	4c 8d 45 48	 lea	 r8, QWORD PTR uL$[rbp-56]
  00167	8b fe		 mov	 edi, esi
  00169	48 8b cb	 mov	 rcx, rbx
  0016c	41 0f 45 fd	 cmovne	 edi, r13d
  00170	e8 00 00 00 00	 call	 zip64local_getLong

; 688  :       err=ZIP_ERRNO;
; 689  : 
; 690  :     /* size of zip64 end of central directory record */
; 691  :     if (zip64local_getLong64(&pziinit->z_filefunc, pziinit->filestream, &sizeEndOfCentralDirectory)!=ZIP_OK)

  00175	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00179	4c 8d 45 48	 lea	 r8, QWORD PTR sizeEndOfCentralDirectory$83603[rbp-56]
  0017d	85 c0		 test	 eax, eax
  0017f	48 8b cb	 mov	 rcx, rbx
  00182	41 0f 45 fd	 cmovne	 edi, r13d
  00186	e8 00 00 00 00	 call	 zip64local_getLong64

; 692  :       err=ZIP_ERRNO;
; 693  : 
; 694  :     /* version made by */
; 695  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream, &VersionMadeBy)!=ZIP_OK)

  0018b	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0018f	85 c0		 test	 eax, eax
  00191	4c 8d 45 48	 lea	 r8, QWORD PTR VersionMadeBy$[rbp-56]
  00195	48 8b cb	 mov	 rcx, rbx
  00198	41 0f 45 fd	 cmovne	 edi, r13d
  0019c	e8 00 00 00 00	 call	 zip64local_getShort

; 696  :       err=ZIP_ERRNO;
; 697  : 
; 698  :     /* version needed to extract */
; 699  :     if (zip64local_getShort(&pziinit->z_filefunc, pziinit->filestream, &VersionNeeded)!=ZIP_OK)

  001a1	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001a5	85 c0		 test	 eax, eax
  001a7	4c 8d 45 48	 lea	 r8, QWORD PTR VersionNeeded$[rbp-56]
  001ab	48 8b cb	 mov	 rcx, rbx
  001ae	41 0f 45 fd	 cmovne	 edi, r13d
  001b2	e8 00 00 00 00	 call	 zip64local_getShort

; 700  :       err=ZIP_ERRNO;
; 701  : 
; 702  :     /* number of this disk */
; 703  :     if (zip64local_getLong(&pziinit->z_filefunc, pziinit->filestream,&number_disk)!=ZIP_OK)

  001b7	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001bb	85 c0		 test	 eax, eax
  001bd	4c 8d 45 58	 lea	 r8, QWORD PTR number_disk$[rbp-56]
  001c1	48 8b cb	 mov	 rcx, rbx
  001c4	41 0f 45 fd	 cmovne	 edi, r13d
  001c8	e8 00 00 00 00	 call	 zip64local_getLong

; 704  :       err=ZIP_ERRNO;
; 705  : 
; 706  :     /* number of the disk with the start of the central directory */
; 707  :     if (zip64local_getLong(&pziinit->z_filefunc, pziinit->filestream,&number_disk_with_CD)!=ZIP_OK)

  001cd	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001d1	85 c0		 test	 eax, eax
  001d3	4c 8d 45 50	 lea	 r8, QWORD PTR number_disk_with_CD$[rbp-56]
  001d7	48 8b cb	 mov	 rcx, rbx
  001da	41 0f 45 fd	 cmovne	 edi, r13d
  001de	e8 00 00 00 00	 call	 zip64local_getLong

; 708  :       err=ZIP_ERRNO;
; 709  : 
; 710  :     /* total number of entries in the central directory on this disk */
; 711  :     if (zip64local_getLong64(&pziinit->z_filefunc, pziinit->filestream, &number_entry)!=ZIP_OK)

  001e3	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001e7	85 c0		 test	 eax, eax
  001e9	4c 8d 45 e8	 lea	 r8, QWORD PTR number_entry$[rbp-56]
  001ed	48 8b cb	 mov	 rcx, rbx
  001f0	41 0f 45 fd	 cmovne	 edi, r13d
  001f4	e8 00 00 00 00	 call	 zip64local_getLong64

; 712  :       err=ZIP_ERRNO;
; 713  : 
; 714  :     /* total number of entries in the central directory */
; 715  :     if (zip64local_getLong64(&pziinit->z_filefunc, pziinit->filestream,&number_entry_CD)!=ZIP_OK)

  001f9	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  001fd	85 c0		 test	 eax, eax
  001ff	4c 8d 45 48	 lea	 r8, QWORD PTR number_entry_CD$[rbp-56]
  00203	48 8b cb	 mov	 rcx, rbx
  00206	41 0f 45 fd	 cmovne	 edi, r13d
  0020a	e8 00 00 00 00	 call	 zip64local_getLong64
  0020f	85 c0		 test	 eax, eax

; 716  :       err=ZIP_ERRNO;
; 717  : 
; 718  :     if ((number_entry_CD!=number_entry) || (number_disk_with_CD!=0) || (number_disk!=0))

  00211	48 8b 45 48	 mov	 rax, QWORD PTR number_entry_CD$[rbp-56]
  00215	41 0f 45 fd	 cmovne	 edi, r13d
  00219	48 89 45 60	 mov	 QWORD PTR number_entry_CD$1$[rbp-56], rax
  0021d	48 3b 45 e8	 cmp	 rax, QWORD PTR number_entry$[rbp-56]
  00221	75 0a		 jne	 SHORT $LN31@LoadCentra
  00223	39 75 50	 cmp	 DWORD PTR number_disk_with_CD$[rbp-56], esi
  00226	75 05		 jne	 SHORT $LN31@LoadCentra
  00228	39 75 58	 cmp	 DWORD PTR number_disk$[rbp-56], esi
  0022b	74 05		 je	 SHORT $LN32@LoadCentra
$LN31@LoadCentra:

; 719  :       err=ZIP_BADZIPFILE;

  0022d	bf 99 ff ff ff	 mov	 edi, -103		; ffffffffffffff99H
$LN32@LoadCentra:

; 720  : 
; 721  :     /* size of the central directory */
; 722  :     if (zip64local_getLong64(&pziinit->z_filefunc, pziinit->filestream,&size_central_dir)!=ZIP_OK)

  00232	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00236	4c 8d 45 48	 lea	 r8, QWORD PTR size_central_dir$[rbp-56]
  0023a	48 8b cb	 mov	 rcx, rbx
  0023d	e8 00 00 00 00	 call	 zip64local_getLong64

; 723  :       err=ZIP_ERRNO;
; 724  : 
; 725  :     /* offset of start of central directory with respect to the
; 726  :     starting disk number */
; 727  :     if (zip64local_getLong64(&pziinit->z_filefunc, pziinit->filestream,&offset_central_dir)!=ZIP_OK)

  00242	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00246	4c 8d 45 50	 lea	 r8, QWORD PTR offset_central_dir$[rbp-56]
  0024a	85 c0		 test	 eax, eax
  0024c	48 8b cb	 mov	 rcx, rbx
  0024f	41 0f 45 fd	 cmovne	 edi, r13d
  00253	e8 00 00 00 00	 call	 zip64local_getLong64

; 728  :       err=ZIP_ERRNO;
; 729  : 
; 730  :     // TODO..
; 731  :     // read the comment from the standard central header.
; 732  :     size_comment = 0;
; 733  :   }
; 734  :   else

  00258	4c 8b 65 48	 mov	 r12, QWORD PTR size_central_dir$[rbp-56]
  0025c	44 8b fe	 mov	 r15d, esi
  0025f	48 8b 75 50	 mov	 rsi, QWORD PTR offset_central_dir$[rbp-56]
$LN54@LoadCentra:

; 786  :       err=ZIP_ERRNO;
; 787  :   }
; 788  : 
; 789  :   if ((central_pos<offset_central_dir+size_central_dir) &&
; 790  :     (err==ZIP_OK))

  00263	85 c0		 test	 eax, eax
  00265	4a 8d 04 26	 lea	 rax, QWORD PTR [rsi+r12]
  00269	41 0f 45 fd	 cmovne	 edi, r13d
  0026d	4c 3b f0	 cmp	 r14, rax

; 791  :     err=ZIP_BADZIPFILE;
; 792  : 
; 793  :   if (err!=ZIP_OK)

  00270	0f 82 04 01 00
	00		 jb	 $LN50@LoadCentra
  00276	85 ff		 test	 edi, edi
  00278	0f 85 fc 00 00
	00		 jne	 $LN50@LoadCentra

; 797  :   }
; 798  : 
; 799  :   if (size_comment>0)

  0027e	45 85 ff	 test	 r15d, r15d
  00281	74 34		 je	 SHORT $LN9@LoadCentra

; 800  :   {
; 801  :     pziinit->globalcomment = (char*)ALLOC(size_comment+1);

  00283	41 8d 4f 01	 lea	 ecx, DWORD PTR [r15+1]
  00287	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc
  0028d	48 89 83 60 01
	01 00		 mov	 QWORD PTR [rbx+65888], rax

; 802  :     if (pziinit->globalcomment)

  00294	48 85 c0	 test	 rax, rax
  00297	74 1e		 je	 SHORT $LN9@LoadCentra

; 803  :     {
; 804  :       size_comment = ZREAD64(pziinit->z_filefunc, pziinit->filestream, pziinit->globalcomment,size_comment);

  00299	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0029d	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  002a1	45 8b cf	 mov	 r9d, r15d
  002a4	4c 8b c0	 mov	 r8, rax
  002a7	ff 53 08	 call	 QWORD PTR [rbx+8]

; 805  :       pziinit->globalcomment[size_comment]=0;

  002aa	8b c8		 mov	 ecx, eax
  002ac	48 8b 83 60 01
	01 00		 mov	 rax, QWORD PTR [rbx+65888]
  002b3	40 88 3c 01	 mov	 BYTE PTR [rcx+rax], dil
$LN9@LoadCentra:

; 806  :     }
; 807  :   }
; 808  : 
; 809  :   byte_before_the_zipfile = central_pos - (offset_central_dir+size_central_dir);

  002b7	4c 2b f6	 sub	 r14, rsi

; 810  :   pziinit->add_position_when_writting_offset = byte_before_the_zipfile;
; 811  : 
; 812  :   {
; 813  :     ZPOS64_T size_central_dir_to_read = size_central_dir;
; 814  :     size_t buf_size = SIZEDATA_INDATABLOCK;
; 815  :     void* buf_read = (void*)ALLOC(buf_size);

  002ba	b9 f0 0f 00 00	 mov	 ecx, 4080		; 00000ff0H
  002bf	4d 2b f4	 sub	 r14, r12
  002c2	4c 89 b3 50 01
	01 00		 mov	 QWORD PTR [rbx+65872], r14
  002c9	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc

; 816  :     if (ZSEEK64(pziinit->z_filefunc, pziinit->filestream, offset_central_dir + byte_before_the_zipfile, ZLIB_FILEFUNC_SEEK_SET) != 0)

  002cf	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  002d3	49 03 f6	 add	 rsi, r14
  002d6	45 33 c9	 xor	 r9d, r9d
  002d9	48 8b cb	 mov	 rcx, rbx
  002dc	4c 8b c6	 mov	 r8, rsi
  002df	4c 8b f8	 mov	 r15, rax
  002e2	48 89 75 48	 mov	 QWORD PTR tv363[rbp-56], rsi
  002e6	e8 00 00 00 00	 call	 call_zseek64
  002eb	85 c0		 test	 eax, eax
  002ed	41 0f 45 fd	 cmovne	 edi, r13d

; 817  :       err=ZIP_ERRNO;
; 818  : 
; 819  :     while ((size_central_dir_to_read>0) && (err==ZIP_OK))

  002f1	4d 85 e4	 test	 r12, r12
  002f4	74 48		 je	 SHORT $LN6@LoadCentra
$LL7@LoadCentra:
  002f6	85 ff		 test	 edi, edi
  002f8	75 40		 jne	 SHORT $LN53@LoadCentra

; 820  :     {
; 821  :       ZPOS64_T read_this = SIZEDATA_INDATABLOCK;
; 822  :       if (read_this > size_central_dir_to_read)
; 823  :         read_this = size_central_dir_to_read;
; 824  : 
; 825  :       if (ZREAD64(pziinit->z_filefunc, pziinit->filestream,buf_read,(uLong)read_this) != read_this)

  002fa	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  002fe	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  00302	be f0 0f 00 00	 mov	 esi, 4080		; 00000ff0H
  00307	4c 3b e6	 cmp	 r12, rsi
  0030a	4d 8b c7	 mov	 r8, r15
  0030d	49 0f 42 f4	 cmovb	 rsi, r12
  00311	44 8b ce	 mov	 r9d, esi
  00314	ff 53 08	 call	 QWORD PTR [rbx+8]
  00317	44 8b d8	 mov	 r11d, eax
  0031a	4c 3b de	 cmp	 r11, rsi
  0031d	74 05		 je	 SHORT $LN52@LoadCentra

; 826  :         err=ZIP_ERRNO;

  0031f	41 8b fd	 mov	 edi, r13d

; 827  : 
; 828  :       if (err==ZIP_OK)

  00322	eb 11		 jmp	 SHORT $LN3@LoadCentra
$LN52@LoadCentra:

; 829  :         err = add_data_in_datablock(&pziinit->central_dir,buf_read, (uLong)read_this);

  00324	48 8d 4b 60	 lea	 rcx, QWORD PTR [rbx+96]
  00328	44 8b c6	 mov	 r8d, esi
  0032b	49 8b d7	 mov	 rdx, r15
  0032e	e8 00 00 00 00	 call	 add_data_in_datablock
  00333	8b f8		 mov	 edi, eax
$LN3@LoadCentra:

; 830  : 
; 831  :       size_central_dir_to_read-=read_this;

  00335	4c 2b e6	 sub	 r12, rsi

; 817  :       err=ZIP_ERRNO;
; 818  : 
; 819  :     while ((size_central_dir_to_read>0) && (err==ZIP_OK))

  00338	75 bc		 jne	 SHORT $LL7@LoadCentra
$LN53@LoadCentra:
  0033a	48 8b 75 48	 mov	 rsi, QWORD PTR tv363[rbp-56]
$LN6@LoadCentra:

; 832  :     }
; 833  :     TRYFREE(buf_read);

  0033e	4d 85 ff	 test	 r15, r15
  00341	74 09		 je	 SHORT $LN2@LoadCentra
  00343	49 8b cf	 mov	 rcx, r15
  00346	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free
$LN2@LoadCentra:

; 834  :   }
; 835  :   pziinit->begin_pos = byte_before_the_zipfile;
; 836  :   pziinit->number_entry = number_entry_CD;

  0034c	48 8b 45 60	 mov	 rax, QWORD PTR number_entry_CD$1$[rbp-56]

; 837  : 
; 838  :   if (ZSEEK64(pziinit->z_filefunc, pziinit->filestream, offset_central_dir+byte_before_the_zipfile,ZLIB_FILEFUNC_SEEK_SET) != 0)

  00350	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00354	45 33 c9	 xor	 r9d, r9d
  00357	4c 8b c6	 mov	 r8, rsi
  0035a	48 8b cb	 mov	 rcx, rbx
  0035d	4c 89 b3 48 01
	01 00		 mov	 QWORD PTR [rbx+65864], r14
  00364	48 89 83 58 01
	01 00		 mov	 QWORD PTR [rbx+65880], rax
  0036b	e8 00 00 00 00	 call	 call_zseek64
  00370	85 c0		 test	 eax, eax
  00372	41 0f 45 fd	 cmovne	 edi, r13d

; 839  :     err=ZIP_ERRNO;
; 840  : 
; 841  :   return err;

  00376	8b c7		 mov	 eax, edi
  00378	eb 0e		 jmp	 SHORT $LN46@LoadCentra
$LN50@LoadCentra:

; 794  :   {
; 795  :     ZCLOSE64(pziinit->z_filefunc, pziinit->filestream);

  0037a	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0037e	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  00382	ff 53 28	 call	 QWORD PTR [rbx+40]

; 796  :     return ZIP_ERRNO;

  00385	41 8b c5	 mov	 eax, r13d
$LN46@LoadCentra:

; 842  : }

  00388	48 83 c4 38	 add	 rsp, 56			; 00000038H
  0038c	41 5f		 pop	 r15
  0038e	41 5e		 pop	 r14
  00390	41 5d		 pop	 r13
  00392	41 5c		 pop	 r12
  00394	5f		 pop	 rdi
  00395	5e		 pop	 rsi
  00396	5b		 pop	 rbx
  00397	5d		 pop	 rbp
  00398	c3		 ret	 0
LoadCentralDirectoryRecord ENDP
PUBLIC	zipCloseFileInZipRaw64
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipCloseFileInZipRaw64 DD imagerel $LN60
	DD	imagerel $LN60+1148
	DD	imagerel $unwind$zipCloseFileInZipRaw64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipCloseFileInZipRaw64 DD 0c5f01H
	DD	0b545fH
	DD	0a3453H
	DD	0c6412H
	DD	0f00e3212H
	DD	0d00ae00cH
	DD	07006c008H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipCloseFileInZipRaw64
_TEXT	SEGMENT
file$ = 80
uncompressed_size$ = 88
crc32$ = 96
zipCloseFileInZipRaw64 PROC				; COMDAT

; 1515 : {

$LN60:
  00000	48 89 74 24 18	 mov	 QWORD PTR [rsp+24], rsi
  00005	57		 push	 rdi
  00006	41 54		 push	 r12
  00008	41 55		 push	 r13
  0000a	41 56		 push	 r14
  0000c	41 57		 push	 r15
  0000e	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 1516 :     zip64_internal* zi;
; 1517 :     ZPOS64_T compressed_size;
; 1518 :     uLong invalidValue = 0xffffffff;
; 1519 :     short datasize = 0;

  00012	45 33 ff	 xor	 r15d, r15d
  00015	45 8b f0	 mov	 r14d, r8d
  00018	4c 8b e2	 mov	 r12, rdx
  0001b	48 8b f9	 mov	 rdi, rcx
  0001e	45 0f b7 ef	 movzx	 r13d, r15w

; 1520 :     int err=ZIP_OK;

  00022	41 8b f7	 mov	 esi, r15d

; 1521 : 
; 1522 :     if (file == NULL)

  00025	48 85 c9	 test	 rcx, rcx
  00028	75 18		 jne	 SHORT $LN45@zipCloseFi
$LN59@zipCloseFi:

; 1523 :         return ZIP_PARAMERROR;

  0002a	b8 9a ff ff ff	 mov	 eax, -102		; ffffffffffffff9aH

; 1748 : }

  0002f	48 8b 74 24 60	 mov	 rsi, QWORD PTR [rsp+96]
  00034	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00038	41 5f		 pop	 r15
  0003a	41 5e		 pop	 r14
  0003c	41 5d		 pop	 r13
  0003e	41 5c		 pop	 r12
  00040	5f		 pop	 rdi
  00041	c3		 ret	 0
$LN45@zipCloseFi:

; 1524 :     zi = (zip64_internal*)file;
; 1525 : 
; 1526 :     if (zi->in_opened_file_inzip == 0)

  00042	39 71 70	 cmp	 DWORD PTR [rcx+112], esi

; 1527 :         return ZIP_PARAMERROR;

  00045	74 e3		 je	 SHORT $LN59@zipCloseFi

; 1528 :     zi->ci.stream.avail_in = 0;
; 1529 : 
; 1530 :     if ((zi->ci.method == Z_DEFLATED) && (!zi->ci.raw))

  00047	83 b9 f8 00 00
	00 08		 cmp	 DWORD PTR [rcx+248], 8
  0004e	48 89 5c 24 50	 mov	 QWORD PTR [rsp+80], rbx
  00053	44 89 b9 80 00
	00 00		 mov	 DWORD PTR [rcx+128], r15d
  0005a	48 89 6c 24 58	 mov	 QWORD PTR [rsp+88], rbp
  0005f	75 67		 jne	 SHORT $LN36@zipCloseFi
  00061	39 b1 fc 00 00
	00		 cmp	 DWORD PTR [rcx+252], esi
  00067	75 5f		 jne	 SHORT $LN36@zipCloseFi
  00069	0f 1f 80 00 00
	00 00		 npad	 7
$LL42@zipCloseFi:

; 1531 :                 {
; 1532 :                         while (err==ZIP_OK)
; 1533 :                         {
; 1534 :                                 uLong uTotalOutBefore;
; 1535 :                                 if (zi->ci.stream.avail_out == 0)

  00070	44 39 bf 90 00
	00 00		 cmp	 DWORD PTR [rdi+144], r15d
  00077	75 20		 jne	 SHORT $LN40@zipCloseFi

; 1536 :                                 {
; 1537 :                                         if (zip64FlushWriteBuffer(zi) == ZIP_ERRNO)

  00079	48 8b cf	 mov	 rcx, rdi
  0007c	e8 00 00 00 00	 call	 zip64FlushWriteBuffer

; 1538 :                                                 err = ZIP_ERRNO;
; 1539 :                                         zi->ci.stream.avail_out = (uInt)Z_BUFSIZE;
; 1540 :                                         zi->ci.stream.next_out = zi->ci.buffered_data;

  00081	48 8d 87 00 01
	00 00		 lea	 rax, QWORD PTR [rdi+256]
  00088	c7 87 90 00 00
	00 00 00 01 00	 mov	 DWORD PTR [rdi+144], 65536 ; 00010000H
  00092	48 89 87 88 00
	00 00		 mov	 QWORD PTR [rdi+136], rax
$LN40@zipCloseFi:

; 1541 :                                 }
; 1542 :                                 uTotalOutBefore = zi->ci.stream.total_out;

  00099	8b 9f 94 00 00
	00		 mov	 ebx, DWORD PTR [rdi+148]

; 1543 :                                 err=deflate(&zi->ci.stream,  Z_FINISH);

  0009f	48 8d 4f 78	 lea	 rcx, QWORD PTR [rdi+120]
  000a3	ba 04 00 00 00	 mov	 edx, 4
  000a8	e8 00 00 00 00	 call	 deflate
  000ad	8b f0		 mov	 esi, eax

; 1544 :                                 zi->ci.pos_in_buffered_data += (uInt)(zi->ci.stream.total_out - uTotalOutBefore) ;

  000af	8b 87 94 00 00
	00		 mov	 eax, DWORD PTR [rdi+148]
  000b5	2b c3		 sub	 eax, ebx
  000b7	01 87 d4 00 00
	00		 add	 DWORD PTR [rdi+212], eax
  000bd	85 f6		 test	 esi, esi
  000bf	74 af		 je	 SHORT $LL42@zipCloseFi

; 1545 :                         }
; 1546 :                 }
; 1547 :     else if ((zi->ci.method == Z_BZIP2ED) && (!zi->ci.raw))
; 1548 :     {
; 1549 : #ifdef HAVE_BZIP2
; 1550 :       err = BZ_FINISH_OK;
; 1551 :       while (err==BZ_FINISH_OK)
; 1552 :       {
; 1553 :         uLong uTotalOutBefore;
; 1554 :         if (zi->ci.bstream.avail_out == 0)
; 1555 :         {
; 1556 :           if (zip64FlushWriteBuffer(zi) == ZIP_ERRNO)
; 1557 :             err = ZIP_ERRNO;
; 1558 :           zi->ci.bstream.avail_out = (uInt)Z_BUFSIZE;
; 1559 :           zi->ci.bstream.next_out = (char*)zi->ci.buffered_data;
; 1560 :         }
; 1561 :         uTotalOutBefore = zi->ci.bstream.total_out_lo32;
; 1562 :         err=BZ2_bzCompress(&zi->ci.bstream,  BZ_FINISH);
; 1563 :         if(err == BZ_STREAM_END)
; 1564 :           err = Z_STREAM_END;
; 1565 : 
; 1566 :         zi->ci.pos_in_buffered_data += (uInt)(zi->ci.bstream.total_out_lo32 - uTotalOutBefore);
; 1567 :       }
; 1568 : 
; 1569 :       if(err == BZ_FINISH_OK)
; 1570 :         err = ZIP_OK;
; 1571 : #endif
; 1572 :     }
; 1573 : 
; 1574 :     if (err==Z_STREAM_END)

  000c1	83 fe 01	 cmp	 esi, 1
  000c4	41 0f 44 f7	 cmove	 esi, r15d
$LN36@zipCloseFi:

; 1575 :         err=ZIP_OK; /* this is normal */
; 1576 : 
; 1577 :     if ((zi->ci.pos_in_buffered_data>0) && (err==ZIP_OK))

  000c8	83 cb ff	 or	 ebx, -1
  000cb	44 39 bf d4 00
	00 00		 cmp	 DWORD PTR [rdi+212], r15d
  000d2	76 11		 jbe	 SHORT $LN34@zipCloseFi
  000d4	85 f6		 test	 esi, esi
  000d6	75 0d		 jne	 SHORT $LN34@zipCloseFi

; 1578 :                 {
; 1579 :         if (zip64FlushWriteBuffer(zi)==ZIP_ERRNO)

  000d8	48 8b cf	 mov	 rcx, rdi
  000db	e8 00 00 00 00	 call	 zip64FlushWriteBuffer
  000e0	3b c3		 cmp	 eax, ebx
  000e2	0f 44 f3	 cmove	 esi, ebx
$LN34@zipCloseFi:

; 1580 :             err = ZIP_ERRNO;
; 1581 :                 }
; 1582 : 
; 1583 :     if ((zi->ci.method == Z_DEFLATED) && (!zi->ci.raw))

  000e5	83 bf f8 00 00
	00 08		 cmp	 DWORD PTR [rdi+248], 8
  000ec	75 1e		 jne	 SHORT $LN33@zipCloseFi
  000ee	44 39 bf fc 00
	00 00		 cmp	 DWORD PTR [rdi+252], r15d
  000f5	75 2c		 jne	 SHORT $LN31@zipCloseFi

; 1584 :     {
; 1585 :         int tmp_err = deflateEnd(&zi->ci.stream);

  000f7	48 8d 4f 78	 lea	 rcx, QWORD PTR [rdi+120]
  000fb	e8 00 00 00 00	 call	 deflateEnd

; 1586 :         if (err == ZIP_OK)

  00100	85 f6		 test	 esi, esi

; 1587 :             err = tmp_err;
; 1588 :         zi->ci.stream_initialised = 0;

  00102	44 89 bf d0 00
	00 00		 mov	 DWORD PTR [rdi+208], r15d
  00109	0f 44 f0	 cmove	 esi, eax
$LN33@zipCloseFi:

; 1589 :     }
; 1590 : #ifdef HAVE_BZIP2
; 1591 :     else if((zi->ci.method == Z_BZIP2ED) && (!zi->ci.raw))
; 1592 :     {
; 1593 :       int tmperr = BZ2_bzCompressEnd(&zi->ci.bstream);
; 1594 :                         if (err==ZIP_OK)
; 1595 :                                 err = tmperr;
; 1596 :                         zi->ci.stream_initialised = 0;
; 1597 :     }
; 1598 : #endif
; 1599 : 
; 1600 :     if (!zi->ci.raw)

  0010c	44 39 bf fc 00
	00 00		 cmp	 DWORD PTR [rdi+252], r15d
  00113	75 0e		 jne	 SHORT $LN31@zipCloseFi

; 1601 :     {
; 1602 :         crc32 = (uLong)zi->ci.crc32;

  00115	44 8b b7 04 01
	01 00		 mov	 r14d, DWORD PTR [rdi+65796]

; 1603 :         uncompressed_size = zi->ci.totalUncompressedData;

  0011c	4c 8b a7 20 01
	01 00		 mov	 r12, QWORD PTR [rdi+65824]
$LN31@zipCloseFi:

; 1604 :     }
; 1605 :     compressed_size = zi->ci.totalCompressedData;
; 1606 : 
; 1607 : #    ifndef NOCRYPT
; 1608 :     compressed_size += zi->ci.crypt_header_size;

  00123	48 63 9f 40 01
	01 00		 movsxd	 rbx, DWORD PTR [rdi+65856]

; 1609 : #    endif
; 1610 : 
; 1611 :     // update Current Item crc and sizes,
; 1612 :     if(compressed_size >= 0xffffffff || uncompressed_size >= 0xffffffff || zi->ci.pos_local_header >= 0xffffffff)

  0012a	bd ff ff ff ff	 mov	 ebp, -1			; ffffffffH
  0012f	48 03 9f 18 01
	01 00		 add	 rbx, QWORD PTR [rdi+65816]
  00136	48 3b dd	 cmp	 rbx, rbp
  00139	73 0e		 jae	 SHORT $LN29@zipCloseFi
  0013b	4c 3b e5	 cmp	 r12, rbp
  0013e	73 09		 jae	 SHORT $LN29@zipCloseFi
  00140	48 39 af d8 00
	00 00		 cmp	 QWORD PTR [rdi+216], rbp
  00147	72 32		 jb	 SHORT $LN30@zipCloseFi
$LN29@zipCloseFi:

; 1613 :     {
; 1614 :       /*version Made by*/
; 1615 :       zip64local_putValue_inmemory(zi->ci.central_header+4,(uLong)45,2);

  00149	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  00150	ba 2d 00 00 00	 mov	 edx, 45			; 0000002dH
  00155	44 8d 42 d5	 lea	 r8d, QWORD PTR [rdx-43]
  00159	48 83 c1 04	 add	 rcx, 4
  0015d	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1616 :       /*version needed*/
; 1617 :       zip64local_putValue_inmemory(zi->ci.central_header+6,(uLong)45,2);

  00162	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  00169	ba 2d 00 00 00	 mov	 edx, 45			; 0000002dH
  0016e	44 8d 42 d5	 lea	 r8d, QWORD PTR [rdx-43]
  00172	48 83 c1 06	 add	 rcx, 6
  00176	e8 00 00 00 00	 call	 zip64local_putValue_inmemory
$LN30@zipCloseFi:

; 1618 : 
; 1619 :     }
; 1620 : 
; 1621 :     zip64local_putValue_inmemory(zi->ci.central_header+16,crc32,4); /*crc*/

  0017b	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  00182	41 b8 04 00 00
	00		 mov	 r8d, 4
  00188	41 8b d6	 mov	 edx, r14d
  0018b	48 83 c1 10	 add	 rcx, 16
  0018f	45 8b fe	 mov	 r15d, r14d
  00192	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1622 : 
; 1623 : 
; 1624 :     if(compressed_size >= 0xffffffff)
; 1625 :       zip64local_putValue_inmemory(zi->ci.central_header+20, invalidValue,4); /*compr size*/

  00197	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  0019e	41 b8 04 00 00
	00		 mov	 r8d, 4
  001a4	48 83 c1 14	 add	 rcx, 20
  001a8	48 8b d5	 mov	 rdx, rbp
  001ab	48 3b dd	 cmp	 rbx, rbp
  001ae	73 03		 jae	 SHORT $LN57@zipCloseFi

; 1626 :     else
; 1627 :       zip64local_putValue_inmemory(zi->ci.central_header+20, compressed_size,4); /*compr size*/

  001b0	48 8b d3	 mov	 rdx, rbx
$LN57@zipCloseFi:
  001b3	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1628 : 
; 1629 :     /// set internal file attributes field
; 1630 :     if (zi->ci.stream.data_type == Z_ASCII)

  001b8	83 bf c0 00 00
	00 01		 cmp	 DWORD PTR [rdi+192], 1
  001bf	75 19		 jne	 SHORT $LN26@zipCloseFi

; 1631 :         zip64local_putValue_inmemory(zi->ci.central_header+36,(uLong)Z_ASCII,2);

  001c1	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  001c8	ba 01 00 00 00	 mov	 edx, 1
  001cd	44 8d 42 01	 lea	 r8d, QWORD PTR [rdx+1]
  001d1	48 83 c1 24	 add	 rcx, 36			; 00000024H
  001d5	e8 00 00 00 00	 call	 zip64local_putValue_inmemory
$LN26@zipCloseFi:

; 1632 : 
; 1633 :     if(uncompressed_size >= 0xffffffff)
; 1634 :       zip64local_putValue_inmemory(zi->ci.central_header+24, invalidValue,4); /*uncompr size*/

  001da	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  001e1	41 b8 04 00 00
	00		 mov	 r8d, 4
  001e7	48 8b d5	 mov	 rdx, rbp
  001ea	48 83 c1 18	 add	 rcx, 24
  001ee	4c 3b e5	 cmp	 r12, rbp
  001f1	73 03		 jae	 SHORT $LN58@zipCloseFi

; 1635 :     else
; 1636 :       zip64local_putValue_inmemory(zi->ci.central_header+24, uncompressed_size,4); /*uncompr size*/

  001f3	49 8b d4	 mov	 rdx, r12
$LN58@zipCloseFi:
  001f6	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1637 : 
; 1638 :     // Add ZIP64 extra info field for uncompressed size
; 1639 :     if(uncompressed_size >= 0xffffffff)

  001fb	4c 3b e5	 cmp	 r12, rbp
  001fe	72 06		 jb	 SHORT $LN23@zipCloseFi

; 1640 :       datasize += 8;

  00200	41 bd 08 00 00
	00		 mov	 r13d, 8
$LN23@zipCloseFi:

; 1641 : 
; 1642 :     // Add ZIP64 extra info field for compressed size
; 1643 :     if(compressed_size >= 0xffffffff)

  00206	48 3b dd	 cmp	 rbx, rbp
  00209	72 05		 jb	 SHORT $LN22@zipCloseFi

; 1644 :       datasize += 8;

  0020b	66 41 83 c5 08	 add	 r13w, 8
$LN22@zipCloseFi:

; 1645 : 
; 1646 :     // Add ZIP64 extra info field for relative offset to local file header of current file
; 1647 :     if(zi->ci.pos_local_header >= 0xffffffff)

  00210	48 39 af d8 00
	00 00		 cmp	 QWORD PTR [rdi+216], rbp
  00217	72 05		 jb	 SHORT $LN21@zipCloseFi

; 1648 :       datasize += 8;

  00219	66 41 83 c5 08	 add	 r13w, 8
$LN21@zipCloseFi:

; 1649 : 
; 1650 :     if(datasize > 0)

  0021e	66 45 85 ed	 test	 r13w, r13w
  00222	0f 8e e3 00 00
	00		 jle	 $LN53@zipCloseFi

; 1651 :     {
; 1652 :       char* p = NULL;
; 1653 : 
; 1654 :       if((uLong)(datasize + 4) > zi->ci.size_centralExtraFree)

  00228	45 0f bf f5	 movsx	 r14d, r13w
  0022c	41 8d 46 04	 lea	 eax, DWORD PTR [r14+4]
  00230	3b 87 f0 00 00
	00		 cmp	 eax, DWORD PTR [rdi+240]
  00236	76 0a		 jbe	 SHORT $LN19@zipCloseFi

; 1655 :       {
; 1656 :         // we can not write more data to the buffer that we have room for.
; 1657 :         return ZIP_BADZIPFILE;

  00238	b8 99 ff ff ff	 mov	 eax, -103		; ffffffffffffff99H
  0023d	e9 1d 02 00 00	 jmp	 $LN55@zipCloseFi
$LN19@zipCloseFi:

; 1658 :       }
; 1659 : 
; 1660 :       p = zi->ci.central_header + zi->ci.size_centralheader;

  00242	8b af ec 00 00
	00		 mov	 ebp, DWORD PTR [rdi+236]

; 1661 : 
; 1662 :       // Add Extra Information Header for 'ZIP64 information'
; 1663 :       zip64local_putValue_inmemory(p, 0x0001, 2); // HeaderID

  00248	ba 01 00 00 00	 mov	 edx, 1
  0024d	48 03 af e0 00
	00 00		 add	 rbp, QWORD PTR [rdi+224]
  00254	44 8d 42 01	 lea	 r8d, QWORD PTR [rdx+1]
  00258	48 8b cd	 mov	 rcx, rbp
  0025b	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1664 :       p += 2;
; 1665 :       zip64local_putValue_inmemory(p, datasize, 2); // DataSize

  00260	48 8d 4d 02	 lea	 rcx, QWORD PTR [rbp+2]
  00264	49 0f bf d5	 movsx	 rdx, r13w
  00268	41 b8 02 00 00
	00		 mov	 r8d, 2
  0026e	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1666 :       p += 2;
; 1667 : 
; 1668 :       if(uncompressed_size >= 0xffffffff)

  00273	41 bd ff ff ff
	ff		 mov	 r13d, -1		; ffffffffH
  00279	48 83 c5 04	 add	 rbp, 4
  0027d	4d 3b e5	 cmp	 r12, r13
  00280	72 15		 jb	 SHORT $LN18@zipCloseFi

; 1669 :       {
; 1670 :         zip64local_putValue_inmemory(p, uncompressed_size, 8);

  00282	41 b8 08 00 00
	00		 mov	 r8d, 8
  00288	49 8b d4	 mov	 rdx, r12
  0028b	48 8b cd	 mov	 rcx, rbp
  0028e	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1671 :         p += 8;

  00293	48 83 c5 08	 add	 rbp, 8
$LN18@zipCloseFi:

; 1672 :       }
; 1673 : 
; 1674 :       if(compressed_size >= 0xffffffff)

  00297	49 3b dd	 cmp	 rbx, r13
  0029a	72 15		 jb	 SHORT $LN17@zipCloseFi

; 1675 :       {
; 1676 :         zip64local_putValue_inmemory(p, compressed_size, 8);

  0029c	41 b8 08 00 00
	00		 mov	 r8d, 8
  002a2	48 8b d3	 mov	 rdx, rbx
  002a5	48 8b cd	 mov	 rcx, rbp
  002a8	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1677 :         p += 8;

  002ad	48 83 c5 08	 add	 rbp, 8
$LN17@zipCloseFi:

; 1678 :       }
; 1679 : 
; 1680 :       if(zi->ci.pos_local_header >= 0xffffffff)

  002b1	48 8b 97 d8 00
	00 00		 mov	 rdx, QWORD PTR [rdi+216]
  002b8	49 3b d5	 cmp	 rdx, r13
  002bb	72 0e		 jb	 SHORT $LN16@zipCloseFi

; 1681 :       {
; 1682 :         zip64local_putValue_inmemory(p, zi->ci.pos_local_header, 8);

  002bd	41 b8 08 00 00
	00		 mov	 r8d, 8
  002c3	48 8b cd	 mov	 rcx, rbp
  002c6	e8 00 00 00 00	 call	 zip64local_putValue_inmemory
$LN16@zipCloseFi:

; 1683 :         p += 8;
; 1684 :       }
; 1685 : 
; 1686 :       // Update how much extra free space we got in the memory buffer
; 1687 :       // and increase the centralheader size so the new ZIP64 fields are included
; 1688 :       // ( 4 below is the size of HeaderID and DataSize field )
; 1689 :       zi->ci.size_centralExtraFree -= datasize + 4;
; 1690 :       zi->ci.size_centralheader += datasize + 4;
; 1691 : 
; 1692 :       // Update the extra info size field
; 1693 :       zi->ci.size_centralExtra += datasize + 4;
; 1694 :       zip64local_putValue_inmemory(zi->ci.central_header+30,(uLong)zi->ci.size_centralExtra,2);

  002cb	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  002d2	b8 fc ff ff ff	 mov	 eax, -4			; fffffffcH
  002d7	41 b8 02 00 00
	00		 mov	 r8d, 2
  002dd	41 2b c6	 sub	 eax, r14d
  002e0	48 83 c1 1e	 add	 rcx, 30
  002e4	01 87 f0 00 00
	00		 add	 DWORD PTR [rdi+240], eax
  002ea	41 8d 46 04	 lea	 eax, DWORD PTR [r14+4]
  002ee	01 87 ec 00 00
	00		 add	 DWORD PTR [rdi+236], eax
  002f4	41 8d 46 04	 lea	 eax, DWORD PTR [r14+4]
  002f8	01 87 e8 00 00
	00		 add	 DWORD PTR [rdi+232], eax
  002fe	8b 97 e8 00 00
	00		 mov	 edx, DWORD PTR [rdi+232]
  00304	e8 00 00 00 00	 call	 zip64local_putValue_inmemory
  00309	eb 06		 jmp	 SHORT $LN20@zipCloseFi
$LN53@zipCloseFi:
  0030b	41 bd ff ff ff
	ff		 mov	 r13d, -1		; ffffffffH
$LN20@zipCloseFi:

; 1695 :     }
; 1696 : 
; 1697 :     if (err==ZIP_OK)

  00311	85 f6		 test	 esi, esi
  00313	75 19		 jne	 SHORT $LN15@zipCloseFi

; 1698 :         err = add_data_in_datablock(&zi->central_dir, zi->ci.central_header, (uLong)zi->ci.size_centralheader);

  00315	44 8b 87 ec 00
	00 00		 mov	 r8d, DWORD PTR [rdi+236]
  0031c	48 8b 97 e0 00
	00 00		 mov	 rdx, QWORD PTR [rdi+224]
  00323	48 8d 4f 60	 lea	 rcx, QWORD PTR [rdi+96]
  00327	e8 00 00 00 00	 call	 add_data_in_datablock
  0032c	8b f0		 mov	 esi, eax
$LN15@zipCloseFi:

; 1699 : 
; 1700 :     free(zi->ci.central_header);

  0032e	48 8b 8f e0 00
	00 00		 mov	 rcx, QWORD PTR [rdi+224]
  00335	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free

; 1701 : 
; 1702 :     if (err==ZIP_OK)

  0033b	85 f6		 test	 esi, esi
  0033d	0f 85 0c 01 00
	00		 jne	 $LN1@zipCloseFi

; 1703 :     {
; 1704 :         // Update the LocalFileHeader with the new values.
; 1705 : 
; 1706 :         ZPOS64_T cur_pos_inzip = ZTELL64(zi->z_filefunc,zi->filestream);

  00343	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  00347	48 8b cf	 mov	 rcx, rdi
  0034a	e8 00 00 00 00	 call	 call_ztell64

; 1707 : 
; 1708 :         if (ZSEEK64(zi->z_filefunc,zi->filestream, zi->ci.pos_local_header + 14,ZLIB_FILEFUNC_SEEK_SET)!=0)

  0034f	4c 8b 87 d8 00
	00 00		 mov	 r8, QWORD PTR [rdi+216]
  00356	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  0035a	49 83 c0 0e	 add	 r8, 14
  0035e	45 33 c9	 xor	 r9d, r9d
  00361	48 8b cf	 mov	 rcx, rdi
  00364	48 8b e8	 mov	 rbp, rax
  00367	e8 00 00 00 00	 call	 call_zseek64
  0036c	85 c0		 test	 eax, eax
  0036e	74 09		 je	 SHORT $LN51@zipCloseFi

; 1709 :             err = ZIP_ERRNO;

  00370	41 83 ce ff	 or	 r14d, -1
  00374	41 8b f6	 mov	 esi, r14d

; 1710 : 
; 1711 :         if (err==ZIP_OK)

  00377	eb 1b		 jmp	 SHORT $LN12@zipCloseFi
$LN51@zipCloseFi:

; 1712 :             err = zip64local_putValue(&zi->z_filefunc,zi->filestream,crc32,4); /* crc 32, unknown */

  00379	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  0037d	41 b9 04 00 00
	00		 mov	 r9d, 4
  00383	4d 8b c7	 mov	 r8, r15
  00386	48 8b cf	 mov	 rcx, rdi
  00389	e8 00 00 00 00	 call	 zip64local_putValue
  0038e	41 83 ce ff	 or	 r14d, -1
  00392	8b f0		 mov	 esi, eax
$LN12@zipCloseFi:

; 1713 : 
; 1714 :         if(uncompressed_size >= 0xffffffff || compressed_size >= 0xffffffff )

  00394	4d 3b e5	 cmp	 r12, r13
  00397	73 3d		 jae	 SHORT $LN10@zipCloseFi
  00399	49 3b dd	 cmp	 rbx, r13
  0039c	73 38		 jae	 SHORT $LN10@zipCloseFi

; 1730 :         }
; 1731 :         else
; 1732 :         {
; 1733 :           if (err==ZIP_OK) /* compressed size, unknown */

  0039e	85 f6		 test	 esi, esi
  003a0	0f 85 91 00 00
	00		 jne	 $LN5@zipCloseFi

; 1734 :               err = zip64local_putValue(&zi->z_filefunc,zi->filestream,compressed_size,4);

  003a6	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  003aa	44 8d 4e 04	 lea	 r9d, QWORD PTR [rsi+4]
  003ae	4c 8b c3	 mov	 r8, rbx
  003b1	48 8b cf	 mov	 rcx, rdi
  003b4	e8 00 00 00 00	 call	 zip64local_putValue
  003b9	8b f0		 mov	 esi, eax

; 1735 : 
; 1736 :           if (err==ZIP_OK) /* uncompressed size, unknown */

  003bb	85 c0		 test	 eax, eax
  003bd	75 78		 jne	 SHORT $LN5@zipCloseFi

; 1737 :               err = zip64local_putValue(&zi->z_filefunc,zi->filestream,uncompressed_size,4);

  003bf	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  003c3	44 8d 48 04	 lea	 r9d, QWORD PTR [rax+4]
  003c7	4d 8b c4	 mov	 r8, r12
  003ca	48 8b cf	 mov	 rcx, rdi
  003cd	e8 00 00 00 00	 call	 zip64local_putValue
  003d2	8b f0		 mov	 esi, eax
  003d4	eb 61		 jmp	 SHORT $LN5@zipCloseFi
$LN10@zipCloseFi:

; 1715 :         {
; 1716 :           if(zi->ci.pos_zip64extrainfo > 0)

  003d6	4c 8b 87 10 01
	01 00		 mov	 r8, QWORD PTR [rdi+65808]
  003dd	4d 85 c0	 test	 r8, r8
  003e0	74 50		 je	 SHORT $LN9@zipCloseFi

; 1717 :           {
; 1718 :             // Update the size in the ZIP64 extended field.
; 1719 :             if (ZSEEK64(zi->z_filefunc,zi->filestream, zi->ci.pos_zip64extrainfo + 4,ZLIB_FILEFUNC_SEEK_SET)!=0)

  003e2	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  003e6	49 83 c0 04	 add	 r8, 4
  003ea	45 33 c9	 xor	 r9d, r9d
  003ed	48 8b cf	 mov	 rcx, rdi
  003f0	e8 00 00 00 00	 call	 call_zseek64
  003f5	85 c0		 test	 eax, eax
  003f7	74 05		 je	 SHORT $LN8@zipCloseFi

; 1720 :               err = ZIP_ERRNO;

  003f9	41 8b f6	 mov	 esi, r14d

; 1721 : 
; 1722 :             if (err==ZIP_OK) /* compressed size, unknown */

  003fc	eb 39		 jmp	 SHORT $LN5@zipCloseFi
$LN8@zipCloseFi:
  003fe	85 f6		 test	 esi, esi
  00400	75 35		 jne	 SHORT $LN5@zipCloseFi

; 1723 :               err = zip64local_putValue(&zi->z_filefunc, zi->filestream, uncompressed_size, 8);

  00402	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  00406	44 8d 4e 08	 lea	 r9d, QWORD PTR [rsi+8]
  0040a	4d 8b c4	 mov	 r8, r12
  0040d	48 8b cf	 mov	 rcx, rdi
  00410	e8 00 00 00 00	 call	 zip64local_putValue
  00415	8b f0		 mov	 esi, eax

; 1724 : 
; 1725 :             if (err==ZIP_OK) /* uncompressed size, unknown */

  00417	85 c0		 test	 eax, eax
  00419	75 1c		 jne	 SHORT $LN5@zipCloseFi

; 1726 :               err = zip64local_putValue(&zi->z_filefunc, zi->filestream, compressed_size, 8);

  0041b	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  0041f	44 8d 48 08	 lea	 r9d, QWORD PTR [rax+8]
  00423	4c 8b c3	 mov	 r8, rbx
  00426	48 8b cf	 mov	 rcx, rdi
  00429	e8 00 00 00 00	 call	 zip64local_putValue
  0042e	8b f0		 mov	 esi, eax

; 1727 :           }
; 1728 :           else

  00430	eb 05		 jmp	 SHORT $LN5@zipCloseFi
$LN9@zipCloseFi:

; 1729 :               err = ZIP_BADZIPFILE; // Caller passed zip64 = 0, so no room for zip64 info -> fatal

  00432	be 99 ff ff ff	 mov	 esi, -103		; ffffffffffffff99H
$LN5@zipCloseFi:

; 1738 :         }
; 1739 : 
; 1740 :         if (ZSEEK64(zi->z_filefunc,zi->filestream, cur_pos_inzip,ZLIB_FILEFUNC_SEEK_SET)!=0)

  00437	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  0043b	45 33 c9	 xor	 r9d, r9d
  0043e	4c 8b c5	 mov	 r8, rbp
  00441	48 8b cf	 mov	 rcx, rdi
  00444	e8 00 00 00 00	 call	 call_zseek64
  00449	85 c0		 test	 eax, eax
  0044b	41 0f 45 f6	 cmovne	 esi, r14d
$LN1@zipCloseFi:

; 1741 :             err = ZIP_ERRNO;
; 1742 :     }
; 1743 : 
; 1744 :     zi->number_entry ++;

  0044f	48 ff 87 58 01
	01 00		 inc	 QWORD PTR [rdi+65880]

; 1745 :     zi->in_opened_file_inzip = 0;

  00456	c7 47 70 00 00
	00 00		 mov	 DWORD PTR [rdi+112], 0

; 1746 : 
; 1747 :     return err;

  0045d	8b c6		 mov	 eax, esi
$LN55@zipCloseFi:

; 1748 : }

  0045f	48 8b 5c 24 50	 mov	 rbx, QWORD PTR [rsp+80]
  00464	48 8b 6c 24 58	 mov	 rbp, QWORD PTR [rsp+88]
  00469	48 8b 74 24 60	 mov	 rsi, QWORD PTR [rsp+96]
  0046e	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00472	41 5f		 pop	 r15
  00474	41 5e		 pop	 r14
  00476	41 5d		 pop	 r13
  00478	41 5c		 pop	 r12
  0047a	5f		 pop	 rdi
  0047b	c3		 ret	 0
zipCloseFileInZipRaw64 ENDP
_TEXT	ENDS
PUBLIC	zipCloseFileInZipRaw
; Function compile flags: /Ogtpy
;	COMDAT zipCloseFileInZipRaw
_TEXT	SEGMENT
file$ = 8
uncompressed_size$ = 16
crc32$ = 24
zipCloseFileInZipRaw PROC				; COMDAT

; 1511 :     return zipCloseFileInZipRaw64 (file, uncompressed_size, crc32);

  00000	8b d2		 mov	 edx, edx

; 1512 : }

  00002	e9 00 00 00 00	 jmp	 zipCloseFileInZipRaw64
zipCloseFileInZipRaw ENDP
_TEXT	ENDS
PUBLIC	zipWriteInFileInZip
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipWriteInFileInZip DD imagerel $LN24
	DD	imagerel $LN24+57
	DD	imagerel $unwind$zipWriteInFileInZip
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$zipWriteInFileInZip DD imagerel $LN24+57
	DD	imagerel $LN24+207
	DD	imagerel $chain$0$zipWriteInFileInZip
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$1$zipWriteInFileInZip DD imagerel $LN24+207
	DD	imagerel $LN24+228
	DD	imagerel $chain$1$zipWriteInFileInZip
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$2$zipWriteInFileInZip DD imagerel $LN24+228
	DD	imagerel $LN24+334
	DD	imagerel $chain$2$zipWriteInFileInZip
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$2$zipWriteInFileInZip DD 020021H
	DD	06c400H
	DD	imagerel $LN24
	DD	imagerel $LN24+57
	DD	imagerel $unwind$zipWriteInFileInZip
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$1$zipWriteInFileInZip DD 021H
	DD	imagerel $LN24
	DD	imagerel $LN24+57
	DD	imagerel $unwind$zipWriteInFileInZip
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$zipWriteInFileInZip DD 020521H
	DD	06c405H
	DD	imagerel $LN24
	DD	imagerel $LN24+57
	DD	imagerel $unwind$zipWriteInFileInZip
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipWriteInFileInZip DD 081401H
	DD	096414H
	DD	085414H
	DD	073414H
	DD	070103214H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipWriteInFileInZip
_TEXT	SEGMENT
file$ = 48
buf$ = 56
len$ = 64
zipWriteInFileInZip PROC				; COMDAT

; 1403 : {

$LN24:
  00000	48 89 5c 24 10	 mov	 QWORD PTR [rsp+16], rbx
  00005	48 89 6c 24 18	 mov	 QWORD PTR [rsp+24], rbp
  0000a	48 89 74 24 20	 mov	 QWORD PTR [rsp+32], rsi
  0000f	57		 push	 rdi
  00010	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 1404 :     zip64_internal* zi;
; 1405 :     int err=ZIP_OK;

  00014	33 ed		 xor	 ebp, ebp
  00016	41 8b d8	 mov	 ebx, r8d
  00019	48 8b f2	 mov	 rsi, rdx
  0001c	48 8b f9	 mov	 rdi, rcx

; 1406 : 
; 1407 :     if (file == NULL)

  0001f	48 85 c9	 test	 rcx, rcx
  00022	75 0a		 jne	 SHORT $LN15@zipWriteIn
$LN23@zipWriteIn:

; 1408 :         return ZIP_PARAMERROR;

  00024	b8 9a ff ff ff	 mov	 eax, -102		; ffffffffffffff9aH
  00029	e9 a1 00 00 00	 jmp	 $LN16@zipWriteIn
$LN15@zipWriteIn:

; 1409 :     zi = (zip64_internal*)file;
; 1410 : 
; 1411 :     if (zi->in_opened_file_inzip == 0)

  0002e	39 69 70	 cmp	 DWORD PTR [rcx+112], ebp

; 1412 :         return ZIP_PARAMERROR;

  00031	74 f1		 je	 SHORT $LN23@zipWriteIn

; 1413 : 
; 1414 :     zi->ci.crc32 = crc32(zi->ci.crc32,buf,(uInt)len);

  00033	8b 89 04 01 01
	00		 mov	 ecx, DWORD PTR [rcx+65796]
  00039	4c 89 64 24 30	 mov	 QWORD PTR [rsp+48], r12
  0003e	e8 00 00 00 00	 call	 crc32

; 1415 : 
; 1416 : #ifdef HAVE_BZIP2
; 1417 :     if(zi->ci.method == Z_BZIP2ED && (!zi->ci.raw))
; 1418 :     {
; 1419 :       zi->ci.bstream.next_in = (void*)buf;
; 1420 :       zi->ci.bstream.avail_in = len;
; 1421 :       err = BZ_RUN_OK;
; 1422 : 
; 1423 :       while ((err==BZ_RUN_OK) && (zi->ci.bstream.avail_in>0))
; 1424 :       {
; 1425 :         if (zi->ci.bstream.avail_out == 0)
; 1426 :         {
; 1427 :           if (zip64FlushWriteBuffer(zi) == ZIP_ERRNO)
; 1428 :             err = ZIP_ERRNO;
; 1429 :           zi->ci.bstream.avail_out = (uInt)Z_BUFSIZE;
; 1430 :           zi->ci.bstream.next_out = (char*)zi->ci.buffered_data;
; 1431 :         }
; 1432 : 
; 1433 : 
; 1434 :         if(err != BZ_RUN_OK)
; 1435 :           break;
; 1436 : 
; 1437 :         if ((zi->ci.method == Z_BZIP2ED) && (!zi->ci.raw))
; 1438 :         {
; 1439 :           uLong uTotalOutBefore_lo = zi->ci.bstream.total_out_lo32;
; 1440 : //          uLong uTotalOutBefore_hi = zi->ci.bstream.total_out_hi32;
; 1441 :           err=BZ2_bzCompress(&zi->ci.bstream,  BZ_RUN);
; 1442 : 
; 1443 :           zi->ci.pos_in_buffered_data += (uInt)(zi->ci.bstream.total_out_lo32 - uTotalOutBefore_lo) ;
; 1444 :         }
; 1445 :       }
; 1446 : 
; 1447 :       if(err == BZ_RUN_OK)
; 1448 :         err = ZIP_OK;
; 1449 :     }
; 1450 :     else
; 1451 : #endif
; 1452 :     {
; 1453 :       zi->ci.stream.next_in = (Bytef*)buf;

  00043	48 89 77 78	 mov	 QWORD PTR [rdi+120], rsi

; 1454 :       zi->ci.stream.avail_in = len;

  00047	89 9f 80 00 00
	00		 mov	 DWORD PTR [rdi+128], ebx
  0004d	89 87 04 01 01
	00		 mov	 DWORD PTR [rdi+65796], eax
  00053	83 ce ff	 or	 esi, -1
$LL13@zipWriteIn:

; 1455 : 
; 1456 :       while ((err==ZIP_OK) && (zi->ci.stream.avail_in>0))

  00056	83 bf 80 00 00
	00 00		 cmp	 DWORD PTR [rdi+128], 0
  0005d	76 69		 jbe	 SHORT $LN22@zipWriteIn

; 1457 :       {
; 1458 :           if (zi->ci.stream.avail_out == 0)

  0005f	83 bf 90 00 00
	00 00		 cmp	 DWORD PTR [rdi+144], 0
  00066	75 26		 jne	 SHORT $LN11@zipWriteIn

; 1459 :           {
; 1460 :               if (zip64FlushWriteBuffer(zi) == ZIP_ERRNO)

  00068	48 8b cf	 mov	 rcx, rdi
  0006b	e8 00 00 00 00	 call	 zip64FlushWriteBuffer

; 1461 :                   err = ZIP_ERRNO;
; 1462 :               zi->ci.stream.avail_out = (uInt)Z_BUFSIZE;

  00070	c7 87 90 00 00
	00 00 00 01 00	 mov	 DWORD PTR [rdi+144], 65536 ; 00010000H
  0007a	83 f8 ff	 cmp	 eax, -1

; 1463 :               zi->ci.stream.next_out = zi->ci.buffered_data;

  0007d	48 8d 87 00 01
	00 00		 lea	 rax, QWORD PTR [rdi+256]
  00084	48 89 87 88 00
	00 00		 mov	 QWORD PTR [rdi+136], rax
  0008b	0f 44 ee	 cmove	 ebp, esi
$LN11@zipWriteIn:

; 1464 :           }
; 1465 : 
; 1466 : 
; 1467 :           if(err != ZIP_OK)

  0008e	85 ed		 test	 ebp, ebp
  00090	75 36		 jne	 SHORT $LN22@zipWriteIn

; 1468 :               break;
; 1469 : 
; 1470 :           if ((zi->ci.method == Z_DEFLATED) && (!zi->ci.raw))

  00092	83 bf f8 00 00
	00 08		 cmp	 DWORD PTR [rdi+248], 8
  00099	75 49		 jne	 SHORT $LN8@zipWriteIn
  0009b	39 af fc 00 00
	00		 cmp	 DWORD PTR [rdi+252], ebp
  000a1	75 41		 jne	 SHORT $LN8@zipWriteIn

; 1471 :           {
; 1472 :               uLong uTotalOutBefore = zi->ci.stream.total_out;

  000a3	8b 9f 94 00 00
	00		 mov	 ebx, DWORD PTR [rdi+148]

; 1473 :               err=deflate(&zi->ci.stream,  Z_NO_FLUSH);

  000a9	48 8d 4f 78	 lea	 rcx, QWORD PTR [rdi+120]
  000ad	33 d2		 xor	 edx, edx
  000af	e8 00 00 00 00	 call	 deflate

; 1474 :               if(uTotalOutBefore > zi->ci.stream.total_out)
; 1475 :               {
; 1476 :                 int bBreak = 0;
; 1477 :                 bBreak++;
; 1478 :               }
; 1479 : 
; 1480 :               zi->ci.pos_in_buffered_data += (uInt)(zi->ci.stream.total_out - uTotalOutBefore) ;

  000b4	8b 8f 94 00 00
	00		 mov	 ecx, DWORD PTR [rdi+148]
  000ba	2b cb		 sub	 ecx, ebx
  000bc	8b e8		 mov	 ebp, eax
  000be	01 8f d4 00 00
	00		 add	 DWORD PTR [rdi+212], ecx
  000c4	85 c0		 test	 eax, eax
  000c6	74 8e		 je	 SHORT $LL13@zipWriteIn
$LN22@zipWriteIn:
  000c8	4c 8b 64 24 30	 mov	 r12, QWORD PTR [rsp+48]

; 1501 :               }
; 1502 :           }
; 1503 :       }// while(...)
; 1504 :     }
; 1505 : 
; 1506 :     return err;

  000cd	8b c5		 mov	 eax, ebp
$LN16@zipWriteIn:

; 1507 : }

  000cf	48 8b 5c 24 38	 mov	 rbx, QWORD PTR [rsp+56]
  000d4	48 8b 6c 24 40	 mov	 rbp, QWORD PTR [rsp+64]
  000d9	48 8b 74 24 48	 mov	 rsi, QWORD PTR [rsp+72]
  000de	48 83 c4 20	 add	 rsp, 32			; 00000020H
  000e2	5f		 pop	 rdi
  000e3	c3		 ret	 0
$LN8@zipWriteIn:

; 1481 :           }
; 1482 :           else
; 1483 :           {
; 1484 :               uInt copy_this,i;
; 1485 :               if (zi->ci.stream.avail_in < zi->ci.stream.avail_out)

  000e4	8b 97 90 00 00
	00		 mov	 edx, DWORD PTR [rdi+144]
  000ea	8b 87 80 00 00
	00		 mov	 eax, DWORD PTR [rdi+128]
  000f0	3b c2		 cmp	 eax, edx
  000f2	0f 42 d0	 cmovb	 edx, eax

; 1486 :                   copy_this = zi->ci.stream.avail_in;
; 1487 :               else
; 1488 :                   copy_this = zi->ci.stream.avail_out;
; 1489 : 
; 1490 :               for (i = 0; i < copy_this; i++)

  000f5	85 d2		 test	 edx, edx
  000f7	74 25		 je	 SHORT $LN1@zipWriteIn
  000f9	45 33 c0	 xor	 r8d, r8d
  000fc	44 8b ca	 mov	 r9d, edx
  000ff	90		 npad	 1
$LL3@zipWriteIn:

; 1491 :                   *(((char*)zi->ci.stream.next_out)+i) =
; 1492 :                       *(((const char*)zi->ci.stream.next_in)+i);

  00100	48 8b 47 78	 mov	 rax, QWORD PTR [rdi+120]
  00104	48 8b 8f 88 00
	00 00		 mov	 rcx, QWORD PTR [rdi+136]
  0010b	49 ff c0	 inc	 r8
  0010e	49 ff c9	 dec	 r9
  00111	41 0f b6 44 00
	ff		 movzx	 eax, BYTE PTR [r8+rax-1]
  00117	41 88 44 08 ff	 mov	 BYTE PTR [r8+rcx-1], al
  0011c	75 e2		 jne	 SHORT $LL3@zipWriteIn
$LN1@zipWriteIn:

; 1493 :               {
; 1494 :                   zi->ci.stream.avail_in -= copy_this;

  0011e	29 97 80 00 00
	00		 sub	 DWORD PTR [rdi+128], edx

; 1495 :                   zi->ci.stream.avail_out-= copy_this;

  00124	29 97 90 00 00
	00		 sub	 DWORD PTR [rdi+144], edx

; 1496 :                   zi->ci.stream.next_in+= copy_this;
; 1497 :                   zi->ci.stream.next_out+= copy_this;
; 1498 :                   zi->ci.stream.total_in+= copy_this;

  0012a	01 97 84 00 00
	00		 add	 DWORD PTR [rdi+132], edx

; 1499 :                   zi->ci.stream.total_out+= copy_this;

  00130	01 97 94 00 00
	00		 add	 DWORD PTR [rdi+148], edx
  00136	8b c2		 mov	 eax, edx
  00138	48 01 47 78	 add	 QWORD PTR [rdi+120], rax
  0013c	48 01 87 88 00
	00 00		 add	 QWORD PTR [rdi+136], rax

; 1500 :                   zi->ci.pos_in_buffered_data += copy_this;

  00143	01 97 d4 00 00
	00		 add	 DWORD PTR [rdi+212], edx
  00149	e9 08 ff ff ff	 jmp	 $LL13@zipWriteIn
zipWriteInFileInZip ENDP
_TEXT	ENDS
PUBLIC	zipOpen3
EXTRN	__chkstk:PROC
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpen3 DD imagerel $LN15
	DD	imagerel $LN15+413
	DD	imagerel $unwind$zipOpen3
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpen3 DD 0b2a01H
	DD	02037c42aH
	DD	02036742aH
	DD	02035642aH
	DD	02034342aH
	DD	02032012aH
	DD	05015H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpen3
_TEXT	SEGMENT
ziinit$ = 32
pathname$ = 65952
append$ = 65960
globalcomment$ = 65968
pzlib_filefunc64_32_def$ = 65976
zipOpen3 PROC						; COMDAT

; 850  : {

$LN15:
  00000	48 89 5c 24 08	 mov	 QWORD PTR [rsp+8], rbx
  00005	48 89 74 24 10	 mov	 QWORD PTR [rsp+16], rsi
  0000a	48 89 7c 24 18	 mov	 QWORD PTR [rsp+24], rdi
  0000f	4c 89 64 24 20	 mov	 QWORD PTR [rsp+32], r12
  00014	55		 push	 rbp
  00015	48 8d ac 24 70
	ff fe ff	 lea	 rbp, QWORD PTR [rsp-65680]
  0001d	b8 90 01 01 00	 mov	 eax, 65936		; 00010190H
  00022	e8 00 00 00 00	 call	 __chkstk
  00027	48 2b e0	 sub	 rsp, rax

; 851  :     zip64_internal ziinit;
; 852  :     zip64_internal* zi;
; 853  :     int err=ZIP_OK;

  0002a	33 db		 xor	 ebx, ebx
  0002c	8b f2		 mov	 esi, edx
  0002e	4d 8b e0	 mov	 r12, r8
  00031	48 8b d1	 mov	 rdx, rcx

; 854  : 
; 855  :     ziinit.z_filefunc.zseek32_file = NULL;

  00034	48 89 5c 24 70	 mov	 QWORD PTR ziinit$[rsp+80], rbx

; 856  :     ziinit.z_filefunc.ztell32_file = NULL;

  00039	48 89 5c 24 68	 mov	 QWORD PTR ziinit$[rsp+72], rbx

; 857  :     if (pzlib_filefunc64_32_def==NULL)

  0003e	4d 85 c9	 test	 r9, r9
  00041	75 0c		 jne	 SHORT $LN11@zipOpen3

; 858  :         fill_fopen64_filefunc(&ziinit.z_filefunc.zfile_func64);

  00043	48 8d 4c 24 20	 lea	 rcx, QWORD PTR ziinit$[rsp]
  00048	e8 00 00 00 00	 call	 fill_fopen64_filefunc

; 859  :     else

  0004d	eb 3d		 jmp	 SHORT $LN10@zipOpen3
$LN11@zipOpen3:

; 860  :         ziinit.z_filefunc = *pzlib_filefunc64_32_def;

  0004f	41 0f 10 01	 movups	 xmm0, XMMWORD PTR [r9]
  00053	41 0f 10 49 10	 movups	 xmm1, XMMWORD PTR [r9+16]
  00058	0f 29 44 24 20	 movaps	 XMMWORD PTR ziinit$[rsp], xmm0
  0005d	0f 29 4c 24 30	 movaps	 XMMWORD PTR ziinit$[rsp+16], xmm1
  00062	41 0f 10 41 20	 movups	 xmm0, XMMWORD PTR [r9+32]
  00067	41 0f 10 49 30	 movups	 xmm1, XMMWORD PTR [r9+48]
  0006c	0f 29 44 24 40	 movaps	 XMMWORD PTR ziinit$[rsp+32], xmm0
  00071	0f 29 4c 24 50	 movaps	 XMMWORD PTR ziinit$[rsp+48], xmm1
  00076	41 0f 10 41 40	 movups	 xmm0, XMMWORD PTR [r9+64]
  0007b	f2 41 0f 10 49
	50		 movsdx	 xmm1, QWORD PTR [r9+80]
  00081	0f 29 44 24 60	 movaps	 XMMWORD PTR ziinit$[rsp+64], xmm0
  00086	f2 0f 11 4c 24
	70		 movsdx	 QWORD PTR ziinit$[rsp+80], xmm1
$LN10@zipOpen3:

; 861  : 
; 862  :     ziinit.filestream = ZOPEN64(ziinit.z_filefunc,
; 863  :                   pathname,
; 864  :                   (append == APPEND_STATUS_CREATE) ?
; 865  :                   (ZLIB_FILEFUNC_MODE_READ | ZLIB_FILEFUNC_MODE_WRITE | ZLIB_FILEFUNC_MODE_CREATE) :
; 866  :                     (ZLIB_FILEFUNC_MODE_READ | ZLIB_FILEFUNC_MODE_WRITE | ZLIB_FILEFUNC_MODE_EXISTING));

  0008c	b8 0b 00 00 00	 mov	 eax, 11
  00091	41 b8 07 00 00
	00		 mov	 r8d, 7
  00097	85 f6		 test	 esi, esi
  00099	48 8d 4c 24 20	 lea	 rcx, QWORD PTR ziinit$[rsp]
  0009e	44 0f 44 c0	 cmove	 r8d, eax
  000a2	e8 00 00 00 00	 call	 call_zopen64
  000a7	48 8b f8	 mov	 rdi, rax
  000aa	48 89 44 24 78	 mov	 QWORD PTR ziinit$[rsp+88], rax

; 867  : 
; 868  :     if (ziinit.filestream == NULL)

  000af	48 85 c0	 test	 rax, rax

; 869  :         return NULL;

  000b2	74 6b		 je	 SHORT $LN14@zipOpen3

; 870  : 
; 871  :     if (append == APPEND_STATUS_CREATEAFTER)

  000b4	83 fe 01	 cmp	 esi, 1
  000b7	75 14		 jne	 SHORT $LN8@zipOpen3

; 872  :         ZSEEK64(ziinit.z_filefunc,ziinit.filestream,0,SEEK_END);

  000b9	44 8d 4e 01	 lea	 r9d, QWORD PTR [rsi+1]
  000bd	48 8d 4c 24 20	 lea	 rcx, QWORD PTR ziinit$[rsp]
  000c2	45 33 c0	 xor	 r8d, r8d
  000c5	48 8b d0	 mov	 rdx, rax
  000c8	e8 00 00 00 00	 call	 call_zseek64
$LN8@zipOpen3:

; 873  : 
; 874  :     ziinit.begin_pos = ZTELL64(ziinit.z_filefunc,ziinit.filestream);

  000cd	48 8d 4c 24 20	 lea	 rcx, QWORD PTR ziinit$[rsp]
  000d2	48 8b d7	 mov	 rdx, rdi
  000d5	e8 00 00 00 00	 call	 call_ztell64

; 875  :     ziinit.in_opened_file_inzip = 0;
; 876  :     ziinit.ci.stream_initialised = 0;
; 877  :     ziinit.number_entry = 0;
; 878  :     ziinit.add_position_when_writting_offset = 0;
; 879  :     init_linkedlist(&(ziinit.central_dir));

  000da	48 8d 4d 80	 lea	 rcx, QWORD PTR ziinit$[rbp-160]
  000de	89 5d 90	 mov	 DWORD PTR ziinit$[rbp-144], ebx
  000e1	89 5d f0	 mov	 DWORD PTR ziinit$[rbp-48], ebx
  000e4	48 89 9d 78 00
	01 00		 mov	 QWORD PTR ziinit$[rbp+65624], rbx
  000eb	48 89 9d 70 00
	01 00		 mov	 QWORD PTR ziinit$[rbp+65616], rbx
  000f2	48 89 85 68 00
	01 00		 mov	 QWORD PTR ziinit$[rbp+65608], rax
  000f9	e8 00 00 00 00	 call	 init_linkedlist

; 880  : 
; 881  : 
; 882  : 
; 883  :     zi = (zip64_internal*)ALLOC(sizeof(zip64_internal));

  000fe	b9 68 01 01 00	 mov	 ecx, 65896		; 00010168H
  00103	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc
  00109	48 8b f8	 mov	 rdi, rax

; 884  :     if (zi==NULL)

  0010c	48 85 c0	 test	 rax, rax
  0010f	75 12		 jne	 SHORT $LN7@zipOpen3

; 885  :     {
; 886  :         ZCLOSE64(ziinit.z_filefunc,ziinit.filestream);

  00111	48 8b 54 24 78	 mov	 rdx, QWORD PTR ziinit$[rsp+88]
  00116	48 8b 4c 24 58	 mov	 rcx, QWORD PTR ziinit$[rsp+56]
  0011b	ff 54 24 48	 call	 QWORD PTR ziinit$[rsp+40]
$LN14@zipOpen3:

; 887  :         return NULL;

  0011f	33 c0		 xor	 eax, eax
  00121	eb 5d		 jmp	 SHORT $LN1@zipOpen3
$LN7@zipOpen3:

; 888  :     }
; 889  : 
; 890  :     /* now we add file in a zipfile */
; 891  : #    ifndef NO_ADDFILEINEXISTINGZIP
; 892  :     ziinit.globalcomment = NULL;

  00123	48 8b cb	 mov	 rcx, rbx
  00126	48 89 9d 80 00
	01 00		 mov	 QWORD PTR ziinit$[rbp+65632], rbx

; 893  :     if (append == APPEND_STATUS_ADDINZIP)

  0012d	83 fe 02	 cmp	 esi, 2
  00130	75 13		 jne	 SHORT $LN6@zipOpen3

; 894  :     {
; 895  :       // Read and Cache Central Directory Records
; 896  :       err = LoadCentralDirectoryRecord(&ziinit);

  00132	48 8d 4c 24 20	 lea	 rcx, QWORD PTR ziinit$[rsp]
  00137	e8 00 00 00 00	 call	 LoadCentralDirectoryRecord
  0013c	48 8b 8d 80 00
	01 00		 mov	 rcx, QWORD PTR ziinit$[rbp+65632]
  00143	8b d8		 mov	 ebx, eax
$LN6@zipOpen3:

; 897  :     }
; 898  : 
; 899  :     if (globalcomment)

  00145	4d 85 e4	 test	 r12, r12
  00148	74 04		 je	 SHORT $LN5@zipOpen3

; 900  :     {
; 901  :       *globalcomment = ziinit.globalcomment;

  0014a	49 89 0c 24	 mov	 QWORD PTR [r12], rcx
$LN5@zipOpen3:

; 902  :     }
; 903  : #    endif /* !NO_ADDFILEINEXISTINGZIP*/
; 904  : 
; 905  :     if (err != ZIP_OK)

  0014e	85 db		 test	 ebx, ebx
  00150	74 18		 je	 SHORT $LN4@zipOpen3

; 906  :     {
; 907  : #    ifndef NO_ADDFILEINEXISTINGZIP
; 908  :         TRYFREE(ziinit.globalcomment);

  00152	48 85 c9	 test	 rcx, rcx
  00155	74 06		 je	 SHORT $LN3@zipOpen3
  00157	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free
$LN3@zipOpen3:

; 909  : #    endif /* !NO_ADDFILEINEXISTINGZIP*/
; 910  :         TRYFREE(zi);

  0015d	48 8b cf	 mov	 rcx, rdi
  00160	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free

; 911  :         return NULL;

  00166	33 c0		 xor	 eax, eax
  00168	eb 16		 jmp	 SHORT $LN1@zipOpen3
$LN4@zipOpen3:

; 912  :     }
; 913  :     else
; 914  :     {
; 915  :         *zi = ziinit;

  0016a	48 8d 54 24 20	 lea	 rdx, QWORD PTR ziinit$[rsp]
  0016f	41 b8 68 01 01
	00		 mov	 r8d, 65896		; 00010168H
  00175	48 8b cf	 mov	 rcx, rdi
  00178	e8 00 00 00 00	 call	 memcpy

; 916  :         return (zipFile)zi;

  0017d	48 8b c7	 mov	 rax, rdi
$LN1@zipOpen3:

; 917  :     }
; 918  : }

  00180	4c 8d 9c 24 90
	01 01 00	 lea	 r11, QWORD PTR [rsp+65936]
  00188	49 8b 5b 10	 mov	 rbx, QWORD PTR [r11+16]
  0018c	49 8b 73 18	 mov	 rsi, QWORD PTR [r11+24]
  00190	49 8b 7b 20	 mov	 rdi, QWORD PTR [r11+32]
  00194	4d 8b 63 28	 mov	 r12, QWORD PTR [r11+40]
  00198	49 8b e3	 mov	 rsp, r11
  0019b	5d		 pop	 rbp
  0019c	c3		 ret	 0
zipOpen3 ENDP
PUBLIC	zipCloseFileInZip
; Function compile flags: /Ogtpy
;	COMDAT zipCloseFileInZip
_TEXT	SEGMENT
file$ = 8
zipCloseFileInZip PROC					; COMDAT

; 1752 :     return zipCloseFileInZipRaw (file,0,0);

  00000	45 33 c0	 xor	 r8d, r8d
  00003	33 d2		 xor	 edx, edx

; 1753 : }

  00005	e9 00 00 00 00	 jmp	 zipCloseFileInZipRaw
zipCloseFileInZip ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip4_64
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip4_64 DD imagerel $LN61
	DD	imagerel $LN61+39
	DD	imagerel $unwind$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$0$zipOpenNewFileInZip4_64 DD imagerel $LN61+39
	DD	imagerel $LN61+85
	DD	imagerel $chain$0$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$2$zipOpenNewFileInZip4_64 DD imagerel $LN61+85
	DD	imagerel $LN61+104
	DD	imagerel $chain$2$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$3$zipOpenNewFileInZip4_64 DD imagerel $LN61+104
	DD	imagerel $LN61+117
	DD	imagerel $chain$3$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$6$zipOpenNewFileInZip4_64 DD imagerel $LN61+117
	DD	imagerel $LN61+1070
	DD	imagerel $chain$6$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$7$zipOpenNewFileInZip4_64 DD imagerel $LN61+1070
	DD	imagerel $LN61+1461
	DD	imagerel $chain$7$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$8$zipOpenNewFileInZip4_64 DD imagerel $LN61+1461
	DD	imagerel $LN61+1478
	DD	imagerel $chain$8$zipOpenNewFileInZip4_64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$8$zipOpenNewFileInZip4_64 DD 021H
	DD	imagerel $LN61+85
	DD	imagerel $LN61+104
	DD	imagerel $chain$2$zipOpenNewFileInZip4_64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$7$zipOpenNewFileInZip4_64 DD 040021H
	DD	0af400H
	DD	0be400H
	DD	imagerel $LN61+104
	DD	imagerel $LN61+117
	DD	imagerel $chain$3$zipOpenNewFileInZip4_64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$6$zipOpenNewFileInZip4_64 DD 061221H
	DD	0af412H
	DD	0be40dH
	DD	0cc405H
	DD	imagerel $LN61+104
	DD	imagerel $LN61+117
	DD	imagerel $chain$3$zipOpenNewFileInZip4_64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$3$zipOpenNewFileInZip4_64 DD 020521H
	DD	0d6405H
	DD	imagerel $LN61+85
	DD	imagerel $LN61+104
	DD	imagerel $chain$2$zipOpenNewFileInZip4_64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$2$zipOpenNewFileInZip4_64 DD 020021H
	DD	0135400H
	DD	imagerel $LN61
	DD	imagerel $LN61+39
	DD	imagerel $unwind$zipOpenNewFileInZip4_64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$0$zipOpenNewFileInZip4_64 DD 020821H
	DD	0135408H
	DD	imagerel $LN61
	DD	imagerel $LN61+39
	DD	imagerel $unwind$zipOpenNewFileInZip4_64
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip4_64 DD 040d01H
	DD	0d009d20dH
	DD	030067007H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip4_64
_TEXT	SEGMENT
tv74 = 64
bufHead$83917 = 64
tv999 = 144
file$ = 144
filename$ = 152
zipfi$ = 160
extrafield_local$ = 168
size_extrafield_local$ = 176
extrafield_global$ = 184
size_extrafield_global$ = 192
comment$ = 200
method$ = 208
level$ = 216
raw$ = 224
windowBits$ = 232
memLevel$ = 240
strategy$ = 248
password$ = 256
crcForCrypting$ = 264
versionMadeBy$ = 272
flagBase$ = 280
zip64$ = 288
zipOpenNewFileInZip4_64 PROC				; COMDAT

; 1062 : {

$LN61:
  00000	4c 89 4c 24 20	 mov	 QWORD PTR [rsp+32], r9
  00005	53		 push	 rbx
  00006	57		 push	 rdi
  00007	41 55		 push	 r13
  00009	48 83 ec 70	 sub	 rsp, 112		; 00000070H
  0000d	4d 8b e8	 mov	 r13, r8
  00010	48 8b fa	 mov	 rdi, rdx
  00013	48 8b d9	 mov	 rbx, rcx

; 1063 :     zip64_internal* zi;
; 1064 :     uInt size_filename;
; 1065 :     uInt size_comment;
; 1066 :     uInt i;
; 1067 :     int err = ZIP_OK;
; 1068 : 
; 1069 : #    ifdef NOCRYPT
; 1070 :     (crcForCrypting);
; 1071 :     if (password != NULL)
; 1072 :         return ZIP_PARAMERROR;
; 1073 : #    endif
; 1074 : 
; 1075 :     if (file == NULL)

  00016	48 85 c9	 test	 rcx, rcx
  00019	75 0c		 jne	 SHORT $LN41@zipOpenNew

; 1076 :         return ZIP_PARAMERROR;

  0001b	8d 41 9a	 lea	 eax, QWORD PTR [rcx-102]

; 1263 : }

  0001e	48 83 c4 70	 add	 rsp, 112		; 00000070H
  00022	41 5d		 pop	 r13
  00024	5f		 pop	 rdi
  00025	5b		 pop	 rbx
  00026	c3		 ret	 0
$LN41@zipOpenNew:
  00027	48 89 ac 24 98
	00 00 00	 mov	 QWORD PTR [rsp+152], rbp

; 1077 : 
; 1078 : #ifdef HAVE_BZIP2
; 1079 :     if ((method!=0) && (method!=Z_DEFLATED) && (method!=Z_BZIP2ED))
; 1080 :       return ZIP_PARAMERROR;
; 1081 : #else
; 1082 :     if ((method!=0) && (method!=Z_DEFLATED))

  0002f	8b ac 24 d0 00
	00 00		 mov	 ebp, DWORD PTR method$[rsp]
  00036	85 ed		 test	 ebp, ebp
  00038	74 1b		 je	 SHORT $LN40@zipOpenNew
  0003a	83 fd 08	 cmp	 ebp, 8
  0003d	74 16		 je	 SHORT $LN40@zipOpenNew

; 1083 :       return ZIP_PARAMERROR;

  0003f	b8 9a ff ff ff	 mov	 eax, -102		; ffffffffffffff9aH
  00044	48 8b ac 24 98
	00 00 00	 mov	 rbp, QWORD PTR [rsp+152]

; 1263 : }

  0004c	48 83 c4 70	 add	 rsp, 112		; 00000070H
  00050	41 5d		 pop	 r13
  00052	5f		 pop	 rdi
  00053	5b		 pop	 rbx
  00054	c3		 ret	 0
$LN40@zipOpenNew:

; 1084 : #endif
; 1085 : 
; 1086 :     zi = (zip64_internal*)file;
; 1087 : 
; 1088 :     if (zi->in_opened_file_inzip == 1)

  00055	83 79 70 01	 cmp	 DWORD PTR [rcx+112], 1
  00059	75 0d		 jne	 SHORT $LN38@zipOpenNew

; 1089 :     {
; 1090 :         err = zipCloseFileInZip (file);

  0005b	e8 00 00 00 00	 call	 zipCloseFileInZip

; 1091 :         if (err != ZIP_OK)

  00060	85 c0		 test	 eax, eax

; 1092 :             return err;

  00062	0f 85 4d 05 00
	00		 jne	 $LN54@zipOpenNew
$LN38@zipOpenNew:
  00068	48 89 74 24 68	 mov	 QWORD PTR [rsp+104], rsi

; 1093 :     }
; 1094 : 
; 1095 :     if (filename==NULL)
; 1096 :         filename="-";
; 1097 : 
; 1098 :     if (comment==NULL)

  0006d	48 8b b4 24 c8
	00 00 00	 mov	 rsi, QWORD PTR comment$[rsp]
  00075	4c 89 64 24 60	 mov	 QWORD PTR [rsp+96], r12
  0007a	48 85 ff	 test	 rdi, rdi
  0007d	4c 89 74 24 58	 mov	 QWORD PTR [rsp+88], r14
  00082	4c 89 7c 24 50	 mov	 QWORD PTR [rsp+80], r15
  00087	4c 8d 3d 00 00
	00 00		 lea	 r15, OFFSET FLAT:??_C@_01JOAMLHOP@?9?$AA@
  0008e	4c 0f 45 ff	 cmovne	 r15, rdi
  00092	45 33 c9	 xor	 r9d, r9d
  00095	48 85 f6	 test	 rsi, rsi
  00098	75 0a		 jne	 SHORT $LN36@zipOpenNew

; 1099 :         size_comment = 0;

  0009a	45 8b e1	 mov	 r12d, r9d
  0009d	4c 89 64 24 40	 mov	 QWORD PTR tv74[rsp], r12

; 1100 :     else

  000a2	eb 19		 jmp	 SHORT $LN35@zipOpenNew
$LN36@zipOpenNew:

; 1101 :         size_comment = (uInt)strlen(comment);

  000a4	48 83 c9 ff	 or	 rcx, -1
  000a8	33 c0		 xor	 eax, eax
  000aa	48 8b fe	 mov	 rdi, rsi
  000ad	f2 ae		 repne scasb
  000af	48 f7 d1	 not	 rcx
  000b2	48 ff c9	 dec	 rcx
  000b5	4c 8b e1	 mov	 r12, rcx
  000b8	48 89 4c 24 40	 mov	 QWORD PTR tv74[rsp], rcx
$LN35@zipOpenNew:

; 1102 : 
; 1103 :     size_filename = (uInt)strlen(filename);

  000bd	48 83 c9 ff	 or	 rcx, -1
  000c1	33 c0		 xor	 eax, eax
  000c3	49 8b ff	 mov	 rdi, r15
  000c6	f2 ae		 repne scasb
  000c8	48 f7 d1	 not	 rcx
  000cb	48 8d 79 ff	 lea	 rdi, QWORD PTR [rcx-1]

; 1104 : 
; 1105 :     if (zipfi == NULL)

  000cf	4d 85 ed	 test	 r13, r13
  000d2	75 09		 jne	 SHORT $LN34@zipOpenNew

; 1106 :         zi->ci.dosDate = 0;

  000d4	44 89 8b 00 01
	01 00		 mov	 DWORD PTR [rbx+65792], r9d

; 1107 :     else

  000db	eb 16		 jmp	 SHORT $LN31@zipOpenNew
$LN34@zipOpenNew:

; 1108 :     {
; 1109 :         if (zipfi->dosDate != 0)

  000dd	41 8b 45 18	 mov	 eax, DWORD PTR [r13+24]
  000e1	85 c0		 test	 eax, eax

; 1110 :             zi->ci.dosDate = zipfi->dosDate;
; 1111 :         else

  000e3	75 08		 jne	 SHORT $LN58@zipOpenNew

; 1112 :           zi->ci.dosDate = zip64local_TmzDateToDosDate(&zipfi->tmz_date);

  000e5	49 8b cd	 mov	 rcx, r13
  000e8	e8 00 00 00 00	 call	 zip64local_TmzDateToDosDate
$LN58@zipOpenNew:
  000ed	89 83 00 01 01
	00		 mov	 DWORD PTR [rbx+65792], eax
$LN31@zipOpenNew:

; 1113 :     }
; 1114 : 
; 1115 :     zi->ci.flag = flagBase;
; 1116 :     if ((level==8) || (level==9))

  000f3	44 8b b4 24 d8
	00 00 00	 mov	 r14d, DWORD PTR level$[rsp]
  000fb	8b 84 24 18 01
	00 00		 mov	 eax, DWORD PTR flagBase$[rsp]
  00102	89 83 f4 00 00
	00		 mov	 DWORD PTR [rbx+244], eax
  00108	41 83 fe 08	 cmp	 r14d, 8
  0010c	74 06		 je	 SHORT $LN29@zipOpenNew
  0010e	41 83 fe 09	 cmp	 r14d, 9
  00112	75 09		 jne	 SHORT $LN30@zipOpenNew
$LN29@zipOpenNew:

; 1117 :       zi->ci.flag |= 2;

  00114	83 c8 02	 or	 eax, 2
  00117	89 83 f4 00 00
	00		 mov	 DWORD PTR [rbx+244], eax
$LN30@zipOpenNew:

; 1118 :     if (level==2)

  0011d	41 83 fe 02	 cmp	 r14d, 2
  00121	75 09		 jne	 SHORT $LN28@zipOpenNew

; 1119 :       zi->ci.flag |= 4;

  00123	83 8b f4 00 00
	00 04		 or	 DWORD PTR [rbx+244], 4

; 1120 :     if (level==1)

  0012a	eb 0d		 jmp	 SHORT $LN27@zipOpenNew
$LN28@zipOpenNew:
  0012c	41 83 fe 01	 cmp	 r14d, 1
  00130	75 07		 jne	 SHORT $LN27@zipOpenNew

; 1121 :       zi->ci.flag |= 6;

  00132	83 8b f4 00 00
	00 06		 or	 DWORD PTR [rbx+244], 6
$LN27@zipOpenNew:

; 1122 :     if (password != NULL)

  00139	4c 39 8c 24 00
	01 00 00	 cmp	 QWORD PTR password$[rsp], r9
  00141	74 07		 je	 SHORT $LN26@zipOpenNew

; 1123 :       zi->ci.flag |= 1;

  00143	83 8b f4 00 00
	00 01		 or	 DWORD PTR [rbx+244], 1
$LN26@zipOpenNew:

; 1124 : 
; 1125 :     zi->ci.crc32 = 0;
; 1126 :     zi->ci.method = method;
; 1127 :     zi->ci.encrypt = 0;
; 1128 :     zi->ci.stream_initialised = 0;
; 1129 :     zi->ci.pos_in_buffered_data = 0;
; 1130 :     zi->ci.raw = raw;

  0014a	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR raw$[rsp]

; 1131 :     zi->ci.pos_local_header = ZTELL64(zi->z_filefunc,zi->filestream);

  00151	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  00155	48 8b cb	 mov	 rcx, rbx
  00158	89 ab f8 00 00
	00		 mov	 DWORD PTR [rbx+248], ebp
  0015e	4c 89 8b 04 01
	01 00		 mov	 QWORD PTR [rbx+65796], r9
  00165	4c 89 8b d0 00
	00 00		 mov	 QWORD PTR [rbx+208], r9
  0016c	89 83 fc 00 00
	00		 mov	 DWORD PTR [rbx+252], eax
  00172	e8 00 00 00 00	 call	 call_ztell64

; 1132 : 
; 1133 :     zi->ci.size_centralheader = SIZECENTRALHEADER + size_filename + size_extrafield_global + size_comment;

  00177	8b ac 24 c0 00
	00 00		 mov	 ebp, DWORD PTR size_extrafield_global$[rsp]
  0017e	48 89 83 d8 00
	00 00		 mov	 QWORD PTR [rbx+216], rax
  00185	42 8d 04 27	 lea	 eax, DWORD PTR [rdi+r12]

; 1134 :     zi->ci.size_centralExtraFree = 32; // Extra space we have reserved in case we need to add ZIP64 extra info data

  00189	c7 83 f0 00 00
	00 20 00 00 00	 mov	 DWORD PTR [rbx+240], 32	; 00000020H
  00193	8d 44 28 2e	 lea	 eax, DWORD PTR [rax+rbp+46]
  00197	89 83 ec 00 00
	00		 mov	 DWORD PTR [rbx+236], eax

; 1135 : 
; 1136 :     zi->ci.central_header = (char*)ALLOC((uInt)zi->ci.size_centralheader + zi->ci.size_centralExtraFree);

  0019d	8d 48 20	 lea	 ecx, DWORD PTR [rax+32]
  001a0	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_malloc

; 1137 : 
; 1138 :     zi->ci.size_centralExtra = size_extrafield_global;
; 1139 :     zip64local_putValue_inmemory(zi->ci.central_header,(uLong)CENTRALHEADERMAGIC,4);

  001a6	ba 50 4b 01 02	 mov	 edx, 33639248		; 02014b50H
  001ab	41 b8 04 00 00
	00		 mov	 r8d, 4
  001b1	48 8b c8	 mov	 rcx, rax
  001b4	48 89 83 e0 00
	00 00		 mov	 QWORD PTR [rbx+224], rax
  001bb	89 ab e8 00 00
	00		 mov	 DWORD PTR [rbx+232], ebp
  001c1	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1140 :     /* version info */
; 1141 :     zip64local_putValue_inmemory(zi->ci.central_header+4,(uLong)versionMadeBy,2);

  001c6	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  001cd	8b 94 24 10 01
	00 00		 mov	 edx, DWORD PTR versionMadeBy$[rsp]
  001d4	48 83 c1 04	 add	 rcx, 4
  001d8	41 b8 02 00 00
	00		 mov	 r8d, 2
  001de	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1142 :     zip64local_putValue_inmemory(zi->ci.central_header+6,(uLong)20,2);

  001e3	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  001ea	ba 14 00 00 00	 mov	 edx, 20
  001ef	44 8d 42 ee	 lea	 r8d, QWORD PTR [rdx-18]
  001f3	48 83 c1 06	 add	 rcx, 6
  001f7	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1143 :     zip64local_putValue_inmemory(zi->ci.central_header+8,(uLong)zi->ci.flag,2);

  001fc	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  00203	8b 93 f4 00 00
	00		 mov	 edx, DWORD PTR [rbx+244]
  00209	48 83 c1 08	 add	 rcx, 8
  0020d	41 b8 02 00 00
	00		 mov	 r8d, 2
  00213	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1144 :     zip64local_putValue_inmemory(zi->ci.central_header+10,(uLong)zi->ci.method,2);

  00218	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  0021f	8b 93 f8 00 00
	00		 mov	 edx, DWORD PTR [rbx+248]
  00225	48 83 c1 0a	 add	 rcx, 10
  00229	41 b8 02 00 00
	00		 mov	 r8d, 2
  0022f	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1145 :     zip64local_putValue_inmemory(zi->ci.central_header+12,(uLong)zi->ci.dosDate,4);

  00234	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  0023b	8b 93 00 01 01
	00		 mov	 edx, DWORD PTR [rbx+65792]
  00241	48 83 c1 0c	 add	 rcx, 12
  00245	41 b8 04 00 00
	00		 mov	 r8d, 4
  0024b	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1146 :     zip64local_putValue_inmemory(zi->ci.central_header+16,(uLong)0,4); /*crc*/

  00250	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  00257	33 d2		 xor	 edx, edx
  00259	44 8d 42 04	 lea	 r8d, QWORD PTR [rdx+4]
  0025d	48 83 c1 10	 add	 rcx, 16
  00261	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1147 :     zip64local_putValue_inmemory(zi->ci.central_header+20,(uLong)0,4); /*compr size*/

  00266	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  0026d	33 d2		 xor	 edx, edx
  0026f	44 8d 42 04	 lea	 r8d, QWORD PTR [rdx+4]
  00273	48 83 c1 14	 add	 rcx, 20
  00277	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1148 :     zip64local_putValue_inmemory(zi->ci.central_header+24,(uLong)0,4); /*uncompr size*/

  0027c	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  00283	33 d2		 xor	 edx, edx
  00285	44 8d 42 04	 lea	 r8d, QWORD PTR [rdx+4]
  00289	48 83 c1 18	 add	 rcx, 24
  0028d	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1149 :     zip64local_putValue_inmemory(zi->ci.central_header+28,(uLong)size_filename,2);

  00292	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  00299	41 b8 02 00 00
	00		 mov	 r8d, 2
  0029f	8b d7		 mov	 edx, edi
  002a1	48 83 c1 1c	 add	 rcx, 28
  002a5	8b ef		 mov	 ebp, edi
  002a7	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1150 :     zip64local_putValue_inmemory(zi->ci.central_header+30,(uLong)size_extrafield_global,2);

  002ac	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  002b3	8b 94 24 c0 00
	00 00		 mov	 edx, DWORD PTR size_extrafield_global$[rsp]
  002ba	48 83 c1 1e	 add	 rcx, 30
  002be	41 b8 02 00 00
	00		 mov	 r8d, 2
  002c4	48 89 94 24 90
	00 00 00	 mov	 QWORD PTR tv999[rsp], rdx
  002cc	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1151 :     zip64local_putValue_inmemory(zi->ci.central_header+32,(uLong)size_comment,2);

  002d1	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  002d8	45 8b e4	 mov	 r12d, r12d
  002db	41 b8 02 00 00
	00		 mov	 r8d, 2
  002e1	41 8b d4	 mov	 edx, r12d
  002e4	48 83 c1 20	 add	 rcx, 32			; 00000020H
  002e8	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1152 :     zip64local_putValue_inmemory(zi->ci.central_header+34,(uLong)0,2); /*disk nm start*/

  002ed	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  002f4	33 d2		 xor	 edx, edx
  002f6	48 83 c1 22	 add	 rcx, 34			; 00000022H
  002fa	44 8d 42 02	 lea	 r8d, QWORD PTR [rdx+2]
  002fe	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1153 : 
; 1154 :     if (zipfi==NULL)
; 1155 :         zip64local_putValue_inmemory(zi->ci.central_header+36,(uLong)0,2);

  00303	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  0030a	41 b8 02 00 00
	00		 mov	 r8d, 2
  00310	48 83 c1 24	 add	 rcx, 36			; 00000024H
  00314	4d 85 ed	 test	 r13, r13
  00317	75 0b		 jne	 SHORT $LN25@zipOpenNew
  00319	33 d2		 xor	 edx, edx
  0031b	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1158 : 
; 1159 :     if (zipfi==NULL)
; 1160 :         zip64local_putValue_inmemory(zi->ci.central_header+38,(uLong)0,4);

  00320	33 d2		 xor	 edx, edx

; 1161 :     else

  00322	eb 0d		 jmp	 SHORT $LN59@zipOpenNew
$LN25@zipOpenNew:

; 1156 :     else
; 1157 :         zip64local_putValue_inmemory(zi->ci.central_header+36,(uLong)zipfi->internal_fa,2);

  00324	41 8b 55 1c	 mov	 edx, DWORD PTR [r13+28]
  00328	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1162 :         zip64local_putValue_inmemory(zi->ci.central_header+38,(uLong)zipfi->external_fa,4);

  0032d	41 8b 55 20	 mov	 edx, DWORD PTR [r13+32]
$LN59@zipOpenNew:
  00331	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  00338	41 b8 04 00 00
	00		 mov	 r8d, 4
  0033e	48 83 c1 26	 add	 rcx, 38			; 00000026H
  00342	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1163 : 
; 1164 :     if(zi->ci.pos_local_header >= 0xffffffff)
; 1165 :       zip64local_putValue_inmemory(zi->ci.central_header+42,(uLong)0xffffffff,4);

  00347	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  0034e	ba ff ff ff ff	 mov	 edx, -1			; ffffffffH
  00353	48 83 c1 2a	 add	 rcx, 42			; 0000002aH
  00357	41 b8 04 00 00
	00		 mov	 r8d, 4
  0035d	48 39 93 d8 00
	00 00		 cmp	 QWORD PTR [rbx+216], rdx

; 1166 :     else

  00364	73 0d		 jae	 SHORT $LN60@zipOpenNew

; 1167 :       zip64local_putValue_inmemory(zi->ci.central_header+42,(uLong)zi->ci.pos_local_header - zi->add_position_when_writting_offset,4);

  00366	8b 93 d8 00 00
	00		 mov	 edx, DWORD PTR [rbx+216]
  0036c	48 2b 93 50 01
	01 00		 sub	 rdx, QWORD PTR [rbx+65872]
$LN60@zipOpenNew:
  00373	e8 00 00 00 00	 call	 zip64local_putValue_inmemory

; 1168 : 
; 1169 :     for (i=0;i<size_filename;i++)

  00378	45 33 ed	 xor	 r13d, r13d
  0037b	85 ff		 test	 edi, edi
  0037d	74 2a		 je	 SHORT $LN17@zipOpenNew
  0037f	41 8b d5	 mov	 edx, r13d
  00382	49 8b ff	 mov	 rdi, r15
  00385	4c 8b c5	 mov	 r8, rbp
  00388	0f 1f 84 00 00
	00 00 00	 npad	 8
$LL19@zipOpenNew:

; 1170 :         *(zi->ci.central_header+SIZECENTRALHEADER+i) = *(filename+i);

  00390	0f b6 07	 movzx	 eax, BYTE PTR [rdi]
  00393	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  0039a	48 ff c2	 inc	 rdx
  0039d	88 44 11 2d	 mov	 BYTE PTR [rcx+rdx+45], al
  003a1	48 ff c7	 inc	 rdi
  003a4	49 ff c8	 dec	 r8
  003a7	75 e7		 jne	 SHORT $LL19@zipOpenNew
$LN17@zipOpenNew:

; 1171 : 
; 1172 :     for (i=0;i<size_extrafield_global;i++)

  003a9	83 bc 24 c0 00
	00 00 00	 cmp	 DWORD PTR size_extrafield_global$[rsp], 0
  003b1	4c 8b 8c 24 90
	00 00 00	 mov	 r9, QWORD PTR tv999[rsp]
  003b9	76 31		 jbe	 SHORT $LN14@zipOpenNew
  003bb	48 8b bc 24 b8
	00 00 00	 mov	 rdi, QWORD PTR extrafield_global$[rsp]
  003c3	49 8b d5	 mov	 rdx, r13
  003c6	4d 8b c1	 mov	 r8, r9
  003c9	0f 1f 80 00 00
	00 00		 npad	 7
$LL16@zipOpenNew:

; 1173 :         *(zi->ci.central_header+SIZECENTRALHEADER+size_filename+i) =
; 1174 :               *(((const char*)extrafield_global)+i);

  003d0	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  003d7	0f b6 07	 movzx	 eax, BYTE PTR [rdi]
  003da	48 ff c2	 inc	 rdx
  003dd	48 03 cd	 add	 rcx, rbp
  003e0	48 ff c7	 inc	 rdi
  003e3	49 ff c8	 dec	 r8
  003e6	88 44 11 2d	 mov	 BYTE PTR [rcx+rdx+45], al
  003ea	75 e4		 jne	 SHORT $LL16@zipOpenNew
$LN14@zipOpenNew:

; 1175 : 
; 1176 :     for (i=0;i<size_comment;i++)

  003ec	83 7c 24 40 00	 cmp	 DWORD PTR tv74[rsp], 0
  003f1	76 2c		 jbe	 SHORT $LN11@zipOpenNew
  003f3	49 8b d5	 mov	 rdx, r13
  003f6	66 66 0f 1f 84
	00 00 00 00 00	 npad	 10
$LL13@zipOpenNew:

; 1177 :         *(zi->ci.central_header+SIZECENTRALHEADER+size_filename+
; 1178 :               size_extrafield_global+i) = *(comment+i);

  00400	48 8b 8b e0 00
	00 00		 mov	 rcx, QWORD PTR [rbx+224]
  00407	0f b6 06	 movzx	 eax, BYTE PTR [rsi]
  0040a	48 ff c2	 inc	 rdx
  0040d	49 03 c9	 add	 rcx, r9
  00410	48 ff c6	 inc	 rsi
  00413	48 03 cd	 add	 rcx, rbp
  00416	49 ff cc	 dec	 r12
  00419	88 44 11 2d	 mov	 BYTE PTR [rcx+rdx+45], al
  0041d	75 e1		 jne	 SHORT $LL13@zipOpenNew
$LN11@zipOpenNew:

; 1179 :     if (zi->ci.central_header == NULL)

  0041f	48 83 bb e0 00
	00 00 00	 cmp	 QWORD PTR [rbx+224], 0
  00427	4c 8b 64 24 60	 mov	 r12, QWORD PTR [rsp+96]
  0042c	75 0a		 jne	 SHORT $LN10@zipOpenNew

; 1180 :         return ZIP_INTERNALERROR;

  0042e	b8 98 ff ff ff	 mov	 eax, -104		; ffffffffffffff98H
  00433	e9 6e 01 00 00	 jmp	 $LN57@zipOpenNew
$LN10@zipOpenNew:

; 1181 : 
; 1182 :     zi->ci.zip64 = zip64;

  00438	8b 84 24 20 01
	00 00		 mov	 eax, DWORD PTR zip64$[rsp]

; 1183 :     zi->ci.totalCompressedData = 0;
; 1184 :     zi->ci.totalUncompressedData = 0;
; 1185 :     zi->ci.pos_zip64extrainfo = 0;
; 1186 : 
; 1187 :     err = Write_LocalFileHeader(zi, filename, size_extrafield_local, extrafield_local);

  0043f	4c 8b 8c 24 a8
	00 00 00	 mov	 r9, QWORD PTR extrafield_local$[rsp]
  00447	44 8b 84 24 b0
	00 00 00	 mov	 r8d, DWORD PTR size_extrafield_local$[rsp]
  0044f	49 8b d7	 mov	 rdx, r15
  00452	48 8b cb	 mov	 rcx, rbx
  00455	89 83 0c 01 01
	00		 mov	 DWORD PTR [rbx+65804], eax
  0045b	4c 89 ab 18 01
	01 00		 mov	 QWORD PTR [rbx+65816], r13
  00462	4c 89 ab 20 01
	01 00		 mov	 QWORD PTR [rbx+65824], r13
  00469	4c 89 ab 10 01
	01 00		 mov	 QWORD PTR [rbx+65808], r13
  00470	e8 00 00 00 00	 call	 Write_LocalFileHeader

; 1188 : 
; 1189 : #ifdef HAVE_BZIP2
; 1190 :     zi->ci.bstream.avail_in = (uInt)0;
; 1191 :     zi->ci.bstream.avail_out = (uInt)Z_BUFSIZE;
; 1192 :     zi->ci.bstream.next_out = (char*)zi->ci.buffered_data;
; 1193 :     zi->ci.bstream.total_in_hi32 = 0;
; 1194 :     zi->ci.bstream.total_in_lo32 = 0;
; 1195 :     zi->ci.bstream.total_out_hi32 = 0;
; 1196 :     zi->ci.bstream.total_out_lo32 = 0;
; 1197 : #endif
; 1198 : 
; 1199 :     zi->ci.stream.avail_in = (uInt)0;
; 1200 :     zi->ci.stream.avail_out = (uInt)Z_BUFSIZE;
; 1201 :     zi->ci.stream.next_out = zi->ci.buffered_data;

  00475	48 8d 8b 00 01
	00 00		 lea	 rcx, QWORD PTR [rbx+256]
  0047c	48 c7 83 80 00
	00 00 00 00 00
	00		 mov	 QWORD PTR [rbx+128], 0
  00487	48 89 8b 88 00
	00 00		 mov	 QWORD PTR [rbx+136], rcx
  0048e	48 c7 83 90 00
	00 00 00 00 01
	00		 mov	 QWORD PTR [rbx+144], 65536 ; 00010000H

; 1202 :     zi->ci.stream.total_in = 0;
; 1203 :     zi->ci.stream.total_out = 0;
; 1204 :     zi->ci.stream.data_type = Z_BINARY;

  00499	44 89 ab c0 00
	00 00		 mov	 DWORD PTR [rbx+192], r13d
  004a0	8b f0		 mov	 esi, eax

; 1205 : 
; 1206 : #ifdef HAVE_BZIP2
; 1207 :     if ((err==ZIP_OK) && (zi->ci.method == Z_DEFLATED || zi->ci.method == Z_BZIP2ED) && (!zi->ci.raw))
; 1208 : #else
; 1209 :     if ((err==ZIP_OK) && (zi->ci.method == Z_DEFLATED) && (!zi->ci.raw))

  004a2	85 c0		 test	 eax, eax
  004a4	0f 85 82 00 00
	00		 jne	 $LN6@zipOpenNew
  004aa	83 bb f8 00 00
	00 08		 cmp	 DWORD PTR [rbx+248], 8
  004b1	75 79		 jne	 SHORT $LN6@zipOpenNew
  004b3	39 83 fc 00 00
	00		 cmp	 DWORD PTR [rbx+252], eax
  004b9	75 71		 jne	 SHORT $LN6@zipOpenNew

; 1210 : #endif
; 1211 :     {
; 1212 :         if(zi->ci.method == Z_DEFLATED)
; 1213 :         {
; 1214 :           zi->ci.stream.zalloc = (alloc_func)0;
; 1215 :           zi->ci.stream.zfree = (free_func)0;
; 1216 :           zi->ci.stream.opaque = (voidpf)0;
; 1217 : 
; 1218 :           if (windowBits>0)

  004bb	44 8b 8c 24 e8
	00 00 00	 mov	 r9d, DWORD PTR windowBits$[rsp]
  004c3	4c 89 ab a8 00
	00 00		 mov	 QWORD PTR [rbx+168], r13
  004ca	4c 89 ab b0 00
	00 00		 mov	 QWORD PTR [rbx+176], r13
  004d1	4c 89 ab b8 00
	00 00		 mov	 QWORD PTR [rbx+184], r13
  004d8	45 85 c9	 test	 r9d, r9d
  004db	7e 03		 jle	 SHORT $LN7@zipOpenNew

; 1219 :               windowBits = -windowBits;

  004dd	41 f7 d9	 neg	 r9d
$LN7@zipOpenNew:

; 1220 : 
; 1221 :           err = deflateInit2(&zi->ci.stream, level, Z_DEFLATED, windowBits, memLevel, strategy);

  004e0	48 8d 05 00 00
	00 00		 lea	 rax, OFFSET FLAT:??_C@_05HBMOAMF@1?42?47?$AA@
  004e7	c7 44 24 38 58
	00 00 00	 mov	 DWORD PTR [rsp+56], 88	; 00000058H
  004ef	48 8d 4b 78	 lea	 rcx, QWORD PTR [rbx+120]
  004f3	48 89 44 24 30	 mov	 QWORD PTR [rsp+48], rax
  004f8	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR strategy$[rsp]
  004ff	41 b8 08 00 00
	00		 mov	 r8d, 8
  00505	89 44 24 28	 mov	 DWORD PTR [rsp+40], eax
  00509	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR memLevel$[rsp]
  00510	41 8b d6	 mov	 edx, r14d
  00513	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  00517	e8 00 00 00 00	 call	 deflateInit2_
  0051c	8b f0		 mov	 esi, eax

; 1222 : 
; 1223 :           if (err==Z_OK)

  0051e	85 c0		 test	 eax, eax
  00520	75 0a		 jne	 SHORT $LN6@zipOpenNew

; 1224 :               zi->ci.stream_initialised = Z_DEFLATED;

  00522	c7 83 d0 00 00
	00 08 00 00 00	 mov	 DWORD PTR [rbx+208], 8
$LN6@zipOpenNew:

; 1225 :         }
; 1226 :         else if(zi->ci.method == Z_BZIP2ED)
; 1227 :         {
; 1228 : #ifdef HAVE_BZIP2
; 1229 :             // Init BZip stuff here
; 1230 :           zi->ci.bstream.bzalloc = 0;
; 1231 :           zi->ci.bstream.bzfree = 0;
; 1232 :           zi->ci.bstream.opaque = (voidpf)0;
; 1233 : 
; 1234 :           err = BZ2_bzCompressInit(&zi->ci.bstream, level, 0,35);
; 1235 :           if(err == BZ_OK)
; 1236 :             zi->ci.stream_initialised = Z_BZIP2ED;
; 1237 : #endif
; 1238 :         }
; 1239 : 
; 1240 :     }
; 1241 : 
; 1242 : #    ifndef NOCRYPT
; 1243 :     zi->ci.crypt_header_size = 0;

  0052c	44 89 ab 40 01
	01 00		 mov	 DWORD PTR [rbx+65856], r13d

; 1244 :     if ((err==Z_OK) && (password != NULL))

  00533	85 f6		 test	 esi, esi
  00535	75 6d		 jne	 SHORT $LN1@zipOpenNew
  00537	48 8b 8c 24 00
	01 00 00	 mov	 rcx, QWORD PTR password$[rsp]
  0053f	48 85 c9	 test	 rcx, rcx
  00542	74 59		 je	 SHORT $LN51@zipOpenNew

; 1245 :     {
; 1246 :         unsigned char bufHead[RAND_HEAD_LEN];
; 1247 :         unsigned int sizeHead;
; 1248 :         zi->ci.encrypt = 1;

  00544	c7 83 08 01 01
	00 01 00 00 00	 mov	 DWORD PTR [rbx+65800], 1

; 1249 :         zi->ci.pcrc_32_tab = get_crc_table();

  0054e	e8 00 00 00 00	 call	 get_crc_table

; 1250 :         /*init_keys(password,zi->ci.keys,zi->ci.pcrc_32_tab);*/
; 1251 : 
; 1252 :         sizeHead=crypthead(password,bufHead,RAND_HEAD_LEN,zi->ci.keys,zi->ci.pcrc_32_tab,crcForCrypting);

  00553	8b 94 24 08 01
	00 00		 mov	 edx, DWORD PTR crcForCrypting$[rsp]
  0055a	89 54 24 20	 mov	 DWORD PTR [rsp+32], edx
  0055e	4c 8d 83 28 01
	01 00		 lea	 r8, QWORD PTR [rbx+65832]
  00565	48 8d 54 24 40	 lea	 rdx, QWORD PTR bufHead$83917[rsp]
  0056a	4c 8b c8	 mov	 r9, rax
  0056d	48 89 83 38 01
	01 00		 mov	 QWORD PTR [rbx+65848], rax
  00574	e8 00 00 00 00	 call	 crypthead

; 1253 :         zi->ci.crypt_header_size = sizeHead;
; 1254 : 
; 1255 :         if (ZWRITE64(zi->z_filefunc,zi->filestream,bufHead,sizeHead) != sizeHead)

  00579	48 8b 53 58	 mov	 rdx, QWORD PTR [rbx+88]
  0057d	48 8b 4b 38	 mov	 rcx, QWORD PTR [rbx+56]
  00581	4c 8d 44 24 40	 lea	 r8, QWORD PTR bufHead$83917[rsp]
  00586	44 8b c8	 mov	 r9d, eax
  00589	8b f8		 mov	 edi, eax
  0058b	89 83 40 01 01
	00		 mov	 DWORD PTR [rbx+65856], eax
  00591	ff 53 10	 call	 QWORD PTR [rbx+16]
  00594	3b c7		 cmp	 eax, edi
  00596	74 05		 je	 SHORT $LN51@zipOpenNew

; 1256 :                 err = ZIP_ERRNO;

  00598	83 ce ff	 or	 esi, -1

; 1257 :     }
; 1258 : #    endif
; 1259 : 
; 1260 :     if (err==Z_OK)

  0059b	eb 07		 jmp	 SHORT $LN1@zipOpenNew
$LN51@zipOpenNew:

; 1261 :         zi->in_opened_file_inzip = 1;

  0059d	c7 43 70 01 00
	00 00		 mov	 DWORD PTR [rbx+112], 1
$LN1@zipOpenNew:

; 1262 :     return err;

  005a4	8b c6		 mov	 eax, esi
$LN57@zipOpenNew:
  005a6	4c 8b 74 24 58	 mov	 r14, QWORD PTR [rsp+88]
  005ab	48 8b 74 24 68	 mov	 rsi, QWORD PTR [rsp+104]
  005b0	4c 8b 7c 24 50	 mov	 r15, QWORD PTR [rsp+80]
$LN54@zipOpenNew:
  005b5	48 8b ac 24 98
	00 00 00	 mov	 rbp, QWORD PTR [rsp+152]

; 1263 : }

  005bd	48 83 c4 70	 add	 rsp, 112		; 00000070H
  005c1	41 5d		 pop	 r13
  005c3	5f		 pop	 rdi
  005c4	5b		 pop	 rbx
  005c5	c3		 ret	 0
zipOpenNewFileInZip4_64 ENDP
_TEXT	ENDS
PUBLIC	zipOpen64
; Function compile flags: /Ogtpy
;	COMDAT zipOpen64
_TEXT	SEGMENT
pathname$ = 8
append$ = 16
zipOpen64 PROC						; COMDAT

; 955  :     return zipOpen3(pathname,append,NULL,NULL);

  00000	45 33 c9	 xor	 r9d, r9d
  00003	45 33 c0	 xor	 r8d, r8d

; 956  : }

  00006	e9 00 00 00 00	 jmp	 zipOpen3
zipOpen64 ENDP
_TEXT	ENDS
PUBLIC	zipOpen
; Function compile flags: /Ogtpy
;	COMDAT zipOpen
_TEXT	SEGMENT
pathname$ = 8
append$ = 16
zipOpen	PROC						; COMDAT

; 950  :     return zipOpen3((const void*)pathname,append,NULL,NULL);

  00000	45 33 c9	 xor	 r9d, r9d
  00003	45 33 c0	 xor	 r8d, r8d

; 951  : }

  00006	e9 00 00 00 00	 jmp	 zipOpen3
zipOpen	ENDP
_TEXT	ENDS
PUBLIC	zipOpen2_64
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpen2_64 DD imagerel $LN6
	DD	imagerel $LN6+94
	DD	imagerel $unwind$zipOpen2_64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpen2_64 DD 020701H
	DD	0110107H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpen2_64
_TEXT	SEGMENT
zlib_filefunc64_32_def_fill$83715 = 32
pathname$ = 144
append$ = 152
globalcomment$ = 160
pzlib_filefunc_def$ = 168
zipOpen2_64 PROC					; COMDAT

; 933  : {

$LN6:
  00000	48 81 ec 88 00
	00 00		 sub	 rsp, 136		; 00000088H

; 934  :     if (pzlib_filefunc_def != NULL)

  00007	4d 85 c9	 test	 r9, r9
  0000a	74 45		 je	 SHORT $LN2@zipOpen2_6

; 935  :     {
; 936  :         zlib_filefunc64_32_def zlib_filefunc64_32_def_fill;
; 937  :         zlib_filefunc64_32_def_fill.zfile_func64 = *pzlib_filefunc_def;

  0000c	41 0f 10 01	 movups	 xmm0, XMMWORD PTR [r9]
  00010	41 0f 10 49 10	 movups	 xmm1, XMMWORD PTR [r9+16]

; 938  :         zlib_filefunc64_32_def_fill.ztell32_file = NULL;

  00015	33 c0		 xor	 eax, eax
  00017	48 89 44 24 68	 mov	 QWORD PTR zlib_filefunc64_32_def_fill$83715[rsp+72], rax

; 939  :         zlib_filefunc64_32_def_fill.zseek32_file = NULL;

  0001c	48 89 44 24 70	 mov	 QWORD PTR zlib_filefunc64_32_def_fill$83715[rsp+80], rax
  00021	0f 29 44 24 20	 movaps	 XMMWORD PTR zlib_filefunc64_32_def_fill$83715[rsp], xmm0
  00026	0f 29 4c 24 30	 movaps	 XMMWORD PTR zlib_filefunc64_32_def_fill$83715[rsp+16], xmm1
  0002b	41 0f 10 41 20	 movups	 xmm0, XMMWORD PTR [r9+32]
  00030	41 0f 10 49 30	 movups	 xmm1, XMMWORD PTR [r9+48]

; 940  :         return zipOpen3(pathname, append, globalcomment, &zlib_filefunc64_32_def_fill);

  00035	4c 8d 4c 24 20	 lea	 r9, QWORD PTR zlib_filefunc64_32_def_fill$83715[rsp]
  0003a	0f 29 44 24 40	 movaps	 XMMWORD PTR zlib_filefunc64_32_def_fill$83715[rsp+32], xmm0
  0003f	0f 29 4c 24 50	 movaps	 XMMWORD PTR zlib_filefunc64_32_def_fill$83715[rsp+48], xmm1

; 941  :     }
; 942  :     else
; 943  :         return zipOpen3(pathname, append, globalcomment, NULL);

  00044	e8 00 00 00 00	 call	 zipOpen3

; 944  : }

  00049	48 81 c4 88 00
	00 00		 add	 rsp, 136		; 00000088H
  00050	c3		 ret	 0
$LN2@zipOpen2_6:

; 941  :     }
; 942  :     else
; 943  :         return zipOpen3(pathname, append, globalcomment, NULL);

  00051	e8 00 00 00 00	 call	 zipOpen3

; 944  : }

  00056	48 81 c4 88 00
	00 00		 add	 rsp, 136		; 00000088H
  0005d	c3		 ret	 0
zipOpen2_64 ENDP
_TEXT	ENDS
PUBLIC	zipOpen2
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpen2 DD imagerel $LN6
	DD	imagerel $LN6+78
	DD	imagerel $unwind$zipOpen2
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpen2 DD 020901H
	DD	03002f209H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpen2
_TEXT	SEGMENT
zlib_filefunc64_32_def_fill$83701 = 32
pathname$ = 144
append$ = 152
globalcomment$ = 160
pzlib_filefunc32_def$ = 168
zipOpen2 PROC						; COMDAT

; 921  : {

$LN6:
  00000	40 53		 push	 rbx
  00002	48 81 ec 80 00
	00 00		 sub	 rsp, 128		; 00000080H
  00009	4d 8b d0	 mov	 r10, r8
  0000c	44 8b da	 mov	 r11d, edx
  0000f	48 8b d9	 mov	 rbx, rcx

; 922  :     if (pzlib_filefunc32_def != NULL)

  00012	4d 85 c9	 test	 r9, r9
  00015	74 29		 je	 SHORT $LN2@zipOpen2

; 923  :     {
; 924  :         zlib_filefunc64_32_def zlib_filefunc64_32_def_fill;
; 925  :         fill_zlib_filefunc64_32_def_from_filefunc32(&zlib_filefunc64_32_def_fill,pzlib_filefunc32_def);

  00017	48 8d 4c 24 20	 lea	 rcx, QWORD PTR zlib_filefunc64_32_def_fill$83701[rsp]
  0001c	49 8b d1	 mov	 rdx, r9
  0001f	e8 00 00 00 00	 call	 fill_zlib_filefunc64_32_def_from_filefunc32

; 926  :         return zipOpen3(pathname, append, globalcomment, &zlib_filefunc64_32_def_fill);

  00024	4c 8d 4c 24 20	 lea	 r9, QWORD PTR zlib_filefunc64_32_def_fill$83701[rsp]
  00029	4d 8b c2	 mov	 r8, r10
  0002c	41 8b d3	 mov	 edx, r11d
  0002f	48 8b cb	 mov	 rcx, rbx

; 927  :     }
; 928  :     else
; 929  :         return zipOpen3(pathname, append, globalcomment, NULL);

  00032	e8 00 00 00 00	 call	 zipOpen3

; 930  : }

  00037	48 81 c4 80 00
	00 00		 add	 rsp, 128		; 00000080H
  0003e	5b		 pop	 rbx
  0003f	c3		 ret	 0
$LN2@zipOpen2:

; 927  :     }
; 928  :     else
; 929  :         return zipOpen3(pathname, append, globalcomment, NULL);

  00040	e8 00 00 00 00	 call	 zipOpen3

; 930  : }

  00045	48 81 c4 80 00
	00 00		 add	 rsp, 128		; 00000080H
  0004c	5b		 pop	 rbx
  0004d	c3		 ret	 0
zipOpen2 ENDP
PUBLIC	zipClose
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipClose DD imagerel $LN21
	DD	imagerel $LN21+49
	DD	imagerel $unwind$zipClose
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$1$zipClose DD imagerel $LN21+49
	DD	imagerel $LN21+87
	DD	imagerel $chain$1$zipClose
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$2$zipClose DD imagerel $LN21+87
	DD	imagerel $LN21+253
	DD	imagerel $chain$2$zipClose
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$3$zipClose DD imagerel $LN21+253
	DD	imagerel $LN21+305
	DD	imagerel $chain$3$zipClose
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$4$zipClose DD imagerel $LN21+305
	DD	imagerel $LN21+328
	DD	imagerel $chain$4$zipClose
pdata	ENDS
;	COMDAT pdata
pdata	SEGMENT
$pdata$5$zipClose DD imagerel $LN21+328
	DD	imagerel $LN21+359
	DD	imagerel $chain$5$zipClose
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$5$zipClose DD 021H
	DD	imagerel $LN21
	DD	imagerel $LN21+49
	DD	imagerel $unwind$zipClose
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$4$zipClose DD 020021H
	DD	0ae400H
	DD	imagerel $LN21
	DD	imagerel $LN21+49
	DD	imagerel $unwind$zipClose
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$3$zipClose DD 021H
	DD	imagerel $LN21+49
	DD	imagerel $LN21+87
	DD	imagerel $chain$1$zipClose
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$2$zipClose DD 020521H
	DD	083405H
	DD	imagerel $LN21+49
	DD	imagerel $LN21+87
	DD	imagerel $chain$1$zipClose
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$chain$1$zipClose DD 040a21H
	DD	0ae40aH
	DD	09d405H
	DD	imagerel $LN21
	DD	imagerel $LN21+49
	DD	imagerel $unwind$zipClose
xdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipClose DD 060d01H
	DD	0b540dH
	DD	0c009320dH
	DD	060067007H
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipClose
_TEXT	SEGMENT
file$ = 64
global_comment$ = 72
zipClose PROC						; COMDAT

; 1883 : {

$LN21:
  00000	48 89 6c 24 20	 mov	 QWORD PTR [rsp+32], rbp
  00005	56		 push	 rsi
  00006	57		 push	 rdi
  00007	41 54		 push	 r12
  00009	48 83 ec 20	 sub	 rsp, 32			; 00000020H

; 1884 :     zip64_internal* zi;
; 1885 :     int err = 0;

  0000d	33 f6		 xor	 esi, esi
  0000f	4c 8b e2	 mov	 r12, rdx
  00012	48 8b f9	 mov	 rdi, rcx

; 1886 :     uLong size_centraldir = 0;

  00015	8b ee		 mov	 ebp, esi

; 1887 :     ZPOS64_T centraldir_pos_inzip;
; 1888 :     ZPOS64_T pos;
; 1889 : 
; 1890 :     if (file == NULL)

  00017	48 85 c9	 test	 rcx, rcx
  0001a	75 11		 jne	 SHORT $LN16@zipClose

; 1891 :         return ZIP_PARAMERROR;

  0001c	8d 41 9a	 lea	 eax, QWORD PTR [rcx-102]

; 1947 : 
; 1948 :     return err;
; 1949 : }

  0001f	48 8b 6c 24 58	 mov	 rbp, QWORD PTR [rsp+88]
  00024	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00028	41 5c		 pop	 r12
  0002a	5f		 pop	 rdi
  0002b	5e		 pop	 rsi
  0002c	c3		 ret	 0
$LN16@zipClose:

; 1892 : 
; 1893 :     zi = (zip64_internal*)file;
; 1894 : 
; 1895 :     if (zi->in_opened_file_inzip == 1)

  0002d	83 79 70 01	 cmp	 DWORD PTR [rcx+112], 1
  00031	4c 89 6c 24 48	 mov	 QWORD PTR [rsp+72], r13
  00036	4c 89 74 24 50	 mov	 QWORD PTR [rsp+80], r14
  0003b	75 07		 jne	 SHORT $LN15@zipClose

; 1896 :     {
; 1897 :         err = zipCloseFileInZip (file);

  0003d	e8 00 00 00 00	 call	 zipCloseFileInZip
  00042	8b f0		 mov	 esi, eax
$LN15@zipClose:

; 1898 :     }
; 1899 : 
; 1900 : #ifndef NO_ADDFILEINEXISTINGZIP
; 1901 :     if (global_comment==NULL)

  00044	4d 85 e4	 test	 r12, r12
  00047	75 07		 jne	 SHORT $LN14@zipClose

; 1902 :         global_comment = zi->globalcomment;

  00049	4c 8b a7 60 01
	01 00		 mov	 r12, QWORD PTR [rdi+65888]
$LN14@zipClose:

; 1903 : #endif
; 1904 : 
; 1905 :     centraldir_pos_inzip = ZTELL64(zi->z_filefunc,zi->filestream);

  00050	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  00054	48 8b cf	 mov	 rcx, rdi
  00057	48 89 5c 24 40	 mov	 QWORD PTR [rsp+64], rbx
  0005c	e8 00 00 00 00	 call	 call_ztell64

; 1906 : 
; 1907 :     if (err==ZIP_OK)

  00061	41 83 ce ff	 or	 r14d, -1
  00065	4c 8b e8	 mov	 r13, rax
  00068	85 f6		 test	 esi, esi
  0006a	75 37		 jne	 SHORT $LN11@zipClose

; 1908 :     {
; 1909 :         linkedlist_datablock_internal* ldi = zi->central_dir.first_block;

  0006c	48 8b 5f 60	 mov	 rbx, QWORD PTR [rdi+96]

; 1910 :         while (ldi!=NULL)

  00070	48 85 db	 test	 rbx, rbx
  00073	74 2e		 je	 SHORT $LN11@zipClose
$LL12@zipClose:

; 1911 :         {
; 1912 :             if ((err==ZIP_OK) && (ldi->filled_in_this_block>0))

  00075	85 f6		 test	 esi, esi
  00077	75 1f		 jne	 SHORT $LN9@zipClose
  00079	44 8b 4b 0c	 mov	 r9d, DWORD PTR [rbx+12]
  0007d	45 85 c9	 test	 r9d, r9d
  00080	74 16		 je	 SHORT $LN9@zipClose

; 1913 :             {
; 1914 :                 if (ZWRITE64(zi->z_filefunc,zi->filestream, ldi->data, ldi->filled_in_this_block) != ldi->filled_in_this_block)

  00082	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  00086	48 8b 4f 38	 mov	 rcx, QWORD PTR [rdi+56]
  0008a	4c 8d 43 14	 lea	 r8, QWORD PTR [rbx+20]
  0008e	ff 57 10	 call	 QWORD PTR [rdi+16]
  00091	3b 43 0c	 cmp	 eax, DWORD PTR [rbx+12]
  00094	41 0f 45 f6	 cmovne	 esi, r14d
$LN9@zipClose:

; 1915 :                     err = ZIP_ERRNO;
; 1916 :             }
; 1917 : 
; 1918 :             size_centraldir += ldi->filled_in_this_block;

  00098	03 6b 0c	 add	 ebp, DWORD PTR [rbx+12]

; 1919 :             ldi = ldi->next_datablock;

  0009b	48 8b 1b	 mov	 rbx, QWORD PTR [rbx]
  0009e	48 85 db	 test	 rbx, rbx
  000a1	75 d2		 jne	 SHORT $LL12@zipClose
$LN11@zipClose:

; 1920 :         }
; 1921 :     }
; 1922 :     free_linkedlist(&(zi->central_dir));

  000a3	48 8d 4f 60	 lea	 rcx, QWORD PTR [rdi+96]
  000a7	e8 00 00 00 00	 call	 free_linkedlist

; 1923 : 
; 1924 :     pos = centraldir_pos_inzip - zi->add_position_when_writting_offset;

  000ac	4d 8b dd	 mov	 r11, r13

; 1925 :     if(pos >= 0xffffffff || zi->number_entry > 0xFFFF)

  000af	b8 ff ff ff ff	 mov	 eax, -1			; ffffffffH
  000b4	4c 2b 9f 50 01
	01 00		 sub	 r11, QWORD PTR [rdi+65872]
  000bb	4c 3b d8	 cmp	 r11, rax
  000be	73 0d		 jae	 SHORT $LN7@zipClose
  000c0	48 81 bf 58 01
	01 00 ff ff 00
	00		 cmp	 QWORD PTR [rdi+65880], 65535 ; 0000ffffH
  000cb	76 27		 jbe	 SHORT $LN8@zipClose
$LN7@zipClose:

; 1926 :     {
; 1927 :       ZPOS64_T Zip64EOCDpos = ZTELL64(zi->z_filefunc,zi->filestream);

  000cd	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  000d1	48 8b cf	 mov	 rcx, rdi
  000d4	e8 00 00 00 00	 call	 call_ztell64

; 1928 :       Write_Zip64EndOfCentralDirectoryRecord(zi, size_centraldir, centraldir_pos_inzip);

  000d9	4d 8b c5	 mov	 r8, r13
  000dc	8b d5		 mov	 edx, ebp
  000de	48 8b cf	 mov	 rcx, rdi
  000e1	48 8b d8	 mov	 rbx, rax
  000e4	e8 00 00 00 00	 call	 Write_Zip64EndOfCentralDirectoryRecord

; 1929 : 
; 1930 :       Write_Zip64EndOfCentralDirectoryLocator(zi, Zip64EOCDpos);

  000e9	48 8b d3	 mov	 rdx, rbx
  000ec	48 8b cf	 mov	 rcx, rdi
  000ef	e8 00 00 00 00	 call	 Write_Zip64EndOfCentralDirectoryLocator
$LN8@zipClose:

; 1931 :     }
; 1932 : 
; 1933 :     if (err==ZIP_OK)

  000f4	48 8b 5c 24 40	 mov	 rbx, QWORD PTR [rsp+64]
  000f9	85 f6		 test	 esi, esi
  000fb	75 20		 jne	 SHORT $LN5@zipClose

; 1934 :       err = Write_EndOfCentralDirectoryRecord(zi, size_centraldir, centraldir_pos_inzip);

  000fd	4d 8b c5	 mov	 r8, r13
  00100	8b d5		 mov	 edx, ebp
  00102	48 8b cf	 mov	 rcx, rdi
  00105	e8 00 00 00 00	 call	 Write_EndOfCentralDirectoryRecord
  0010a	8b f0		 mov	 esi, eax

; 1935 : 
; 1936 :     if(err == ZIP_OK)

  0010c	85 c0		 test	 eax, eax
  0010e	75 0d		 jne	 SHORT $LN5@zipClose

; 1937 :       err = Write_GlobalComment(zi, global_comment);

  00110	49 8b d4	 mov	 rdx, r12
  00113	48 8b cf	 mov	 rcx, rdi
  00116	e8 00 00 00 00	 call	 Write_GlobalComment
  0011b	8b f0		 mov	 esi, eax
$LN5@zipClose:

; 1938 : 
; 1939 :     if (ZCLOSE64(zi->z_filefunc,zi->filestream) != 0)

  0011d	48 8b 57 58	 mov	 rdx, QWORD PTR [rdi+88]
  00121	48 8b 4f 38	 mov	 rcx, QWORD PTR [rdi+56]
  00125	ff 57 28	 call	 QWORD PTR [rdi+40]
  00128	4c 8b 6c 24 48	 mov	 r13, QWORD PTR [rsp+72]
  0012d	85 c0		 test	 eax, eax
  0012f	74 06		 je	 SHORT $LN3@zipClose

; 1940 :         if (err == ZIP_OK)

  00131	85 f6		 test	 esi, esi
  00133	41 0f 44 f6	 cmove	 esi, r14d
$LN3@zipClose:

; 1941 :             err = ZIP_ERRNO;
; 1942 : 
; 1943 : #ifndef NO_ADDFILEINEXISTINGZIP
; 1944 :     TRYFREE(zi->globalcomment);

  00137	48 8b 8f 60 01
	01 00		 mov	 rcx, QWORD PTR [rdi+65888]
  0013e	4c 8b 74 24 50	 mov	 r14, QWORD PTR [rsp+80]
  00143	48 85 c9	 test	 rcx, rcx
  00146	74 06		 je	 SHORT $LN2@zipClose
  00148	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free
$LN2@zipClose:

; 1945 : #endif
; 1946 :     TRYFREE(zi);

  0014e	48 8b cf	 mov	 rcx, rdi
  00151	ff 15 00 00 00
	00		 call	 QWORD PTR __imp_free

; 1947 : 
; 1948 :     return err;
; 1949 : }

  00157	48 8b 6c 24 58	 mov	 rbp, QWORD PTR [rsp+88]
  0015c	8b c6		 mov	 eax, esi
  0015e	48 83 c4 20	 add	 rsp, 32			; 00000020H
  00162	41 5c		 pop	 r12
  00164	5f		 pop	 rdi
  00165	5e		 pop	 rsi
  00166	c3		 ret	 0
zipClose ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip DD imagerel $LN3
	DD	imagerel $LN3+137
	DD	imagerel $unwind$zipOpenNewFileInZip
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip DD 020a01H
	DD	015010aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip
_TEXT	SEGMENT
file$ = 176
filename$ = 184
zipfi$ = 192
extrafield_local$ = 200
size_extrafield_local$ = 208
extrafield_global$ = 216
size_extrafield_global$ = 224
comment$ = 232
method$ = 240
level$ = 248
zipOpenNewFileInZip PROC				; COMDAT

; 1354 : {

$LN3:
  00000	4c 8b dc	 mov	 r11, rsp
  00003	48 81 ec a8 00
	00 00		 sub	 rsp, 168		; 000000a8H

; 1355 :     return zipOpenNewFileInZip4_64 (file, filename, zipfi,
; 1356 :                                  extrafield_local, size_extrafield_local,
; 1357 :                                  extrafield_global, size_extrafield_global,
; 1358 :                                  comment, method, level, 0,
; 1359 :                                  -MAX_WBITS, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY,
; 1360 :                                  NULL, 0, VERSIONMADEBY, 0, 0);

  0000a	33 c0		 xor	 eax, eax
  0000c	41 89 43 e8	 mov	 DWORD PTR [r11-24], eax
  00010	41 89 43 e0	 mov	 DWORD PTR [r11-32], eax
  00014	41 89 43 d8	 mov	 DWORD PTR [r11-40], eax
  00018	89 44 24 78	 mov	 DWORD PTR [rsp+120], eax
  0001c	49 89 43 c8	 mov	 QWORD PTR [r11-56], rax
  00020	89 44 24 68	 mov	 DWORD PTR [rsp+104], eax
  00024	c7 44 24 60 08
	00 00 00	 mov	 DWORD PTR [rsp+96], 8
  0002c	c7 44 24 58 f1
	ff ff ff	 mov	 DWORD PTR [rsp+88], -15
  00034	89 44 24 50	 mov	 DWORD PTR [rsp+80], eax
  00038	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR level$[rsp]
  0003f	89 44 24 48	 mov	 DWORD PTR [rsp+72], eax
  00043	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR method$[rsp]
  0004a	89 44 24 40	 mov	 DWORD PTR [rsp+64], eax
  0004e	48 8b 84 24 e8
	00 00 00	 mov	 rax, QWORD PTR comment$[rsp]
  00056	49 89 43 90	 mov	 QWORD PTR [r11-112], rax
  0005a	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_global$[rsp]
  00061	89 44 24 30	 mov	 DWORD PTR [rsp+48], eax
  00065	48 8b 84 24 d8
	00 00 00	 mov	 rax, QWORD PTR extrafield_global$[rsp]
  0006d	49 89 43 80	 mov	 QWORD PTR [r11-128], rax
  00071	8b 84 24 d0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_local$[rsp]
  00078	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  0007c	e8 00 00 00 00	 call	 zipOpenNewFileInZip4_64

; 1361 : }

  00081	48 81 c4 a8 00
	00 00		 add	 rsp, 168		; 000000a8H
  00088	c3		 ret	 0
zipOpenNewFileInZip ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip64
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip64 DD imagerel $LN3
	DD	imagerel $LN3+144
	DD	imagerel $unwind$zipOpenNewFileInZip64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip64 DD 020a01H
	DD	015010aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip64
_TEXT	SEGMENT
file$ = 176
filename$ = 184
zipfi$ = 192
extrafield_local$ = 200
size_extrafield_local$ = 208
extrafield_global$ = 216
size_extrafield_global$ = 224
comment$ = 232
method$ = 240
level$ = 248
zip64$ = 256
zipOpenNewFileInZip64 PROC				; COMDAT

; 1341 : {

$LN3:
  00000	4c 8b dc	 mov	 r11, rsp
  00003	48 81 ec a8 00
	00 00		 sub	 rsp, 168		; 000000a8H

; 1342 :     return zipOpenNewFileInZip4_64 (file, filename, zipfi,
; 1343 :                                  extrafield_local, size_extrafield_local,
; 1344 :                                  extrafield_global, size_extrafield_global,
; 1345 :                                  comment, method, level, 0,
; 1346 :                                  -MAX_WBITS, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY,
; 1347 :                                  NULL, 0, VERSIONMADEBY, 0, zip64);

  0000a	8b 84 24 00 01
	00 00		 mov	 eax, DWORD PTR zip64$[rsp]
  00011	41 89 43 e8	 mov	 DWORD PTR [r11-24], eax
  00015	33 c0		 xor	 eax, eax
  00017	41 89 43 e0	 mov	 DWORD PTR [r11-32], eax
  0001b	41 89 43 d8	 mov	 DWORD PTR [r11-40], eax
  0001f	89 44 24 78	 mov	 DWORD PTR [rsp+120], eax
  00023	49 89 43 c8	 mov	 QWORD PTR [r11-56], rax
  00027	89 44 24 68	 mov	 DWORD PTR [rsp+104], eax
  0002b	c7 44 24 60 08
	00 00 00	 mov	 DWORD PTR [rsp+96], 8
  00033	c7 44 24 58 f1
	ff ff ff	 mov	 DWORD PTR [rsp+88], -15
  0003b	89 44 24 50	 mov	 DWORD PTR [rsp+80], eax
  0003f	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR level$[rsp]
  00046	89 44 24 48	 mov	 DWORD PTR [rsp+72], eax
  0004a	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR method$[rsp]
  00051	89 44 24 40	 mov	 DWORD PTR [rsp+64], eax
  00055	48 8b 84 24 e8
	00 00 00	 mov	 rax, QWORD PTR comment$[rsp]
  0005d	49 89 43 90	 mov	 QWORD PTR [r11-112], rax
  00061	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_global$[rsp]
  00068	89 44 24 30	 mov	 DWORD PTR [rsp+48], eax
  0006c	48 8b 84 24 d8
	00 00 00	 mov	 rax, QWORD PTR extrafield_global$[rsp]
  00074	49 89 43 80	 mov	 QWORD PTR [r11-128], rax
  00078	8b 84 24 d0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_local$[rsp]
  0007f	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  00083	e8 00 00 00 00	 call	 zipOpenNewFileInZip4_64

; 1348 : }

  00088	48 81 c4 a8 00
	00 00		 add	 rsp, 168		; 000000a8H
  0008f	c3		 ret	 0
zipOpenNewFileInZip64 ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip2_64
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip2_64 DD imagerel $LN3
	DD	imagerel $LN3+151
	DD	imagerel $unwind$zipOpenNewFileInZip2_64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip2_64 DD 020a01H
	DD	015010aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip2_64
_TEXT	SEGMENT
file$ = 176
filename$ = 184
zipfi$ = 192
extrafield_local$ = 200
size_extrafield_local$ = 208
extrafield_global$ = 216
size_extrafield_global$ = 224
comment$ = 232
method$ = 240
level$ = 248
raw$ = 256
zip64$ = 264
zipOpenNewFileInZip2_64 PROC				; COMDAT

; 1328 : {

$LN3:
  00000	4c 8b dc	 mov	 r11, rsp
  00003	48 81 ec a8 00
	00 00		 sub	 rsp, 168		; 000000a8H

; 1329 :     return zipOpenNewFileInZip4_64 (file, filename, zipfi,
; 1330 :                                  extrafield_local, size_extrafield_local,
; 1331 :                                  extrafield_global, size_extrafield_global,
; 1332 :                                  comment, method, level, raw,
; 1333 :                                  -MAX_WBITS, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY,
; 1334 :                                  NULL, 0, VERSIONMADEBY, 0, zip64);

  0000a	8b 84 24 08 01
	00 00		 mov	 eax, DWORD PTR zip64$[rsp]
  00011	41 89 43 e8	 mov	 DWORD PTR [r11-24], eax
  00015	33 c0		 xor	 eax, eax
  00017	41 89 43 e0	 mov	 DWORD PTR [r11-32], eax
  0001b	41 89 43 d8	 mov	 DWORD PTR [r11-40], eax
  0001f	89 44 24 78	 mov	 DWORD PTR [rsp+120], eax
  00023	49 89 43 c8	 mov	 QWORD PTR [r11-56], rax
  00027	89 44 24 68	 mov	 DWORD PTR [rsp+104], eax
  0002b	8b 84 24 00 01
	00 00		 mov	 eax, DWORD PTR raw$[rsp]
  00032	c7 44 24 60 08
	00 00 00	 mov	 DWORD PTR [rsp+96], 8
  0003a	c7 44 24 58 f1
	ff ff ff	 mov	 DWORD PTR [rsp+88], -15
  00042	89 44 24 50	 mov	 DWORD PTR [rsp+80], eax
  00046	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR level$[rsp]
  0004d	89 44 24 48	 mov	 DWORD PTR [rsp+72], eax
  00051	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR method$[rsp]
  00058	89 44 24 40	 mov	 DWORD PTR [rsp+64], eax
  0005c	48 8b 84 24 e8
	00 00 00	 mov	 rax, QWORD PTR comment$[rsp]
  00064	49 89 43 90	 mov	 QWORD PTR [r11-112], rax
  00068	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_global$[rsp]
  0006f	89 44 24 30	 mov	 DWORD PTR [rsp+48], eax
  00073	48 8b 84 24 d8
	00 00 00	 mov	 rax, QWORD PTR extrafield_global$[rsp]
  0007b	49 89 43 80	 mov	 QWORD PTR [r11-128], rax
  0007f	8b 84 24 d0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_local$[rsp]
  00086	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  0008a	e8 00 00 00 00	 call	 zipOpenNewFileInZip4_64

; 1335 : }

  0008f	48 81 c4 a8 00
	00 00		 add	 rsp, 168		; 000000a8H
  00096	c3		 ret	 0
zipOpenNewFileInZip2_64 ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip2
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip2 DD imagerel $LN3
	DD	imagerel $LN3+144
	DD	imagerel $unwind$zipOpenNewFileInZip2
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip2 DD 020a01H
	DD	015010aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip2
_TEXT	SEGMENT
file$ = 176
filename$ = 184
zipfi$ = 192
extrafield_local$ = 200
size_extrafield_local$ = 208
extrafield_global$ = 216
size_extrafield_global$ = 224
comment$ = 232
method$ = 240
level$ = 248
raw$ = 256
zipOpenNewFileInZip2 PROC				; COMDAT

; 1315 : {

$LN3:
  00000	4c 8b dc	 mov	 r11, rsp
  00003	48 81 ec a8 00
	00 00		 sub	 rsp, 168		; 000000a8H

; 1316 :     return zipOpenNewFileInZip4_64 (file, filename, zipfi,
; 1317 :                                  extrafield_local, size_extrafield_local,
; 1318 :                                  extrafield_global, size_extrafield_global,
; 1319 :                                  comment, method, level, raw,
; 1320 :                                  -MAX_WBITS, DEF_MEM_LEVEL, Z_DEFAULT_STRATEGY,
; 1321 :                                  NULL, 0, VERSIONMADEBY, 0, 0);

  0000a	33 c0		 xor	 eax, eax
  0000c	41 89 43 e8	 mov	 DWORD PTR [r11-24], eax
  00010	41 89 43 e0	 mov	 DWORD PTR [r11-32], eax
  00014	41 89 43 d8	 mov	 DWORD PTR [r11-40], eax
  00018	89 44 24 78	 mov	 DWORD PTR [rsp+120], eax
  0001c	49 89 43 c8	 mov	 QWORD PTR [r11-56], rax
  00020	89 44 24 68	 mov	 DWORD PTR [rsp+104], eax
  00024	8b 84 24 00 01
	00 00		 mov	 eax, DWORD PTR raw$[rsp]
  0002b	c7 44 24 60 08
	00 00 00	 mov	 DWORD PTR [rsp+96], 8
  00033	c7 44 24 58 f1
	ff ff ff	 mov	 DWORD PTR [rsp+88], -15
  0003b	89 44 24 50	 mov	 DWORD PTR [rsp+80], eax
  0003f	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR level$[rsp]
  00046	89 44 24 48	 mov	 DWORD PTR [rsp+72], eax
  0004a	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR method$[rsp]
  00051	89 44 24 40	 mov	 DWORD PTR [rsp+64], eax
  00055	48 8b 84 24 e8
	00 00 00	 mov	 rax, QWORD PTR comment$[rsp]
  0005d	49 89 43 90	 mov	 QWORD PTR [r11-112], rax
  00061	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_global$[rsp]
  00068	89 44 24 30	 mov	 DWORD PTR [rsp+48], eax
  0006c	48 8b 84 24 d8
	00 00 00	 mov	 rax, QWORD PTR extrafield_global$[rsp]
  00074	49 89 43 80	 mov	 QWORD PTR [r11-128], rax
  00078	8b 84 24 d0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_local$[rsp]
  0007f	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  00083	e8 00 00 00 00	 call	 zipOpenNewFileInZip4_64

; 1322 : }

  00088	48 81 c4 a8 00
	00 00		 add	 rsp, 168		; 000000a8H
  0008f	c3		 ret	 0
zipOpenNewFileInZip2 ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip3_64
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip3_64 DD imagerel $LN3
	DD	imagerel $LN3+179
	DD	imagerel $unwind$zipOpenNewFileInZip3_64
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip3_64 DD 020a01H
	DD	015010aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip3_64
_TEXT	SEGMENT
file$ = 176
filename$ = 184
zipfi$ = 192
extrafield_local$ = 200
size_extrafield_local$ = 208
extrafield_global$ = 216
size_extrafield_global$ = 224
comment$ = 232
method$ = 240
level$ = 248
raw$ = 256
windowBits$ = 264
memLevel$ = 272
strategy$ = 280
password$ = 288
crcForCrypting$ = 296
zip64$ = 304
zipOpenNewFileInZip3_64 PROC				; COMDAT

; 1302 : {

$LN3:
  00000	4c 8b dc	 mov	 r11, rsp
  00003	48 81 ec a8 00
	00 00		 sub	 rsp, 168		; 000000a8H

; 1303 :     return zipOpenNewFileInZip4_64 (file, filename, zipfi,
; 1304 :                                  extrafield_local, size_extrafield_local,
; 1305 :                                  extrafield_global, size_extrafield_global,
; 1306 :                                  comment, method, level, raw,
; 1307 :                                  windowBits, memLevel, strategy,
; 1308 :                                  password, crcForCrypting, VERSIONMADEBY, 0, zip64);

  0000a	8b 84 24 30 01
	00 00		 mov	 eax, DWORD PTR zip64$[rsp]
  00011	41 89 43 e8	 mov	 DWORD PTR [r11-24], eax
  00015	33 c0		 xor	 eax, eax
  00017	41 89 43 e0	 mov	 DWORD PTR [r11-32], eax
  0001b	41 89 43 d8	 mov	 DWORD PTR [r11-40], eax
  0001f	8b 84 24 28 01
	00 00		 mov	 eax, DWORD PTR crcForCrypting$[rsp]
  00026	89 44 24 78	 mov	 DWORD PTR [rsp+120], eax
  0002a	48 8b 84 24 20
	01 00 00	 mov	 rax, QWORD PTR password$[rsp]
  00032	49 89 43 c8	 mov	 QWORD PTR [r11-56], rax
  00036	8b 84 24 18 01
	00 00		 mov	 eax, DWORD PTR strategy$[rsp]
  0003d	89 44 24 68	 mov	 DWORD PTR [rsp+104], eax
  00041	8b 84 24 10 01
	00 00		 mov	 eax, DWORD PTR memLevel$[rsp]
  00048	89 44 24 60	 mov	 DWORD PTR [rsp+96], eax
  0004c	8b 84 24 08 01
	00 00		 mov	 eax, DWORD PTR windowBits$[rsp]
  00053	89 44 24 58	 mov	 DWORD PTR [rsp+88], eax
  00057	8b 84 24 00 01
	00 00		 mov	 eax, DWORD PTR raw$[rsp]
  0005e	89 44 24 50	 mov	 DWORD PTR [rsp+80], eax
  00062	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR level$[rsp]
  00069	89 44 24 48	 mov	 DWORD PTR [rsp+72], eax
  0006d	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR method$[rsp]
  00074	89 44 24 40	 mov	 DWORD PTR [rsp+64], eax
  00078	48 8b 84 24 e8
	00 00 00	 mov	 rax, QWORD PTR comment$[rsp]
  00080	49 89 43 90	 mov	 QWORD PTR [r11-112], rax
  00084	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_global$[rsp]
  0008b	89 44 24 30	 mov	 DWORD PTR [rsp+48], eax
  0008f	48 8b 84 24 d8
	00 00 00	 mov	 rax, QWORD PTR extrafield_global$[rsp]
  00097	49 89 43 80	 mov	 QWORD PTR [r11-128], rax
  0009b	8b 84 24 d0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_local$[rsp]
  000a2	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  000a6	e8 00 00 00 00	 call	 zipOpenNewFileInZip4_64

; 1309 : }

  000ab	48 81 c4 a8 00
	00 00		 add	 rsp, 168		; 000000a8H
  000b2	c3		 ret	 0
zipOpenNewFileInZip3_64 ENDP
_TEXT	ENDS
PUBLIC	zipOpenNewFileInZip3
;	COMDAT pdata
pdata	SEGMENT
$pdata$zipOpenNewFileInZip3 DD imagerel $LN3
	DD	imagerel $LN3+172
	DD	imagerel $unwind$zipOpenNewFileInZip3
pdata	ENDS
;	COMDAT xdata
xdata	SEGMENT
$unwind$zipOpenNewFileInZip3 DD 020a01H
	DD	015010aH
; Function compile flags: /Ogtpy
xdata	ENDS
;	COMDAT zipOpenNewFileInZip3
_TEXT	SEGMENT
file$ = 176
filename$ = 184
zipfi$ = 192
extrafield_local$ = 200
size_extrafield_local$ = 208
extrafield_global$ = 216
size_extrafield_global$ = 224
comment$ = 232
method$ = 240
level$ = 248
raw$ = 256
windowBits$ = 264
memLevel$ = 272
strategy$ = 280
password$ = 288
crcForCrypting$ = 296
zipOpenNewFileInZip3 PROC				; COMDAT

; 1287 : {

$LN3:
  00000	4c 8b dc	 mov	 r11, rsp
  00003	48 81 ec a8 00
	00 00		 sub	 rsp, 168		; 000000a8H

; 1288 :     return zipOpenNewFileInZip4_64 (file, filename, zipfi,
; 1289 :                                  extrafield_local, size_extrafield_local,
; 1290 :                                  extrafield_global, size_extrafield_global,
; 1291 :                                  comment, method, level, raw,
; 1292 :                                  windowBits, memLevel, strategy,
; 1293 :                                  password, crcForCrypting, VERSIONMADEBY, 0, 0);

  0000a	33 c0		 xor	 eax, eax
  0000c	41 89 43 e8	 mov	 DWORD PTR [r11-24], eax
  00010	41 89 43 e0	 mov	 DWORD PTR [r11-32], eax
  00014	41 89 43 d8	 mov	 DWORD PTR [r11-40], eax
  00018	8b 84 24 28 01
	00 00		 mov	 eax, DWORD PTR crcForCrypting$[rsp]
  0001f	89 44 24 78	 mov	 DWORD PTR [rsp+120], eax
  00023	48 8b 84 24 20
	01 00 00	 mov	 rax, QWORD PTR password$[rsp]
  0002b	49 89 43 c8	 mov	 QWORD PTR [r11-56], rax
  0002f	8b 84 24 18 01
	00 00		 mov	 eax, DWORD PTR strategy$[rsp]
  00036	89 44 24 68	 mov	 DWORD PTR [rsp+104], eax
  0003a	8b 84 24 10 01
	00 00		 mov	 eax, DWORD PTR memLevel$[rsp]
  00041	89 44 24 60	 mov	 DWORD PTR [rsp+96], eax
  00045	8b 84 24 08 01
	00 00		 mov	 eax, DWORD PTR windowBits$[rsp]
  0004c	89 44 24 58	 mov	 DWORD PTR [rsp+88], eax
  00050	8b 84 24 00 01
	00 00		 mov	 eax, DWORD PTR raw$[rsp]
  00057	89 44 24 50	 mov	 DWORD PTR [rsp+80], eax
  0005b	8b 84 24 f8 00
	00 00		 mov	 eax, DWORD PTR level$[rsp]
  00062	89 44 24 48	 mov	 DWORD PTR [rsp+72], eax
  00066	8b 84 24 f0 00
	00 00		 mov	 eax, DWORD PTR method$[rsp]
  0006d	89 44 24 40	 mov	 DWORD PTR [rsp+64], eax
  00071	48 8b 84 24 e8
	00 00 00	 mov	 rax, QWORD PTR comment$[rsp]
  00079	49 89 43 90	 mov	 QWORD PTR [r11-112], rax
  0007d	8b 84 24 e0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_global$[rsp]
  00084	89 44 24 30	 mov	 DWORD PTR [rsp+48], eax
  00088	48 8b 84 24 d8
	00 00 00	 mov	 rax, QWORD PTR extrafield_global$[rsp]
  00090	49 89 43 80	 mov	 QWORD PTR [r11-128], rax
  00094	8b 84 24 d0 00
	00 00		 mov	 eax, DWORD PTR size_extrafield_local$[rsp]
  0009b	89 44 24 20	 mov	 DWORD PTR [rsp+32], eax
  0009f	e8 00 00 00 00	 call	 zipOpenNewFileInZip4_64

; 1294 : }

  000a4	48 81 c4 a8 00
	00 00		 add	 rsp, 168		; 000000a8H
  000ab	c3		 ret	 0
zipOpenNewFileInZip3 ENDP
END
